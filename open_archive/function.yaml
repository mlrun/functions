kind: job
metadata:
  name: open-archive
  tag: ''
  hash: 5b2fc703ab7c2e8a38246ee9fbeb3c59a427a442
  project: ''
  labels:
    author: yaronh
  categories:
  - data-movement
  - utils
spec:
  command: ''
  args: []
  image: 'yjbds/ml-base:0.4.8:'
  env: []
  default_handler: open_archive
  entry_points:
    open_archive:
      name: open_archive
      doc: 'Open a file/object archive into a target directory


        Currently supports zip and tar.gz'
      parameters:
      - name: context
        type: MLClientCtx
        doc: function execution context
      - name: archive_url
        type: DataItem
        doc: url of archive file
      - name: subdir
        type: str
        doc: path within artifact store where extracted files are stored
        default: content
      - name: key
        type: str
        doc: key of archive contents in artifact store
        default: content
      outputs: []
      lineno: 14
  description: Open a file/object archive into a target directory
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IG9zCmltcG9ydCB6aXBmaWxlCmltcG9ydCB1cmxsaWIucmVxdWVzdAppbXBvcnQgdGFyZmlsZQppbXBvcnQganNvbgoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gbWxydW4uZGF0YXN0b3JlIGltcG9ydCBEYXRhSXRlbQoKZnJvbSB0eXBpbmcgaW1wb3J0IFVuaW9uCgpkZWYgb3Blbl9hcmNoaXZlKAogICAgY29udGV4dDogTUxDbGllbnRDdHgsIAogICAgYXJjaGl2ZV91cmw6IERhdGFJdGVtLAogICAgc3ViZGlyOiBzdHIgPSAiY29udGVudCIsCiAgICBrZXk6IHN0ciA9ICJjb250ZW50IgopOgogICAgIiIiT3BlbiBhIGZpbGUvb2JqZWN0IGFyY2hpdmUgaW50byBhIHRhcmdldCBkaXJlY3RvcnkKICAgIAogICAgQ3VycmVudGx5IHN1cHBvcnRzIHppcCBhbmQgdGFyLmd6CiAgICAKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgIGZ1bmN0aW9uIGV4ZWN1dGlvbiBjb250ZXh0CiAgICA6cGFyYW0gYXJjaGl2ZV91cmw6ICB1cmwgb2YgYXJjaGl2ZSBmaWxlCiAgICA6cGFyYW0gc3ViZGlyOiAgICAgICBwYXRoIHdpdGhpbiBhcnRpZmFjdCBzdG9yZSB3aGVyZSBleHRyYWN0ZWQgZmlsZXMKICAgICAgICAgICAgICAgICAgICAgICAgIGFyZSBzdG9yZWQKICAgIDpwYXJhbSBrZXk6ICAgICAgICAgIGtleSBvZiBhcmNoaXZlIGNvbnRlbnRzIGluIGFydGlmYWN0IHN0b3JlCiAgICAiIiIKICAgIGRlc3RfcGF0aCA9IGNvbnRleHQuYXJ0aWZhY3RfcGF0aCArIGYnL3tzdWJkaXJ9JwogICAgb3MubWFrZWRpcnMoZGVzdF9wYXRoLCBleGlzdF9vaz1UcnVlKQogICAgCiAgICBhcmNoaXZlX3VybCA9IGFyY2hpdmVfdXJsLmxvY2FsKCkKICAgIGlmIGFyY2hpdmVfdXJsLmVuZHN3aXRoKCJneiIpOgogICAgICAgIHdpdGggdGFyZmlsZS5vcGVuKGFyY2hpdmVfdXJsLCBtb2RlPSJyfGd6IikgYXMgcmVmOgogICAgICAgICAgICByZWYuZXh0cmFjdGFsbChkZXN0X3BhdGgpCiAgICBlbGlmIGFyY2hpdmVfdXJsLmVuZHN3aXRoKCJ6aXAiKToKICAgICAgICB3aXRoIHppcGZpbGUuWmlwRmlsZShhcmNoaXZlX3VybCwgInIiKSBhcyByZWY6CiAgICAgICAgICAgIHJlZi5leHRyYWN0YWxsKGRlc3RfcGF0aCkKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmJ3Vuc3VwcG9ydGVkIGFyY2hpdmUgdHlwZSBpbiB7YXJjaGl2ZV91cmx9JykKICAgIAogICAgY29udGV4dC5sb2dfYXJ0aWZhY3Qoa2V5LCBsb2NhbF9wYXRoPXN1YmRpcikKCg==
    commands: []
    code_origin: https://github.com/yjb-ds/functions.git#5c3173b0811ca8c98a813543e3d41e5c8345b781:open_archive.ipynb

kind: job
metadata:
  name: github-utils
  tag: ''
  hash: d8e639af306794ce6f59eb246f0b845c016c9da4
  project: ''
  labels:
    author: yaronh
  categories:
  - utils
spec:
  command: ''
  args: []
  image: mlrun/mlrun
  env: []
  default_handler: run_summary_comment
  entry_points:
    pr_comment:
      name: pr_comment
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: repo
        type: str
        default: ''
      - name: issue
        type: int
        default: ''
      - name: message
        type: str
        default: ''
      - name: message_file
        type: DataItem
        default: null
      outputs:
      - default: ''
      lineno: 8
    run_summary_comment:
      name: run_summary_comment
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: workflow_id
        default: ''
      - name: repo
        type: str
        default: ''
      - name: issue
        type: int
        default: ''
      - name: project
        default: ''
      outputs:
      - default: ''
      lineno: 31
  description: add comments to github pull request
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBvcwpmcm9tIG1scnVuIGltcG9ydCBEYXRhSXRlbSwgZ2V0X3J1bl9kYiwgbWxjb25mCgoKZGVmIHByX2NvbW1lbnQoCiAgICBjb250ZXh0LCByZXBvOiBzdHIsIGlzc3VlOiBpbnQsIG1lc3NhZ2U6IHN0ciA9ICIiLCBtZXNzYWdlX2ZpbGU6IERhdGFJdGVtID0gTm9uZQopOgoKICAgIHRva2VuID0gY29udGV4dC5nZXRfc2VjcmV0KCJHSVRIVUJfVE9LRU4iKSBvciBvcy5lbnZpcm9uLmdldCgiR0lUSFVCX1RPS0VOIikKICAgIGlmIG1lc3NhZ2VfZmlsZSBhbmQgbm90IG1lc3NhZ2U6CiAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VfZmlsZS5nZXQoKQogICAgZWxpZiBub3QgbWVzc2FnZSBhbmQgbm90IG1lc3NhZ2VfZmlsZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJwciBtZXNzYWdlIG9yIG1lc3NhZ2UgZmlsZSBtdXN0IGJlIHByb3ZpZGVkIikKCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vdm5kLmdpdGh1Yi52Mytqc29uIiwKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGYidG9rZW4ge3Rva2VufSIsCiAgICB9CiAgICB1cmwgPSBmImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mve3JlcG99L2lzc3Vlcy97aXNzdWV9L2NvbW1lbnRzIgoKICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249eyJib2R5Ijogc3RyKG1lc3NhZ2UpfSwgaGVhZGVycz1oZWFkZXJzKQogICAgaWYgbm90IHJlc3Aub2s6CiAgICAgICAgZXJybXNnID0gZiJiYWQgcHIgY29tbWVudCByZXNwISFcbntyZXNwLnRleHR9IgogICAgICAgIGNvbnRleHQubG9nZ2VyLmVycm9yKGVycm1zZykKICAgICAgICByYWlzZSBJT0Vycm9yKGVycm1zZykKCgpkZWYgcnVuX3N1bW1hcnlfY29tbWVudChjb250ZXh0LCB3b3JrZmxvd19pZCwgcmVwbzogc3RyLCBpc3N1ZTogaW50LCBwcm9qZWN0PSIiKToKICAgIGRiID0gZ2V0X3J1bl9kYigpLmNvbm5lY3QoKQogICAgcHJvamVjdCA9IHByb2plY3Qgb3IgY29udGV4dC5wcm9qZWN0CiAgICBydW5zID0gZGIubGlzdF9ydW5zKHByb2plY3Q9cHJvamVjdCwgbGFiZWxzPWYid29ya2Zsb3c9e3dvcmtmbG93X2lkfSIpCgogICAgaGFkX2Vycm9ycyA9IGkgPSAwCiAgICBmb3IgciBpbiBydW5zOgogICAgICAgIG5hbWUgPSByWyJtZXRhZGF0YSJdWyJuYW1lIl0KICAgICAgICBpZiByWyJzdGF0dXMiXS5nZXQoInN0YXRlIiwgIiIpID09ICJlcnJvciI6CiAgICAgICAgICAgIGhhZF9lcnJvcnMgKz0gMQogICAgICAgIGlmIG5hbWUgPT0gY29udGV4dC5uYW1lOgogICAgICAgICAgICBkZWwgcnVuc1tpXQogICAgICAgIGkgKz0gMQoKICAgIHByaW50KCJlcnJvcnM6IiwgaGFkX2Vycm9ycykKCiAgICBodG1sID0gIiMjIyBSdW4gUmVzdWx0c1xuV29ya2Zsb3cge30gZmluaXNoZWQgd2l0aCB7fSBlcnJvcnMiLmZvcm1hdCgKICAgICAgICB3b3JrZmxvd19pZCwgaGFkX2Vycm9ycwogICAgKQogICAgaHRtbCArPSAiPGJyPmNsaWNrIHRoZSBoeXBlciBsaW5rcyBiZWxvdyB0byBzZWUgZGV0YWlsZWQgcmVzdWx0czxicj4iCiAgICBodG1sICs9IHJ1bnMuc2hvdyhkaXNwbGF5PUZhbHNlLCBzaG9ydD1UcnVlKQogICAgaWYgcmVwbzoKICAgICAgICBwcl9jb21tZW50KGNvbnRleHQsIHJlcG8sIGlzc3VlLCBodG1sKQogICAgZWxzZToKICAgICAgICBwcmludCgicmVwbyBub3QgZGVmaW5lZCIpCiAgICAgICAgcHJpbnQoaHRtbCkK
    commands: []
    code_origin: https://github.com/daniels290813/functions.git#55a79c32be5d233cc11efcf40cd3edbe309bfdef:/home/kali/functions/github_utils/github_utils.py
  affinity: null
verbose: false

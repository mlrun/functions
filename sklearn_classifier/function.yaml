kind: job
metadata:
  name: sklearn-classifier
  tag: ''
  hash: bd06f402df792a4c25205060adb4b813101db980
  project: ''
  labels:
    author: yjb
    stage: development
  categories:
  - models
  - classifier
spec:
  command: ''
  args: []
  image: mlrun/ml-models:0.4.5
  env: []
  default_handler: train_model
  description: ''
  build:
    functionSourceCode: aW1wb3J0IG9zCmltcG9ydCBqc29uCmltcG9ydCBpbXBvcnRsaWIKZnJvbSBjbG91ZHBpY2tsZSBpbXBvcnQgZHVtcAoKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IHB5YXJyb3cucGFycXVldCBhcyBwcQppbXBvcnQgcHlhcnJvdyBhcyBwYQoKI2Zyb20gc2tsZWFybi5wcmVwcm9jZXNzaW5nIGltcG9ydCBTdGFuZGFyZFNjYWxlcgpmcm9tIHNrbGVhcm4ubW9kZWxfc2VsZWN0aW9uIGltcG9ydCB0cmFpbl90ZXN0X3NwbGl0CmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCAocm9jX2F1Y19zY29yZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjFfc2NvcmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXVjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2ZXJhZ2VfcHJlY2lzaW9uX3Njb3JlLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2NfY3VydmUsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZ1c2lvbl9tYXRyaXgpCmZyb20gc2tsZWFybi5wcmVwcm9jZXNzaW5nIGltcG9ydCBsYWJlbF9iaW5hcml6ZQoKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAppbXBvcnQgc2VhYm9ybiBhcyBzbnMKCmZyb20geWVsbG93YnJpY2suY2xhc3NpZmllciBpbXBvcnQgQ29uZnVzaW9uTWF0cml4Cgpmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9uYWwsIFVuaW9uLCBMaXN0Cgpmcm9tIG1scnVuLmV4ZWN1dGlvbiBpbXBvcnQgTUxDbGllbnRDdHgKZnJvbSBtbHJ1bi5kYXRhc3RvcmUgaW1wb3J0IERhdGFJdGVtCmZyb20gbWxydW4uYXJ0aWZhY3RzIGltcG9ydCBQbG90QXJ0aWZhY3QsIFRhYmxlQXJ0aWZhY3QKCmltcG9ydCB3YXJuaW5ncwp3YXJuaW5ncy5zaW1wbGVmaWx0ZXIoYWN0aW9uPSJpZ25vcmUiLCBjYXRlZ29yeT1GdXR1cmVXYXJuaW5nKQoKZGVmIF9nY2ZfY2xlYXIocGx0KToKICAgIHBsdC5jbGEoKQogICAgcGx0LmNsZigpCiAgICBwbHQuY2xvc2UoKSAKCmRlZiB0cmFpbl9tb2RlbCgKICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgZGF0YV9rZXk6IFVuaW9uW0RhdGFJdGVtLCBzdHJdLAogICAgc2FtcGxlOiBpbnQsCiAgICBsYWJlbF9jb2x1bW46IHN0ciwKICAgIG1vZGVsX2tleTogc3RyID0gIm1vZGVsIiwgCiAgICB0ZXN0X3NpemU6IGZsb2F0ID0gMC4xLAogICAgdHJhaW5fdmFsX3NwbGl0OiBmbG9hdCA9IDAuNzUsCiAgICBybmc6IGludCA9IDEsCiAgICBzY29yZV9tZXRob2Q6IHN0ciA9ICdtaWNybycsCiAgICBjbGFzc19wYXJhbXM6IFVuaW9uW0RhdGFJdGVtLCBkaWN0XSA9IHt9LAogICAgZml0X3BhcmFtczogVW5pb25bRGF0YUl0ZW0sIGRpY3RdID0ge30KKSAtPiBOb25lOgogICAgIiIidHJhaW4gYSBjbGFzc2lmaWVyLgoKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgIHRoZSBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gZGF0YV9rZXk6ICAgICAgICAoInJhdyIpIG5hbWUgb2YgcmF3IGRhdGEgZmlsZQogICAgOnBhcmFtIHNhbXBsZTogICAgICAgICAgU2VsZWN0cyB0aGUgZmlyc3QgbiByb3dzLCBvciBzZWxlY3QgYSBzYW1wbGUgc3RhcnRpbmcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gdGhlIGZpcnN0LiBJZiBuZWdhdGl2ZSA8LTEsIHNlbGVjdCBhIHJhbmRvbSBzYW1wbGUKICAgIDpwYXJhbSBsYWJlbF9jb2x1bW46ICAgIGdyb3VuZC10cnV0aCAoeSkgbGFiZWxzCiAgICA6cGFyYW0gbW9kZWxfa2V5OiAgICAgICAoJ21vZGVsJykgbmFtZSBvZiBtb2RlbCBpbiBhcnRpZmFjdCBzdG9yZSwgcG9pbnRzIHRvIGEgZGlyZWN0b3J5CiAgICA6cGFyYW0gdGVzdF9zaXplOiAgICAgICAoMC4xKSB0ZXN0IHNldCBzaXplCiAgICA6cGFyYW0gdHJhaW5fdmFsX3NwbGl0OiAoMC43NSkgT25jZSB0aGUgdGVzdCBzZXQgaGFzIGJlZW4gcmVtb3ZlZCB0aGUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFpbmluZyBzZXQgZ2V0cyB0aGlzIHByb3BvcnRpb24uCiAgICA6cGFyYW0gcm5nOiAgICAgICAgICAgICAoMSkgc2tsZWFybiBybmcgc2VlZAogICAgOnBhcmFtIHNjb3JlX21ldGhvZDogICAgIGZvciBtdWx0aWNsYXNzIGNsYXNzaWZpY2F0aW9uCiAgICA6cGFyYW0gY2xhc3NfcGFyYW1zOiAgICBzY2lraXQtbGVhcm4gY2xhc3NpZmllciBwYXJhbXMsIGVpdGhlciBpbnB1dCBhcyBkaWN0IG9yIERhdGFJdGVtIGZyb20KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgcHJlY2VkaW5nIEt1YmVmbG93IHBpcGVsaW5lIHN0ZXAKICAgIDpwYXJhbSBmaXRfcGFyYW1zOiAgICAgIHNjaWtpdC1sZWFybiBmaXQgcGFyYW1ldGVycywgZWl0aGVyIGlucHV0IGFzIGRpY3Qgb3IgRGF0YUl0ZW0gZnJvbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSBwcmVjZWRpbmcgS3ViZWZsb3cgcGlwZWxpbmUgc3RlcAogICAgIiIiCiAgICBiYXNlX3BhdGggPSBjb250ZXh0LmFydGlmYWN0X3BhdGgKICAgIG9zLm1ha2VkaXJzKGJhc2VfcGF0aCwgZXhpc3Rfb2s9VHJ1ZSkKICAgIG9zLm1ha2VkaXJzKGJhc2VfcGF0aCsiL21vZGVscyIsIGV4aXN0X29rPVRydWUpCiAgICBvcy5tYWtlZGlycyhiYXNlX3BhdGgrIi9wbG90cyIsIGV4aXN0X29rPVRydWUpCiAgICAKICAgIHNyY2ZpbGVwYXRoID0gc3RyKGRhdGFfa2V5KQogICAgCiAgICAjIGdldCBhbGwgZGF0YSBvciBhIHNhbXBsZQogICAgaWYgKHNhbXBsZSA9PSAtMSkgb3IgKHNhbXBsZSA+PSAxKToKICAgICAgICAjIGdldCBhbGwgcm93cywgb3IgY29udGlndW91cyBzYW1wbGUgc3RhcnRpbmcgYXQgcm93IDEuCiAgICAgICAgcmF3ID0gcHEucmVhZF90YWJsZShzcmNmaWxlcGF0aCkudG9fcGFuZGFzKCkuZHJvcG5hKCkKICAgICAgICBsYWJlbHMgPSByYXcucG9wKGxhYmVsX2NvbHVtbikKICAgICAgICByYXcgPSByYXcuaWxvY1s6c2FtcGxlLCA6XQogICAgICAgIGxhYmVscyA9IGxhYmVscy5pbG9jWzpzYW1wbGVdCiAgICBlbHNlOgogICAgICAgICMgZ3JhYiBhIHJhbmRvbSBzYW1wbGUKICAgICAgICByYXcgPSBwcS5yZWFkX3RhYmxlKHNyY2ZpbGVwYXRoKS50b19wYW5kYXMoKS5kcm9wbmEoKS5zYW1wbGUoc2FtcGxlKi0xKQogICAgICAgIGxhYmVscyA9IHJhdy5wb3AobGFiZWxfY29sdW1uKQoKICAgICMgdGhpcyB1c2VkIGJ5IHBsb3R0aW5nIG1ldGhvZHMKICAgIGNvbnRleHQuaGVhZGVyID0gcmF3LmNvbHVtbnMudmFsdWVzCiAgICAKICAgICMgZG91YmxlIHNwbGl0IHRvIGdlbmVyYXRlIDMgZGF0YSBzZXRzOiB0cmFpbiwgdmFsaWRhdGlvbiBhbmQgdGVzdAogICAgIyB3aXRoIHh0ZXN0LHl0ZXN0IHNldCBhc2lkZQogICAgeCwgeHRlc3QsIHksIHl0ZXN0ID0gdHJhaW5fdGVzdF9zcGxpdChyYXcudmFsdWVzLCBsYWJlbHMudmFsdWVzLCB0ZXN0X3NpemU9dGVzdF9zaXplLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZG9tX3N0YXRlPXJuZykKICAgCiAgICB4dHJhaW4sIHh2YWxpZCwgeXRyYWluLCB5dmFsaWQgPSB0cmFpbl90ZXN0X3NwbGl0KHgsIHksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFpbl9zaXplPXRyYWluX3ZhbF9zcGxpdCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbV9zdGF0ZT1ybmcpCiAgICBjbGFzc2VzID0gbGlzdChyYW5nZSh4dHJhaW4uc2hhcGVbMV0pKQogICAgeXRyYWluYiA9IGxhYmVsX2JpbmFyaXplKHl0cmFpbiwgY2xhc3Nlcz1jbGFzc2VzKQogICAgeXZhbGlkYiA9IGxhYmVsX2JpbmFyaXplKHl2YWxpZCwgY2xhc3Nlcz1jbGFzc2VzKQogICAgCiAgICBmaWxlcGF0aCA9IG9zLnBhdGguam9pbihiYXNlX3BhdGgsICJ0ZXN0X3NldC5jc3YiKQogICAgcGQuY29uY2F0KFtwZC5EYXRhRnJhbWUoZGF0YT14dGVzdCwgY29sdW1ucz0gY29udGV4dC5oZWFkZXIpLCAKICAgICAgICAgICAgICAgcGQuRGF0YUZyYW1lKGRhdGE9eXRlc3QsIGNvbHVtbnM9W2xhYmVsX2NvbHVtbl0pXSwgYXhpcz0xKS50b19jc3YoZmlsZXBhdGgsIGluZGV4PUZhbHNlKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoInRlc3Rfc2V0IiwgbG9jYWxfcGF0aD0idGVzdF9zZXQuY3N2IikgICAKCiAgICBjbGFzc19wYXJhbXMgPSBqc29uLmxvYWRzKGNsYXNzX3BhcmFtcy5nZXQoKSkKICAgIGZpdF9wYXJhbXMgPSBqc29uLmxvYWRzKGZpdF9wYXJhbXMuZ2V0KCkpCgogICAgIyBjcmVhdGUgQ2xhc3NpZmllckNsYXNzIGZyb20gc3RyaW5nIGFuZCBpbnN0YW50aWF0ZQogICAgY2xhc3NpZmllciA9IGNsYXNzX3BhcmFtcy5wb3AoImNsYXNzaWZpZXIiLCBOb25lKQogICAgc3BsaXRzID0gY2xhc3NpZmllci5zcGxpdCgiLiIpCiAgICBjbGZjbGFzcyA9IHNwbGl0c1stMV0KICAgIHBrZ19tb2R1bGUgPSBzcGxpdHNbOi0xXQogICAgQ2xhc3NpZmllckNsYXNzID0gZ2V0YXR0cihpbXBvcnRsaWIuaW1wb3J0X21vZHVsZSgiLiIuam9pbihwa2dfbW9kdWxlKSksIGNsZmNsYXNzKQogICAgCiAgICBpZiAiY2FsbGJhY2tzIiBpbiBmaXRfcGFyYW1zOgogICAgICAgICMgY3JlYXRlIGNhbGxiYWNrcyBmcm9tIHN0cmluZ3MgYW5kIGluc3RhbnRpYXRlIHdpdGggcGFyYW1ldGVyIGBldmFsc19yZXN1bHRgCiAgICAgICAgc3BsaXRzID0gZml0X3BhcmFtcy5wb3AoImNhbGxiYWNrcyIsIE5vbmUpLnNwbGl0KCIuIikKICAgICAgICBwa2dfbW9kdWxlID0gIi4iLmpvaW4oc3BsaXRzWzotMV0pCiAgICAgICAgY2JfZm5hbWUgPSBzcGxpdHNbLTFdCiAgICAgICAgcGtnX21vZHVsZSA9IF9faW1wb3J0X18ocGtnX21vZHVsZSwgZnJvbWxpc3Q9W2NiX2ZuYW1lXSkKICAgICAgICBldmFsc19yZXN1bHQgPSBkaWN0KCkKICAgICAgICBjYWxsYmFja3MgPSBbZ2V0YXR0cihwa2dfbW9kdWxlLCBjYl9mbmFtZSkoZXZhbHNfcmVzdWx0KV0KICAgIAogICAgbW9kZWwgPSAgQ2xhc3NpZmllckNsYXNzKCoqY2xhc3NfcGFyYW1zKQoKICAgIG1vZGVsLmZpdCh4dHJhaW4sCiAgICAgICAgICAgICAgeXRyYWluLAojICAgICAgICAgICAgICAgZXZhbF9zZXQ9Wyh4dHJhaW4sIHl0cmFpbiksICh4dmFsaWQsIHl2YWxpZCldLAojICAgICAgICAgICAgICAgZXZhbF9tZXRyaWM9ImF1YyIsCiMgICAgICAgICAgICAgICBjYWxsYmFja3M9Y2FsbGJhY2tzLAogICAgICAgICAgICAgICoqZml0X3BhcmFtcykKICAgIAogICAgZHVtcChtb2RlbCwgb3Blbihvcy5wYXRoLmpvaW4oYmFzZV9wYXRoLCAibW9kZWxzL21vZGVsLnBrbCIpLCAid2IiKSkKICAgIAogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QobW9kZWxfa2V5LCBsb2NhbF9wYXRoPSJtb2RlbHMiKQogICAgCiAgICAjIGNvbXB1dGUgdmFsaWRhdGlvbiBtZXRyaWNzCiAgICB5cHJlZCA9IG1vZGVsLnByZWRpY3QoeHZhbGlkKSAjID09IGJlc3RfbGFiZWwKICAgIHlfc2NvcmUgPSBtb2RlbC5wcmVkaWN0X3Byb2JhKHh2YWxpZCkgIyBub2JzIHggY2xhc3NlcyBwcm9icyBtYXRyaXgKICAgIAogICAgYXZlcmFnZV9wcmVjaXNpb24gPSBhdmVyYWdlX3ByZWNpc2lvbl9zY29yZSh5dmFsaWRiLCB5X3Njb3JlLCBhdmVyYWdlPXNjb3JlX21ldGhvZCkKCiAgICBjb250ZXh0LmxvZ19yZXN1bHQoZiJhY2N1cmFjeSIsIGZsb2F0KG1vZGVsLnNjb3JlKHh2YWxpZCwgeXZhbGlkKSkpCiAgICBjb250ZXh0LmxvZ19yZXN1bHQoZiJyb2NhdWMiLCByb2NfYXVjX3Njb3JlKHl2YWxpZGIsIHlfc2NvcmUpKQogICAgY29udGV4dC5sb2dfcmVzdWx0KGYiZjFfc2NvcmUiLCBmMV9zY29yZSh5dmFsaWQsIHlwcmVkLCBhdmVyYWdlPXNjb3JlX21ldGhvZCkpCiAgICBjb250ZXh0LmxvZ19yZXN1bHQoZiJhdmdfcHJlY3Njb3JlIiwgYXZlcmFnZV9wcmVjaXNpb24pCiAgICAKICAgICMgcGxvdCBST0MgdXNpbmcgdmFsaWRhdGlvbiBzZXQKICAgIHBsb3Rfcm9jKGNvbnRleHQsIAogICAgICAgICAgICAgeXZhbGlkYiwgCiAgICAgICAgICAgICB5X3Njb3JlLAogICAgICAgICAgICAga2V5PSJyb2MiKQogICAgCiAgICAjIHBsb3QgdHJhaW5pbmcgaGlzdG9yeSBtZXRyaWNzLCBzYXZlIGFuZCBsb2c6CgojICAgICBpZiAidHJhaW5pbmciIGluIGV2YWxzX3Jlc3VsdDoKIyAgICAgICAgIHRyYWluX2F1YyA9IG5wLmFzYXJyYXkoZXZhbHNfcmVzdWx0WyJ0cmFpbmluZyJdWyJhdWMiXSwgZHR5cGU9bnAuZmxvYXQpCiMgICAgICAgICB0cmFpbl9sb2dsb3NzID0gbnAuYXNhcnJheShldmFsc19yZXN1bHRbInRyYWluaW5nIl1bImJpbmFyeV9sb2dsb3NzIl0sIGR0eXBlPW5wLmZsb2F0KQojICAgICAgICAgdmFsX2F1YyA9IG5wLmFzYXJyYXkoZXZhbHNfcmVzdWx0WyJ2YWxpZF8xIl1bImF1YyJdLCBkdHlwZT1ucC5mbG9hdCkKIyAgICAgICAgIHZhbF9sb2dsb3NzID0gbnAuYXNhcnJheShldmFsc19yZXN1bHRbInZhbGlkXzEiXVsiYmluYXJ5X2xvZ2xvc3MiXSwgZHR5cGU9bnAuZmxvYXQpCgojICAgICBwbG90X3ZhbGlkYXRpb24oCiMgICAgICAgICBjb250ZXh0LCAKIyAgICAgICAgIFsodHJhaW5fYXVjLCB2YWxfYXVjKSwgKHRyYWluX2xvZ2xvc3MsIHZhbF9sb2dsb3NzKV0sIAojICAgICAgICAga2V5PSJoaXN0b3J5IiwgCiMgICAgICAgICB0aXRsZT0idHJhaW5pbmcgbWV0cmljcyIpCgojICAgICAjIHBsb3QgY29uZnVzaW9uIG1hdHJpeCB1c2luZyB2YWxpZGF0aW9uIHNldAojICAgICAjIFRPRE86IHJlcGxhY2Ugd2l0aCBza2xlYXJuIG9yIHllbGxvd2JyaWNrIGNsYXNzaWZpY2F0aW9uIHJlcG9ydAogICAgcGxvdF9jb25mdXNpb25fbWF0cml4KAogICAgICAgIGNvbnRleHQsIAogICAgICAgIHl2YWxpZCwgCiAgICAgICAgeXByZWQsCiAgICAgICAga2V5PSJjb25mdXNpb24iLAogICAgICAgIGZtdD0icG5nIikKCiMgICAgIHBsb3QgZmVhdHVyZSBpbXBvcnRhbmNlcwogICAgaWYgaGFzYXR0cihtb2RlbCwgImZlYXR1cmVfaW1wb3J0YW5jZXNfIik6CiAgICAgICAgcGxvdF9pbXBvcnRhbmNlKGNvbnRleHQsIG1vZGVsLCBrZXk9ZiJmZWF0aW1wIikKICAgIApkZWYgcGxvdF92YWxpZGF0aW9uKAogICAgY29udGV4dDogTUxDbGllbnRDdHgsCiAgICBtZXRyaWNzLCAjIGxpc3Qgb2YgdHVwbGUodmVjLCB2ZWMpCiAgICBrZXk6IHN0ciA9ICJ0cmFpbmluZy1oaXN0b3J5IiwKICAgIHRpdGxlOiBzdHIgPSAiYXVjIGFuZCBsb2dsb3NzIiwKICAgIGZtdD0icG5nIgopOgogICAgIiIiUGxvdCB0cmFpbiBhbmQgdmFsaWRhdGlvbiBsb3NzIGN1cnZlcwoKICAgIFRoZXNlIGN1cnZlcyByZXByZXNlbnQgdGhlIHRyYWluaW5nIHJvdW5kIG1ldHJpY3MgZnJvbSB0aGUgdHJhaW5pbmcKICAgIGFuZCB2YWxpZGF0aW9uIHNldHMuCiAgICAKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgIHRoZSBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gdHJhaW5fbWV0cmljOiAgICB0cmFpbiBtZXRyaWMKICAgIDpwYXJhbSB2YWxpZF9tZXRyaWM6ICAgIHZhbGlkYXRpb24gbWV0cmljCiAgICAiIiIKICAgIF9nY2ZfY2xlYXIocGx0KQogICAgCiAgICAjIGdlbmVyYXRlIHBsb3QKICAgIGZvciBtZXRyaWMgaW4gbWV0cmljczoKICAgICAgICBwbHQucGxvdChtZXRyaWNbMF0pCiAgICAgICAgcGx0LnBsb3QobWV0cmljWzFdKQoKICAgIHBsdC50aXRsZShmInRyYWluaW5nIGhpc3RvcnkgLSB7dGl0bGV9IikKICAgIHBsdC54bGFiZWwoImVwb2NoIikKICAgIHBsdC55bGFiZWwoIiIpCiAgICBwbHQubGVnZW5kKFsiYXVjOnRyYWluIiwgImF1Yzp2YWxpZCIsICJsb2dsb3NzOnRyYWluIiwgImxvZ2xvc3M6dmFsaWQiXSkKCiAgICAjIHNhdmUgZmlndXJlIGFuZCBsb2cgYXJ0aWZhY3QKICAgIHBsdC5zYXZlZmlnKG9zLnBhdGguam9pbihjb250ZXh0LmFydGlmYWN0X3BhdGgsIGYicGxvdHMve2tleX0ue2ZtdH0iKSkKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFBsb3RBcnRpZmFjdChrZXksICBib2R5PXBsdC5nY2YoKSksIGxvY2FsX3BhdGg9ZiJwbG90cy97a2V5fS57Zm10fSIpCiAgICAKZGVmIHBsb3Rfcm9jKAogICAgY29udGV4dDogTUxDbGllbnRDdHgsIAogICAgeV9sYWJlbHMsCiAgICB5X3Byb2JzLAogICAga2V5PSJyb2MiLAogICAgZm10PSJwbmciCik6CiAgICAiIiJQbG90IGFuIFJPQyBjdXJ2ZSBmcm9tIHRlc3QgZGF0YSBzYXZlZCBpbiBhbiBhcnRpZmFjdCBzdG9yZS4KICAgIAogICAgOnBhcmFtIGNvbnRleHQ6ICAgICAgICAgZnVuY3Rpb24gY29udGV4dAogICAgOnBhcmFtIHlfbGFiZWxzOiAgICAgICAgdGVzdCBkYXRhIGxhYmVscwogICAgOnBhcmFtIHlfcHJvYnM6ICAgICAgICAgdGVzdCBkYXRhIAogICAgIiIiCiAgICBfZ2NmX2NsZWFyKHBsdCkKICAgIAogICAgZnByID0gZGljdCgpCiAgICB0cHIgPSBkaWN0KCkKICAgIHJvY19hdWMgPSBkaWN0KCkKICAgIHBsdC5wbG90KFswLCAxXSwgWzAsIDFdLCAiay0tIikKICAgIHBsdC54bGFiZWwoImZhbHNlIHBvc2l0aXZlIHJhdGUiKQogICAgcGx0LnlsYWJlbCgidHJ1ZSBwb3NpdGl2ZSByYXRlIikKICAgIHBsdC50aXRsZSgicm9jIGN1cnZlIikKICAgIHBsdC5sZWdlbmQobG9jPSJiZXN0IikKICAgIGZvciBpIGluIHJhbmdlKHlfbGFiZWxzLnNoYXBlWzFdKToKICAgICAgICBmcHJbaV0sIHRwcltpXSwgXyA9IHJvY19jdXJ2ZSh5X2xhYmVsc1s6LCBpXSwgeV9wcm9ic1s6LCBpXSkKICAgICAgICByb2NfYXVjW2ldID0gYXVjKGZwcltpXSwgdHByW2ldKQogICAgICAgIHBsdC5wbG90KGZwcltpXSwgdHByW2ldLCBsYWJlbD1mImNsYXNzIHtpfSIpCgogICAgZmlnID0gcGx0LmdjZigpCiAgICBmaWcuc2F2ZWZpZyhvcy5wYXRoLmpvaW4oY29udGV4dC5hcnRpZmFjdF9wYXRoLCBmInBsb3RzL3trZXl9LntmbXR9IikpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChQbG90QXJ0aWZhY3Qoa2V5LCAgYm9keT1maWcpLCBsb2NhbF9wYXRoPWYicGxvdHMve2tleX0ue2ZtdH0iKQoKZGVmIHBsb3RfY29uZnVzaW9uX21hdHJpeCgKICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LCAKICAgIGxhYmVscywgCiAgICBwcmVkaWN0aW9ucywKICAgIGtleTogc3RyID0iY29uZnVzaW9uX21hdHJpeCIsCiAgICBmbXQ6IHN0ciA9ICJwbmciCik6CiAgICAiIiJDcmVhdGUgYSBjb25mdXNpb24gbWF0cml4LgogICAgUGxvdCBhbmQgc2F2ZSBhIGNvbmZ1c2lvbiBtYXRyaXggdXNpbmcgdGVzdCBkYXRhIGZyb20gYQogICAgbW9kZWxsaW5lIHN0ZXAuCiAgICA6cGFyYW0gY29udGV4dDogICAgICAgICBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gbGFiZWxzOiAgICAgICAgICB0ZXN0IGRhdGEgbGFiZWxzCiAgICA6cGFyYW0gcHJlZGljdGlvbnM6ICAgICB0ZXN0IGRhdGEgcHJlZGljdGlvbnMKICAgICIiIgogICAgX2djZl9jbGVhcihwbHQpCgogICAgY20gPSBjb25mdXNpb25fbWF0cml4KGxhYmVscywKICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVkaWN0aW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVfd2VpZ2h0PU5vbmUpCiAgICAjICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplPSJhbGwiKQogICAgc25zLmhlYXRtYXAoY20sIGFubm90PVRydWUsIGNtYXA9IkJsdWVzIikKCiAgICBmaWcgPSBwbHQuZ2NmKCkKICAgIGZpZy5zYXZlZmlnKG9zLnBhdGguam9pbihjb250ZXh0LmFydGlmYWN0X3BhdGgsIGYicGxvdHMve2tleX0ue2ZtdH0iKSkKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFBsb3RBcnRpZmFjdChrZXksICBib2R5PWZpZyksIGxvY2FsX3BhdGg9ZiJwbG90cy97a2V5fS57Zm10fSIpCgogICAgX2djZl9jbGVhcihwbHQpCgpkZWYgcGxvdF9pbXBvcnRhbmNlKAogICAgY29udGV4dCwKICAgIG1vZGVsLAogICAga2V5OiBzdHIgPSAiZmVhdHVyZS1pbXBvcnRhbmNlcyIsCiAgICBmbXQgPSAicG5nIgopOgogICAgIiIiRGlzcGxheSBlc3RpbWF0ZWQgZmVhdHVyZSBpbXBvcnRhbmNlcy4KICAgIDpwYXJhbSBjb250ZXh0OiAgICAgZnVuY3Rpb24gY29udGV4dAogICAgOnBhcmFtIG1vZGVsOiAgICAgICBmaXR0ZWQgbGlnaHRnYm0gbW9kZWwKICAgICIiIgogICAgX2djZl9jbGVhcihwbHQpCiAgICAKICAgICMgY3JlYXRlIGEgZmVhdHVyZSBpbXBvcnRhbmNlIHRhYmxlIHdpdGggZGVzaXJlZCBsYWJlbHMKICAgIHppcHBlZCA9IHppcChtb2RlbC5mZWF0dXJlX2ltcG9ydGFuY2VzXywgY29udGV4dC5oZWFkZXIpCgogICAgZmVhdHVyZV9pbXAgPSBwZC5EYXRhRnJhbWUoc29ydGVkKHppcHBlZCksIGNvbHVtbnM9WyJmcmVxIiwiZmVhdHVyZSJdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5zb3J0X3ZhbHVlcyhieT0iZnJlcSIsIGFzY2VuZGluZz1GYWxzZSkKCiAgICBwbHQuZmlndXJlKGZpZ3NpemU9KDIwLCAxMCkpCiAgICBzbnMuYmFycGxvdCh4PSJmcmVxIiwgeT0iZmVhdHVyZSIsIGRhdGE9ZmVhdHVyZV9pbXApCiAgICBwbHQudGl0bGUoImZlYXR1cmVzIikKICAgIHBsdC50aWdodF9sYXlvdXQoKQoKICAgIGZpZyA9IHBsdC5nY2YoKQogICAgZmlnLnNhdmVmaWcob3MucGF0aC5qb2luKGNvbnRleHQuYXJ0aWZhY3RfcGF0aCwgZiJwbG90cy97a2V5fS57Zm10fSIpKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KGYie2tleX0ue2ZtdH0iLCBib2R5PWZpZyksIGxvY2FsX3BhdGg9ZiJwbG90cy97a2V5fS57Zm10fSIpCgogICAgIyBmZWF0dXJlIGltcG9ydGFuY2VzIGFyZSBhbHNvIHNhdmVkIGFzIGEgdGFibGU6CiAgICBmZWF0dXJlX2ltcC50b19jc3Yob3MucGF0aC5qb2luKGNvbnRleHQuYXJ0aWZhY3RfcGF0aCwga2V5KyIuY3N2IikpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChrZXkrIi5jc3YiLCBsb2NhbF9wYXRoPWtleSsiLmNzdiIpCgogICAgX2djZl9jbGVhcihwbHQp
    commands: []
    code_origin: https://github.com/mlrun/functions.git#62abab3deb63f23fcf0bcf93abc5e743f8f483d5:sklearn_classifier/sklearn_classifier.py

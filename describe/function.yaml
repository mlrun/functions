kind: job
metadata:
  name: describe
  tag: latest
  hash: 22192569c74f99592f77a26605e568c08de7fe9b
  project: ''
  labels:
    author: yjb
  categories:
  - models
  - visualization
spec:
  command: ''
  args: []
  image: mlrun/ml-models
  env: []
  default_handler: summarize
  entry_points:
    _gcf_clear:
      name: _gcf_clear
      doc: ''
      parameters:
      - name: plt
      outputs: []
      lineno: 20
    summarize:
      name: summarize
      doc: Summarize a table
      parameters:
      - name: context
        type: MLClientCtx
        doc: the function context
      - name: table
        type: str
        doc: pandas dataframe (csv/parquet file path)
      - name: label_column
        type: str
        doc: ground truth column label
        default: labels
      - name: class_labels
        type: List[str]
        doc: label for each class in tables and plots
      - name: plot_hist
        type: bool
        doc: (True) set this to False for large tables
        default: true
      - name: plots_dest
        type: str
        doc: destination folder of summary plots (relative to artifact_path)
        default: plots
      outputs: []
      lineno: 25
  description: describe and visualizes dataset stats
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlciBvbiAyMDIwLTAzLTMxIDE0OjI5CgppbXBvcnQgb3MKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAppbXBvcnQgc2VhYm9ybiBhcyBzbnMKCmZyb20gbWxydW4uZXhlY3V0aW9uIGltcG9ydCBNTENsaWVudEN0eApmcm9tIG1scnVuLmRhdGFzdG9yZSBpbXBvcnQgRGF0YUl0ZW0KZnJvbSBtbHJ1bi5hcnRpZmFjdHMgaW1wb3J0IFBsb3RBcnRpZmFjdCwgVGFibGVBcnRpZmFjdAoKZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IFN0YW5kYXJkU2NhbGVyCmZyb20geWVsbG93YnJpY2sgaW1wb3J0IENsYXNzQmFsYW5jZQoKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QKCnBkLnNldF9vcHRpb24oImRpc3BsYXkuZmxvYXRfZm9ybWF0IiwgbGFtYmRhIHg6ICIlLjJmIiAlIHgpCgpkZWYgX2djZl9jbGVhcihwbHQpOgogICAgcGx0LmNsYSgpCiAgICBwbHQuY2xmKCkKICAgIHBsdC5jbG9zZSgpIAoKZGVmIHN1bW1hcml6ZSgKICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgdGFibGU6IHN0ciwKICAgIGxhYmVsX2NvbHVtbjogc3RyID0gJ2xhYmVscycsCiAgICBjbGFzc19sYWJlbHM6IExpc3Rbc3RyXSA9IFtdLAogICAgcGxvdF9oaXN0OiBib29sID0gVHJ1ZSwKICAgIHBsb3RzX2Rlc3Q6IHN0ciA9ICdwbG90cycKKSAtPiBOb25lOgogICAgIiIiU3VtbWFyaXplIGEgdGFibGUKCiAgICA6cGFyYW0gY29udGV4dDogICAgICAgICB0aGUgZnVuY3Rpb24gY29udGV4dAogICAgOnBhcmFtIHRhYmxlOiAgICAgICAgICAgcGFuZGFzIGRhdGFmcmFtZSAoY3N2L3BhcnF1ZXQgZmlsZSBwYXRoKQogICAgOnBhcmFtIGxhYmVsX2NvbHVtbjogICAgZ3JvdW5kIHRydXRoIGNvbHVtbiBsYWJlbAogICAgOnBhcmFtIGNsYXNzX2xhYmVsczogICAgbGFiZWwgZm9yIGVhY2ggY2xhc3MgaW4gdGFibGVzIGFuZCBwbG90cwogICAgOnBhcmFtIHBsb3RfaGlzdDogICAgICAgKFRydWUpIHNldCB0aGlzIHRvIEZhbHNlIGZvciBsYXJnZSB0YWJsZXMKICAgIDpwYXJhbSBwbG90c19kZXN0OiAgICAgIGRlc3RpbmF0aW9uIGZvbGRlciBvZiBzdW1tYXJ5IHBsb3RzIChyZWxhdGl2ZSB0byBhcnRpZmFjdF9wYXRoKQogICAgIiIiCiAgICB0YWJsZSA9IHN0cih0YWJsZSkKICAgIGlmIHRhYmxlLmVuZHN3aXRoKCcuY3N2Jyk6CiAgICAgICAgdGFibGUgPSBwZC5yZWFkX2Nzdih0YWJsZSkKICAgIGVsc2U6IAogICAgICAgIHRhYmxlID0gcGQucmVhZF9wYXJxdWV0KHRhYmxlKQogICAgaGVhZGVyID0gdGFibGUuY29sdW1ucy52YWx1ZXMKICAgIAogICAgX2djZl9jbGVhcihwbHQpCiAgICBzbnNwbHQgPSBzbnMucGFpcnBsb3QodGFibGUsIGh1ZT1sYWJlbF9jb2x1bW4sIGRpYWdfa3dzPXsnYncnOiAxLjV9KQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KCdoaXN0b2dyYW1zJywgIGJvZHk9cGx0LmdjZigpKSwgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS9oaXN0Lmh0bWwiKQoKICAgIF9nY2ZfY2xlYXIocGx0KSAgIAogICAgbGFiZWxzID0gdGFibGUucG9wKGxhYmVsX2NvbHVtbikKICAgIGlmIG5vdCBjbGFzc19sYWJlbHM6CiAgICAgICAgY2xhc3NfbGFiZWxzID0gbGFiZWxzLnVuaXF1ZSgpCiAgICBjbGFzc19iYWxhbmNlX21vZGVsID0gQ2xhc3NCYWxhbmNlKGxhYmVscz1jbGFzc19sYWJlbHMpCiAgICBjbGFzc19iYWxhbmNlX21vZGVsLmZpdChsYWJlbHMpICAgCiAgICBzY2FsZV9wb3Nfd2VpZ2h0ID0gY2xhc3NfYmFsYW5jZV9tb2RlbC5zdXBwb3J0X1swXS9jbGFzc19iYWxhbmNlX21vZGVsLnN1cHBvcnRfWzFdCiAgICBjb250ZXh0LmxvZ19yZXN1bHQoInNjYWxlX3Bvc193ZWlnaHQiLCBmIntzY2FsZV9wb3Nfd2VpZ2h0OjAuMmZ9IikKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFBsb3RBcnRpZmFjdCgiaW1iYWxhbmNlIiwgYm9keT1wbHQuZ2NmKCkpLCBsb2NhbF9wYXRoPWYie3Bsb3RzX2Rlc3R9L2ltYmFsYW5jZS5odG1sIikKICAgIAogICAgX2djZl9jbGVhcihwbHQpCiAgICB0Ymxjb3JyID0gdGFibGUuY29ycigpCiAgICBheCA9IHBsdC5heGVzKCkKICAgIHNucy5oZWF0bWFwKHRibGNvcnIsIGF4PWF4LCBhbm5vdD1GYWxzZSwgY21hcD1wbHQuY20uUmVkcykKICAgIGF4LnNldF90aXRsZSgiZmVhdHVyZXMgY29ycmVsYXRpb24iKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KCJjb3JyZWxhdGlvbiIsICBib2R5PXBsdC5nY2YoKSksIGxvY2FsX3BhdGg9ZiJ7cGxvdHNfZGVzdH0vY29yci5odG1sIikKICAgIF9nY2ZfY2xlYXIocGx0KQoK
    commands: []
    code_origin: https://github.com/yjb-ds/functions.git#02cab6b12a879e6477f290e9deaf03b043bd7c16:describe.ipynb

kind: job
metadata:
  name: arc-to-parquet
  tag: ''
  hash: c6826488913674ec359334111ac9612c79881a2e
  project: ''
spec:
  command: ''
  args: []
  volumes: []
  volume_mounts: []
  env: []
  description: ''
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlciBvbiAyMDIwLTAxLTIyIDE3OjQyCgppbXBvcnQgbWxydW4KbWxydW4ubWxjb25mLmRicGF0aCA9ICdodHRwOi8vbWxydW4tYXBpOjgwODAnCgppbXBvcnQgb3MKaW1wb3J0IGpzb24KZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IHB5YXJyb3cucGFycXVldCBhcyBwcQppbXBvcnQgcHlhcnJvdyBhcyBwYQpmcm9tIHBpY2tsZSBpbXBvcnQgZHVtcCwgbG9hZAoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gdHlwaW5nIGltcG9ydCBJTywgQW55U3RyLCBVbmlvbiwgTGlzdCwgT3B0aW9uYWwKCgpkZWYgYXJjX3RvX3BhcnF1ZXQoCiAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgIGFyY2hpdmVfdXJsOiBVbmlvbltzdHIsIFBhdGgsIElPW0FueVN0cl1dLAogICAgaGVhZGVyOiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgIHRhcmdldF9wYXRoOiBzdHIgPSAiIiwKICAgIG5hbWU6IHN0ciA9ICIiLAogICAgY2h1bmtzaXplOiBpbnQgPSAxMF8wMDAsCiAgICBsb2dfZGF0YTogYm9vbCA9IFRydWUsCiAgICBhZGRfdWlkOiBib29sID0gRmFsc2UsCiAgICBrZXk6IHN0ciA9ICJyYXdfZGF0YSIsCikgLT4gTm9uZToKICAgICIiIk9wZW4gYSBmaWxlL29iamVjdCBhcmNoaXZlIGFuZCBzYXZlIGFzIGEgcGFycXVldCBmaWxlLgogICAgCiAgICA6cGFyYW0gY29udGV4dDogICAgIGZ1bmN0aW9uIGNvbnRleHQKICAgIDpwYXJhbSBhcmNoaXZlX3VybDogYW55IHZhbGlkIHN0cmluZyBwYXRoIGNvbnNpc3RlbnQgd2l0aCB0aGUgcGF0aCB2YXJpYWJsZQogICAgICAgICAgICAgICAgICAgICAgICBvZiBwYW5kYXMucmVhZF9jc3YsIGluY2x1ZGluZyBzdHJpbmdzIGFzIGZpbGUgcGF0aHMsIGFzIHVybHMsIAogICAgICAgICAgICAgICAgICAgICAgICBwYXRobGliLlBhdGggb2JqZWN0cywgZXRjLi4uCiAgICA6cGFyYW0gaGVhZGVyOiAgICAgIGNvbHVtbiBuYW1lcwogICAgOnBhcmFtIHRhcmdldF9wYXRoOiBkZXN0aW5hdGlvbiBmb2xkZXIgb2YgdGFibGUKICAgIDpwYXJhbSBuYW1lOiAgICAgICAgbmFtZSBmaWxlIHRvIGJlIHNhdmVkIGxvY2FsbHksIGFsc28KICAgIDpwYXJhbSBjaHVua3NpemU6ICAgKDApIHJvdyBzaXplIHJldHJpZXZlZCBwZXIgaXRlcmF0aW9uCiAgICA6cGFyYW0ga2V5OiAgICAgICAgIGtleSBpbiBhcnRpZmFjdCBzdG9yZSAod2hlbiBsb2dfZGF0YT1UcnVlKQogICAgIiIiCiAgICBpZiBub3QgbmFtZS5lbmRzd2l0aCgiLnBhcnF1ZXQiKToKICAgICAgICBuYW1lICs9ICIucGFycXVldCIKCiAgICBkZXN0X3BhdGggPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUpCiAgICBvcy5tYWtlZGlycyhvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgpLCBleGlzdF9vaz1UcnVlKQogICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGRlc3RfcGF0aCk6CiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygiZGVzdGluYXRpb24gZmlsZSBkb2VzIG5vdCBleGlzdCwgZG93bmxvYWRpbmciKQogICAgICAgIHBxd3JpdGVyID0gTm9uZQogICAgICAgIGZvciBpLCBkZiBpbiBlbnVtZXJhdGUocGQucmVhZF9jc3YoYXJjaGl2ZV91cmwsIGNodW5rc2l6ZT1jaHVua3NpemUsIG5hbWVzPWhlYWRlcikpOgogICAgICAgICAgICBwYXJxdWV0X3NjaGVtYSA9IHBhLlRhYmxlLmZyb21fcGFuZGFzKGRmPWRmKS5zY2hlbWEKICAgICAgICAgICAgaWYgaSA9PSAwOgogICAgICAgICAgICAgICAgcHF3cml0ZXIgPSBwcS5QYXJxdWV0V3JpdGVyKGRlc3RfcGF0aCwgcGFycXVldF9zY2hlbWEpCiAgICAgICAgICAgIHRhYmxlID0gcGEuVGFibGUuZnJvbV9wYW5kYXMoZGYsIHBhcnF1ZXRfc2NoZW1hKQogICAgICAgICAgICBwcXdyaXRlci53cml0ZV90YWJsZSh0YWJsZSkKICAgICAgICBpZiBwcXdyaXRlcjoKICAgICAgICAgICAgcHF3cml0ZXIuY2xvc2UoKQoKICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKGYic2F2ZWQgdGFibGUgdG8ge2Rlc3RfcGF0aH0iKQogICAgZWxzZToKICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCJkZXN0aW5hdGlvbiBmaWxlIGFscmVhZHkgZXhpc3RzIikKCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChrZXksIHRhcmdldF9wYXRoPWRlc3RfcGF0aCkKICAgIGZpbGVwYXRoID0gb3MucGF0aC5qb2luKHRhcmdldF9wYXRoLCAnaGVhZGVyLnBrbCcpCiAgICBkdW1wKGhlYWRlciwgb3BlbihmaWxlcGF0aCwgJ3diJykpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdCgnaGVhZGVyJywgdGFyZ2V0X3BhdGg9ZmlsZXBhdGgpICAgICAgIAoK
    base_image: yjbds/mlrun-files:latest
    commands: []
    code_origin: https://github.com/yjb-ds/functions.git#3f7e0c78313c0f8da3f2ae8535b625f06f5c3ee4:arc
      to parquet.ipynb

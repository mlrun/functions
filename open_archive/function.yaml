kind: job
metadata:
  name: open-archive
  tag: ''
  hash: 4386be68c0b48ffceceaeb1c9c350f23a1c1e3bc
  project: ''
  labels:
    author: yaronh
  categories:
  - data-movement
  - utils
spec:
  command: ''
  args: []
  image: mlrun/mlrun
  env: []
  default_handler: open_archive
  entry_points:
    open_archive:
      name: open_archive
      doc: 'Open a file/object archive into a target directory


        Currently supports zip and tar.gz'
      parameters:
      - name: context
        type: MLClientCtx
        doc: function execution context
        default: ''
      - name: archive_url
        type: DataItem
        doc: url of archive file
        default: ''
      - name: subdir
        type: str
        doc: path within artifact store where extracted files are stored
        default: content
      - name: key
        type: str
        doc: key of archive contents in artifact store
        default: content
      - name: target_path
        type: str
        doc: file system path to store extracted files (use either this or subdir)
        default: null
      outputs:
      - default: ''
      lineno: 14
  description: Open a file/object archive into a target directory
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IG9zCmltcG9ydCB6aXBmaWxlCmltcG9ydCB1cmxsaWIucmVxdWVzdAppbXBvcnQgdGFyZmlsZQppbXBvcnQganNvbgoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gbWxydW4uZGF0YXN0b3JlIGltcG9ydCBEYXRhSXRlbQoKZnJvbSB0eXBpbmcgaW1wb3J0IFVuaW9uCgpkZWYgb3Blbl9hcmNoaXZlKAogICAgY29udGV4dDogTUxDbGllbnRDdHgsIAogICAgYXJjaGl2ZV91cmw6IERhdGFJdGVtLAogICAgc3ViZGlyOiBzdHIgPSAiY29udGVudCIsCiAgICBrZXk6IHN0ciA9ICJjb250ZW50IiwKICAgIHRhcmdldF9wYXRoOiBzdHIgPSBOb25lCik6CiAgICAiIiJPcGVuIGEgZmlsZS9vYmplY3QgYXJjaGl2ZSBpbnRvIGEgdGFyZ2V0IGRpcmVjdG9yeQogICAgCiAgICBDdXJyZW50bHkgc3VwcG9ydHMgemlwIGFuZCB0YXIuZ3oKICAgIAogICAgOnBhcmFtIGNvbnRleHQ6ICAgICAgZnVuY3Rpb24gZXhlY3V0aW9uIGNvbnRleHQKICAgIDpwYXJhbSBhcmNoaXZlX3VybDogIHVybCBvZiBhcmNoaXZlIGZpbGUKICAgIDpwYXJhbSBzdWJkaXI6ICAgICAgIHBhdGggd2l0aGluIGFydGlmYWN0IHN0b3JlIHdoZXJlIGV4dHJhY3RlZCBmaWxlcwogICAgICAgICAgICAgICAgICAgICAgICAgYXJlIHN0b3JlZAogICAgOnBhcmFtIGtleTogICAgICAgICAga2V5IG9mIGFyY2hpdmUgY29udGVudHMgaW4gYXJ0aWZhY3Qgc3RvcmUKICAgIDpwYXJhbSB0YXJnZXRfcGF0aDogIGZpbGUgc3lzdGVtIHBhdGggdG8gc3RvcmUgZXh0cmFjdGVkIGZpbGVzICh1c2UgZWl0aGVyIHRoaXMgb3Igc3ViZGlyKQogICAgIiIiCiAgICBvcy5tYWtlZGlycyh0YXJnZXRfcGF0aCBvciBzdWJkaXIsIGV4aXN0X29rPVRydWUpCiAgICAKICAgIGFyY2hpdmVfdXJsID0gYXJjaGl2ZV91cmwubG9jYWwoKQogICAgaWYgYXJjaGl2ZV91cmwuZW5kc3dpdGgoImd6Iik6CiAgICAgICAgd2l0aCB0YXJmaWxlLm9wZW4oYXJjaGl2ZV91cmwsIG1vZGU9InJ8Z3oiKSBhcyByZWY6CiAgICAgICAgICAgIHJlZi5leHRyYWN0YWxsKHRhcmdldF9wYXRoIG9yIHN1YmRpcikKICAgIGVsaWYgYXJjaGl2ZV91cmwuZW5kc3dpdGgoInppcCIpOgogICAgICAgIHdpdGggemlwZmlsZS5aaXBGaWxlKGFyY2hpdmVfdXJsLCAiciIpIGFzIHJlZjoKICAgICAgICAgICAgcmVmLmV4dHJhY3RhbGwodGFyZ2V0X3BhdGggb3Igc3ViZGlyKQogICAgZWxzZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYndW5zdXBwb3J0ZWQgYXJjaGl2ZSB0eXBlIGluIHthcmNoaXZlX3VybH0nKQogICAgCiAgICBrd2FyZ3MgPSB7fQogICAgaWYgdGFyZ2V0X3BhdGg6CiAgICAgICAga3dhcmdzID0geyJ0YXJnZXRfcGF0aCI6IHRhcmdldF9wYXRofQogICAgZWxzZToKICAgICAgICBrd2FyZ3MgPSB7ImxvY2FsX3BhdGgiOiBzdWJkaXJ9CiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChrZXksICoqa3dhcmdzKQoK
    commands: []
    code_origin: git@github.com:mlrun/functions.git#16c163dbd24f9089cbd3214b0f88acfab4bb0b2a:open_archive.ipynb

kind: dask
metadata:
  name: parquet-to-dask
  tag: ''
  hash: 47322dafcd58bab9be044430a59ac88283ea1b2c
  project: ''
  labels:
    author: yjb
    stage: development
  categories:
  - fileutils
  - datagen
spec:
  command: ''
  image: mlrun/ml-dask:0.4.5
  env: []
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAxOCBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQojIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiMgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiMgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAojIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgppbXBvcnQgb3MKaW1wb3J0IGpzb24KZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgcGFuZGFzIGFzIHBkCgppbXBvcnQgZGFzawppbXBvcnQgZGFzay5kYXRhZnJhbWUgYXMgZGQKZnJvbSBkYXNrLmRpc3RyaWJ1dGVkIGltcG9ydCBDbGllbnQsIExvY2FsQ2x1c3RlcgoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gbWxydW4uZGF0YXN0b3JlIGltcG9ydCBEYXRhSXRlbQoKZnJvbSB0eXBpbmcgaW1wb3J0IElPLCBBbnlTdHIsIFVuaW9uLCBMaXN0LCBPcHRpb25hbAoKZGVmIHBhcnF1ZXRfdG9fZGFzaygKICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgcGFycXVldF91cmw6IFVuaW9uW0RhdGFJdGVtLCBzdHIsIFBhdGgsIElPW0FueVN0cl1dLAogICAgaW5jX2NvbHM6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lLAogICAgaW5kZXhfY29sczogT3B0aW9uYWxbTGlzdFtzdHJdXSA9IE5vbmUsCiAgICBzaGFyZHM6IGludCA9IDQsCiAgICB0aHJlYWRzX3BlcjogaW50ID0gNCwKICAgIHByb2Nlc3NlczogYm9vbCA9IEZhbHNlLAogICAgbWVtb3J5X2xpbWl0OiBzdHIgPSAnMkdCJywKICAgIHBlcnNpc3Q6IGJvb2wgPSBUcnVlLAogICAgZGFza19rZXk6IHN0ciA9ICdteV9kYXNrX2RhdGFmcmFtZScsCiAgICB0YXJnZXRfcGF0aDogc3RyID0gJycKKSAtPiBOb25lOgogICAgIiIiTG9hZCBwYXJxdWV0IGRhdGFzZXQgaW50byBkYXNrIGNsdXN0ZXIKICAgIAogICAgSWYgbm8gY2x1c3RlciBpcyBmb3VuZCBsb2FkcyBhIG5ldyBvbmUgYW5kIHBlcnNpc3QgdGhlIGRhdGEgdG8gaXQuIEl0CiAgICBzaG91b2xkIG5vdCBiZSBuZWNlc3NhcnkgdG8gY3JlYXRlIGEgbmV3IGNsdXN0ZXIgd2hlbiB0aGUgZnVuY3Rpb24KICAgIGlzIHJ1biBhcyBhICdkYXNrJyBqb2IuCiAgICAKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgIHRoZSBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gcGFycXVldF91cmw6ICAgICB1cmwgb2YgdGhlIHBhcnF1ZXQgZmlsZSBvciBwYXJ0aXRpb25lZCBkYXRhc2V0IGFzIGVpdGhlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJ0aWZhY3QgRGF0YUl0ZW0sIHN0cmluZywgb3IgcGF0aCBvYmplY3QgKHNlZSBwYW5kYXMgcmVhZF9jc3YpCiAgICA6cGFyYW0gaW5jX2NvbHM6ICAgICAgICBpbmNsdWRlIG9ubHkgdGhlc2UgY29sdW1ucyAodmVyeSBmYXN0KQogICAgOnBhcmFtIGluZGV4X2NvbHM6ICAgICAgbGlzdCBvZiBpbmRleCBjb2x1bW4gbmFtZXMgKGNhbiBiZSBhIGxvbmctcnVubmluZyBwcm9jZXNzKQogICAgOnBhcmFtIHNoYXJkczogICAgICAgICAgbnVtYmVyIG9mIHdvcmtlcnMgdG8gbGF1bmNoCiAgICA6cGFyYW0gdGhyZWFkc19wZXI6ICAgICBudW1iZXIgb2YgdGhyZWFkcyBwZXIgd29ya2VyCiAgICA6cGFyYW0gcHJvY2Vzc2VzOiAgICAgICAKICAgICIiIgogICAgaWYgaGFzYXR0cihjb250ZXh0LCAnZGFza19jbGllbnQnKToKICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdmb3VuZCBjbHVzdGVyLi4uJykKICAgICAgICBkYXNrX2NsaWVudCA9IGNvbnRleHQuZGFza19jbGllbnQKICAgIGVsc2U6CiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygnc3RhcnRpbmcgbmV3IGNsdXN0ZXIuLi4nKQogICAgICAgIGNsdXN0ZXIgPSBMb2NhbENsdXN0ZXIobl93b3JrZXJzPXNoYXJkcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZHNfcGVyX3dvcmtlcj10aHJlYWRzX3BlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3Nlcz1wcm9jZXNzZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1vcnlfbGltaXQ9bWVtb3J5X2xpbWl0KQogICAgICAgIGRhc2tfY2xpZW50ID0gQ2xpZW50KGNsdXN0ZXIpCiAgICAKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZGFza19jbGllbnQpCiAKICAgIGRmID0gZGQucmVhZF9wYXJxdWV0KHBhcnF1ZXRfdXJsKQoKICAgIGlmIHBlcnNpc3QgYW5kIGNvbnRleHQ6CiAgICAgICAgZGYgPSBkYXNrX2NsaWVudC5wZXJzaXN0KGRmKQogICAgICAgIGRhc2tfY2xpZW50LnB1Ymxpc2hfZGF0YXNldChkYXNrX2tleT1kZikKICAgICAgICBjb250ZXh0LmRhc2tfY2xpZW50ID0gZGFza19jbGllbnQKICAgICAgICAKICAgICAgICAjIHNoYXJlIHRoZSBzY2hlZHVsZXIKICAgICAgICBmaWxlcGF0aCA9IG9zLnBhdGguam9pbih0YXJnZXRfcGF0aCwgJ3NjaGVkdWxlci5qc29uJykKICAgICAgICBkYXNrX2NsaWVudC53cml0ZV9zY2hlZHVsZXJfZmlsZShmaWxlcGF0aCkKICAgICAgICBjb250ZXh0LmxvZ19hcnRpZmFjdCgnc2NoZWR1bGVyJywgdGFyZ2V0X3BhdGg9ZmlsZXBhdGgpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZGYuaGVhZCgpKQo=
    commands: []
    code_origin: https://github.com/mlrun/functions.git#b0ba922e10fa0af2fcf2e04cce51eb7d9243bf25:parquet_to_dask/parquet_to_dask.py
  description: ''
  nthreads: 1
  min_replicas: 0
  max_replicas: 16
  scheduler_timeout: 60 minutes

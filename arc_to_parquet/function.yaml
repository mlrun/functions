kind: job
metadata:
  name: arc-to-parquet
  tag: ''
  hash: d595cd19ea36b288cee783f585dc45a3f32d238e
  project: ''
  categories: []
spec:
  command: ''
  args: []
  image: mlrun/ml-base:0.4.5
  env: []
  default_handler: arc_to_parquet
  description: ''
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAxOCBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQojIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiMgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiMgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAojIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKaW1wb3J0IHNzbAoKdHJ5OgogICAgX2NyZWF0ZV91bnZlcmlmaWVkX2h0dHBzX2NvbnRleHQgPSBzc2wuX2NyZWF0ZV91bnZlcmlmaWVkX2NvbnRleHQKZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgIyBMZWdhY3kgUHl0aG9uIHRoYXQgZG9lc24idCB2ZXJpZnkgSFRUUFMgY2VydGlmaWNhdGVzIGJ5IGRlZmF1bHQKICAgIHBhc3MKZWxzZToKICAgICMgSGFuZGxlIHRhcmdldCBlbnZpcm9ubWVudCB0aGF0IGRvZXNuInQgc3VwcG9ydCBIVFRQUyB2ZXJpZmljYXRpb24KICAgIHNzbC5fY3JlYXRlX2RlZmF1bHRfaHR0cHNfY29udGV4dCA9IF9jcmVhdGVfdW52ZXJpZmllZF9odHRwc19jb250ZXh0CgppbXBvcnQgb3MKaW1wb3J0IGpzb24KZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgcGFuZGFzIGFzIHBkCmltcG9ydCBweWFycm93LnBhcnF1ZXQgYXMgcHEKaW1wb3J0IHB5YXJyb3cgYXMgcGEKZnJvbSBjbG91ZHBpY2tsZSBpbXBvcnQgZHVtcCwgbG9hZAoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gdHlwaW5nIGltcG9ydCBJTywgQW55U3RyLCBVbmlvbiwgTGlzdCwgT3B0aW9uYWwKCgpkZWYgYXJjX3RvX3BhcnF1ZXQoCiAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgIGFyY2hpdmVfdXJsOiBVbmlvbltzdHIsIFBhdGgsIElPW0FueVN0cl1dLAogICAgaGVhZGVyOiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgIGluY19jb2xzOiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgIGNodW5rc2l6ZTogaW50ID0gMTBfMDAwLAogICAgZHR5cGU9Tm9uZSwKICAgIGVuY29kaW5nOiBzdHIgPSAibGF0aW4tMSIsCiAgICBrZXk6IHN0ciA9ICJkYXRhIiwKICAgIGRhdGFzZXQ6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgcGFydGl0aW9uX2NvbHMgPSBbXSwKKSAtPiBOb25lOgogICAgIiIiT3BlbiBhIGZpbGUvb2JqZWN0IGFyY2hpdmUgYW5kIHNhdmUgYXMgYSBwYXJxdWV0IGZpbGUuCiAgICAKICAgIFBhcnRpdGlvbmluZyByZXF1aXJlcyBwcmVjaXNlIHNwZWNpZmljYXRpb24gb2YgY29sdW1uIHR5cGVzLgogICAgCiAgICA6cGFyYW0gY29udGV4dDogICAgICBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gYXJjaGl2ZV91cmw6ICBhbnkgdmFsaWQgc3RyaW5nIHBhdGggY29uc2lzdGVudCB3aXRoIHRoZSBwYXRoIHZhcmlhYmxlCiAgICAgICAgICAgICAgICAgICAgICAgICBvZiBwYW5kYXMucmVhZF9jc3YsIGluY2x1ZGluZyBzdHJpbmdzIGFzIGZpbGUgcGF0aHMsIGFzIHVybHMsIAogICAgICAgICAgICAgICAgICAgICAgICAgcGF0aGxpYi5QYXRoIG9iamVjdHMsIGV0Yy4uLgogICAgOnBhcmFtIGhlYWRlcl9uYW1lczogY29sdW1uIG5hbWVzCiAgICA6cGFyYW0gaW5jX2NvbHM6ICAgICBpbmNsdWRlIG9ubHkgdGhlc2UgY29sdW1ucwogICAgOnBhcmFtIGNodW5rc2l6ZTogICAgKDApIHJvdyBzaXplIHJldHJpZXZlZCBwZXIgaXRlcmF0aW9uCiAgICA6cGFyYW0gZHR5cGUgICAgICAgICBkZXN0aW5hdGlvbiBkYXRhIHR5cGUgb2Ygc3BlY2lmaWVkIGNvbHVtbnMKICAgIDpwYXJhbSBlbmNvZGluZyAgICAgICgibGF0aW4tOCIpIGZpbGUgZW5jb2RpbmcKICAgIDpwYXJhbSBrZXk6ICAgICAgICAgIGtleSBpbiBhcnRpZmFjdCBzdG9yZSAod2hlbiBsb2dfZGF0YT1UcnVlKQogICAgOnBhcmFtIGRhdGFzZXQ6ICAgICAgKE5vbmUpIGlmIG5vdCBOb25lIHRoZW4gInRhcmdldF9wYXRoL2RhdGFzZXQiCiAgICAgICAgICAgICAgICAgICAgICAgICBpcyBmb2xkZXIgZm9yIHBhcnRpdGlvbmVkIGZpbGVzCiAgICA6cGFyYW0gcGFydF9jb2xzOiAgICAoW10pIGxpc3Qgb2YgcGFydGl0aW9uaW5nIGNvbHVtbnMKICAgIAogICAgIiIiCiAgICBiYXNlX3BhdGggPSBjb250ZXh0LmFydGlmYWN0X3BhdGgKICAgIG9zLm1ha2VkaXJzKGJhc2VfcGF0aCwgZXhpc3Rfb2s9VHJ1ZSkKICAgIAogICAgaWYgZGF0YXNldCBpcyBub3QgTm9uZToKICAgICAgICBkZXN0X3BhdGggPSBvcy5wYXRoLmpvaW4oYmFzZV9wYXRoLCBkYXRhc2V0KQogICAgICAgIGV4aXN0cyA9IG9zLnBhdGguaXNkaXIoZGVzdF9wYXRoKQogICAgZWxzZToKICAgICAgICBkZXN0X3BhdGggPSBvcy5wYXRoLmpvaW4oYmFzZV9wYXRoLCBrZXkrIi5wcXQiKQogICAgICAgIGV4aXN0cyA9IG9zLnBhdGguaXNmaWxlKGRlc3RfcGF0aCkKICAgICAKICAgICMgdG9kbzogbW9yZSBsb2dpYyBmb3IgaGVhZGVyCiAgICBpZiBub3QgZXhpc3RzOgogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oImRlc3RpbmF0aW9uIGZpbGUgZG9lcyBub3QgZXhpc3QsIGRvd25sb2FkaW5nIikKICAgICAgICBwcXdyaXRlciA9IE5vbmUKICAgICAgICBmb3IgaSwgZGYgaW4gZW51bWVyYXRlKHBkLnJlYWRfY3N2KGFyY2hpdmVfdXJsLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rc2l6ZT1jaHVua3NpemUsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2hlYWRlcj1Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM9aGVhZGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc9ZW5jb2RpbmcsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3VzZWNvbHM9aW5jX2NvbHMsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHR5cGU9ZHR5cGUpKToKICAgICAgICAgICAgdGFibGUgPSBwYS5UYWJsZS5mcm9tX3BhbmRhcyhkZikKICAgICAgICAgICAgaWYgaSA9PSAwOgogICAgICAgICAgICAgICAgaWYgZGF0YXNldDoKICAgICAgICAgICAgICAgICAgICAjIGp1c3Qgd3JpdGUgaGVhZGVyIGhlcmUKICAgICAgICAgICAgICAgICAgICBwcS5QYXJxdWV0V3JpdGVyKG9zLnBhdGguam9pbihiYXNlX3BhdGgsImhlYWRlci1vbmx5LnBxdCIpLCB0YWJsZS5zY2hlbWEpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgc3RhcnQgd3JpdGluZyBmaWxlCiAgICAgICAgICAgICAgICAgICAgcHF3cml0ZXIgPSBwcS5QYXJxdWV0V3JpdGVyKGRlc3RfcGF0aCwgdGFibGUuc2NoZW1hKQogICAgICAgICAgICAgICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoImhlYWRlciIsIGxvY2FsX3BhdGg9ImhlYWRlci1vbmx5LnBxdCIpCiAgICAgICAgICAgIGlmIGRhdGFzZXQ6CiAgICAgICAgICAgICAgICBwcS53cml0ZV90b19kYXRhc2V0KHRhYmxlLCByb290X3BhdGg9ZGVzdF9wYXRoLCBwYXJ0aXRpb25fY29scz1wYXJ0aXRpb25fY29scykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBxd3JpdGVyLndyaXRlX3RhYmxlKHRhYmxlKQogICAgICAgIGlmIHBxd3JpdGVyOgogICAgICAgICAgICBwcXdyaXRlci5jbG9zZSgpCgogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZiJzYXZlZCB0YWJsZSB0byB7ZGVzdF9wYXRofSIpCiAgICBlbHNlOgogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oImRlc3RpbmF0aW9uIGZpbGUgYWxyZWFkeSBleGlzdHMiKQogICAgCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChrZXksIGxvY2FsX3BhdGg9a2V5KyIucHF0Iik=
    commands: []
    code_origin: https://github.com/yjb-ds/functions-refac#4b65b1b6066d78e2b2b0e4b5a56fc25dbb2bedb3:/User/functions-refac/arc_to_parquet/arc_to_parquet.py

kind: job
metadata:
  name: pyannote-audio
  tag: ''
  hash: 335752327ddd14b62222bd45faa3a88704505b66
  project: ''
  labels:
    author: guyl
  categories:
  - Deep Learning
  - Huggingface
  - Audio
spec:
  command: ''
  args: []
  image: ''
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAyMyBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQojIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiMgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiMgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAojIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKaW1wb3J0IGhlYXBxCmltcG9ydCBsb2dnaW5nCmltcG9ydCBvcGVyYXRvcgppbXBvcnQgb3MKaW1wb3J0IHBhdGhsaWIKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHJlZHVjZSwgd3JhcHMKZnJvbSB0eXBpbmcgaW1wb3J0IEFueSwgRGljdCwgTGlzdCwgVHVwbGUsIFVuaW9uCgppbXBvcnQgcGFuZGFzIGFzIHBkCmltcG9ydCBweWFubm90ZS5hdWRpbwppbXBvcnQgcHlhbm5vdGUuY29yZQppbXBvcnQgdG9yY2gKaW1wb3J0IHRvcmNoYXVkaW8KZnJvbSB0cWRtIGltcG9ydCB0cWRtCgojIEdldCB0aGUgZ2xvYmFsIGxvZ2dlcjoKX0xPR0dFUiA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKCkKCgpkZWYgX2NoZWNrX21scnVuX2FuZF9vcGVuX21waSgpIC0+IFR1cGxlWyJtbHJ1bi5NTENsaWVudEN0eCIsICJtcGk0cHkuTVBJLkludHJhY29tbSJdOgogICAgaXNfbXBpID0gRmFsc2UKICAgIHRyeToKICAgICAgICBpbXBvcnQgbWxydW4KCiAgICAgICAgY29udGV4dCA9IG1scnVuLmdldF9vcl9jcmVhdGVfY3R4KG5hbWU9Im1scnVuIikKICAgICAgICBpc19tcGkgPSBjb250ZXh0LmxhYmVscy5nZXQoImtpbmQiLCAiam9iIikgPT0gIm1waWpvYiIKCiAgICAgICAgaWYgaXNfbXBpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBmcm9tIG1waTRweSBpbXBvcnQgTVBJCgogICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQsIE1QSS5DT01NX1dPUkxECiAgICAgICAgICAgIGV4Y2VwdCBNb2R1bGVOb3RGb3VuZEVycm9yIGFzIG1waTRweV9ub3RfZm91bmQ6CiAgICAgICAgICAgICAgICBjb250ZXh0LmxvZ2dlci5lcnJvcigKICAgICAgICAgICAgICAgICAgICAiVG8gZGlzdHJpYnV0ZSB0aGUgZnVuY3Rpb24gdXNpbmcgTUxSdW4ncyAnbXBpam9iJyB5b3UgbmVlZCB0byBoYXZlIGBtcGk0cHlgIHBhY2thZ2UgaW4geW91ciAiCiAgICAgICAgICAgICAgICAgICAgImludGVycHJldGVyLiBQbGVhc2UgcnVuIGBwaXAgaW5zdGFsbCBtcGk0cHlgIGFuZCBtYWtlIHN1cmUgeW91IGhhdmUgb3Blbi1tcGkuIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcmFpc2UgbXBpNHB5X25vdF9mb3VuZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LCBOb25lCiAgICBleGNlcHQgTW9kdWxlTm90Rm91bmRFcnJvciBhcyBtb2R1bGVfbm90X2ZvdW5kOgogICAgICAgIGlmIGlzX21waToKICAgICAgICAgICAgcmFpc2UgbW9kdWxlX25vdF9mb3VuZAogICAgcmV0dXJuIE5vbmUsIE5vbmUKCgpkZWYgb3Blbl9tcGlfaGFuZGxlcigKICAgIHdvcmtlcl9pbnB1dHM6IExpc3Rbc3RyXSwgcm9vdF93b3JrZXJfaW5wdXRzOiBEaWN0W3N0ciwgQW55XSA9IE5vbmUKKToKICAgIGdsb2JhbCBfTE9HR0VSCgogICAgIyBDaGVjayBmb3IgTUxSdW4gYW5kIE9wZW5NUEkgYXZhaWxhYmlsaXR5OgogICAgY29udGV4dCwgY29tbSA9IF9jaGVja19tbHJ1bl9hbmRfb3Blbl9tcGkoKQoKICAgICMgQ2hlY2sgaWYgTUxSdW4gaXMgYXZhaWxhYmxlLCBzZXQgdGhlIGdsb2JhbCBsb2dnZXIgdG8gTUxSdW4nczoKICAgIGlmIGNvbnRleHQ6CiAgICAgICAgX0xPR0dFUiA9IGNvbnRleHQubG9nZ2VyCgogICAgZGVmIGRlY29yYXRvcihoYW5kbGVyKToKICAgICAgICBpZiBjb21tIGlzIE5vbmUgb3IgY29tbS5HZXRfc2l6ZSgpID09IDE6CiAgICAgICAgICAgIHJldHVybiBoYW5kbGVyCgogICAgICAgIEB3cmFwcyhoYW5kbGVyKQogICAgICAgIGRlZiB3cmFwcGVyKCoqa3dhcmdzKToKICAgICAgICAgICAgIyBHZXQgdGhlIG9wZW4gbXBpIGVudmlyb25tZW50IHByb3BlcnRpZXM6CiAgICAgICAgICAgIHNpemUgPSBjb21tLkdldF9zaXplKCkKICAgICAgICAgICAgcmFuayA9IGNvbW0uR2V0X3JhbmsoKQoKICAgICAgICAgICAgIyBHaXZlIHRoZSBjb3JyZWN0IGNodW5rIG9mIHRoZSB3b3JrZXJzIGlucHV0czoKICAgICAgICAgICAgZm9yIHdvcmtlcl9pbnB1dCBpbiB3b3JrZXJfaW5wdXRzOgogICAgICAgICAgICAgICAgaW5wdXRfYXJndW1lbnQgPSBrd2FyZ3Nbd29ya2VyX2lucHV0XQogICAgICAgICAgICAgICAgaWYgaW5wdXRfYXJndW1lbnQgaXMgTm9uZToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpbnB1dF9hcmd1bWVudCwgc3RyKToKICAgICAgICAgICAgICAgICAgICBpbnB1dF9hcmd1bWVudCA9IF9nZXRfYXVkaW9fZmlsZXMoCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfcGF0aD1wYXRobGliLlBhdGgoaW5wdXRfYXJndW1lbnQpLmFic29sdXRlKCkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiBsZW4oaW5wdXRfYXJndW1lbnQpIDwgc2l6ZToKICAgICAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICBmIkNhbm5vdCBzcGxpdCB0aGUgaW5wdXQgJ3t3b3JrZXJfaW5wdXR9JyBvZiBsZW5ndGgge2xlbihpbnB1dF9hcmd1bWVudCl9IHRvIHtzaXplfSB3b3JrZXJzLiAiCiAgICAgICAgICAgICAgICAgICAgICAgIGYiUGxlYXNlIHJlZHVjZSB0aGUgYW1vdW50IG9mIHdvcmtlcnMgZm9yIHRoaXMgaW5wdXQuIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGV2ZW5fY2h1bmtfc2l6ZSA9IGxlbihpbnB1dF9hcmd1bWVudCkgLy8gc2l6ZQogICAgICAgICAgICAgICAgY2h1bmtfc3RhcnQgPSByYW5rICogZXZlbl9jaHVua19zaXplCiAgICAgICAgICAgICAgICBjaHVua19lbmQgPSAoCiAgICAgICAgICAgICAgICAgICAgKHJhbmsgKyAxKSAqIGV2ZW5fY2h1bmtfc2l6ZQogICAgICAgICAgICAgICAgICAgIGlmIHJhbmsgKyAxIDwgc2l6ZQogICAgICAgICAgICAgICAgICAgIGVsc2UgbGVuKGlucHV0X2FyZ3VtZW50KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygKICAgICAgICAgICAgICAgICAgICBmIlJhbmsgI3tyYW5rfTogUHJvY2Vzc2luZyBpbnB1dCBjaHVuayBvZiAne3dvcmtlcl9pbnB1dH0nICIKICAgICAgICAgICAgICAgICAgICBmImZyb20gaW5kZXgge2NodW5rX3N0YXJ0fSB0byB7Y2h1bmtfZW5kfS4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGlucHV0X2FyZ3VtZW50LCBsaXN0KToKICAgICAgICAgICAgICAgICAgICBpbnB1dF9hcmd1bWVudCA9IGlucHV0X2FyZ3VtZW50W2NodW5rX3N0YXJ0OmNodW5rX2VuZF0KICAgICAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShpbnB1dF9hcmd1bWVudCwgcGQuRGF0YUZyYW1lKToKICAgICAgICAgICAgICAgICAgICBpbnB1dF9hcmd1bWVudCA9IGlucHV0X2FyZ3VtZW50Lmlsb2NbY2h1bmtfc3RhcnQ6Y2h1bmtfZW5kOiwgOl0KICAgICAgICAgICAgICAgIGt3YXJnc1t3b3JrZXJfaW5wdXRdID0gaW5wdXRfYXJndW1lbnQKCiAgICAgICAgICAgICMgU2V0IHRoZSByb290IHdvcmtlciBvbmx5IGFyZ3VtZW50czoKICAgICAgICAgICAgaWYgcmFuayA9PSAwIGFuZCByb290X3dvcmtlcl9pbnB1dHM6CiAgICAgICAgICAgICAgICBrd2FyZ3MudXBkYXRlKHJvb3Rfd29ya2VyX2lucHV0cykKCiAgICAgICAgICAgICMgUnVuIHRoZSB3b3JrZXI6CiAgICAgICAgICAgIG91dHB1dCA9IGhhbmRsZXIoKiprd2FyZ3MpCgogICAgICAgICAgICAjIFNlbmQgdGhlIG91dHB1dCB0byB0aGUgcm9vdCByYW5rIChyYW5rICMwKToKICAgICAgICAgICAgb3V0cHV0ID0gY29tbS5nYXRoZXIob3V0cHV0LCByb290PTApCiAgICAgICAgICAgIGlmIHJhbmsgPT0gMDoKICAgICAgICAgICAgICAgICMgSm9pbiB0aGUgb3V0cHV0czoKICAgICAgICAgICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oIkNvbGxlY3RpbmcgZGF0YSBmcm9tIHdvcmtlcnMgdG8gcm9vdCB3b3JrZXIuIikKICAgICAgICAgICAgICAgIGRpYXJpemF0aW9uX2RpY3Rpb25hcnkgPSByZWR1Y2UoCiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3IuaW9yLCBbZGlhIGZvciBkaWEsIF8gaW4gb3V0cHV0XSwge30KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVycm9yc19kaWN0aW9uYXJ5ID0gcmVkdWNlKG9wZXJhdG9yLmlvciwgW2VyciBmb3IgXywgZXJyIGluIG91dHB1dF0sIHt9KQogICAgICAgICAgICAgICAgcmV0dXJuIGRpYXJpemF0aW9uX2RpY3Rpb25hcnksIGVycm9yc19kaWN0aW9uYXJ5CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgIHJldHVybiB3cmFwcGVyCgogICAgcmV0dXJuIGRlY29yYXRvcgoKCkBvcGVuX21waV9oYW5kbGVyKHdvcmtlcl9pbnB1dHM9WyJkYXRhX3BhdGgiXSwgcm9vdF93b3JrZXJfaW5wdXRzPXsidmVyYm9zZSI6IFRydWV9KQpkZWYgZGlhcml6ZSgKICAgIGRhdGFfcGF0aDogVW5pb25bc3RyLCBMaXN0W3N0cl1dLAogICAgbW9kZWxfbmFtZTogc3RyID0gInB5YW5ub3RlL3NwZWFrZXItZGlhcml6YXRpb24tMy4wIiwKICAgIGFjY2Vzc190b2tlbjogc3RyID0gTm9uZSwKICAgIGRldmljZTogc3RyID0gTm9uZSwKICAgIHNwZWFrZXJzX2xhYmVsczogTGlzdFtzdHJdID0gTm9uZSwKICAgIHNwZWFrZXJfcHJlZml4OiBzdHIgPSAic3BlYWtlcl8iLAogICAgc2VwYXJhdGVfYnlfY2hhbm5lbHM6IGJvb2wgPSBGYWxzZSwKICAgIG1pbmltdW1fc3BlYWtlcnM6IGludCA9IE5vbmUsCiAgICBtYXhpbXVtX3NwZWFrZXJzOiBpbnQgPSBOb25lLAogICAgdmVyYm9zZTogYm9vbCA9IEZhbHNlLAopIC0+IFR1cGxlW0RpY3Rbc3RyLCBMaXN0W1R1cGxlW2Zsb2F0LCBmbG9hdCwgc3RyXV1dLCBEaWN0W3N0ciwgc3RyXV06CiAgICAiIiIKICAgIFBlcmZvcm0gc3BlZWNoIGRpYXJpemF0aW9uIG9uIGdpdmVuIGF1ZGlvIGZpbGVzIHVzaW5nIHB5YW5ub3RlLWF1ZGlvIChodHRwczovL2dpdGh1Yi5jb20vcHlhbm5vdGUvcHlhbm5vdGUtYXVkaW8pLgogICAgVGhlIGVuZCByZXN1bHQgaXMgYSBkaWN0aW9uYXJ5IHdpdGggdGhlIGZpbGUgbmFtZXMgYXMga2V5cyBhbmQgdGhlaXIgZGlhcml6YXRpb24gYXMgdmFsdWUuIEEgZGlhcml6YXRpb24gaXMgYSBsaXN0CiAgICBvZiB0dXBsZXM6IChzdGFydCwgZW5kLCBzcGVha2VyX2xhYmVsKS4KCiAgICBUbyB1c2UgdGhlIGBweWFubm90ZS5hdWRpb2AgbW9kZWxzIHlvdSBtdXN0IHBhc3MgYSBIdWdnaW5nZmFjZSB0b2tlbiBhbmQgZ2V0IGFjY2VzcyB0byB0aGUgcmVxdWlyZWQgbW9kZWxzLiBUaGUKICAgIHRva2VuIGNhbiBiZSBwYXNzZWQgaW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKCiAgICAqIFVzZSB0aGUgcGFyYW1ldGVyIGBhY2Nlc3NfdG9rZW5gLgogICAgKiBTZXQgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUgbmFtZWQgIkhVR0dJTkdfRkFDRV9IVUJfVE9LRU4iLgogICAgKiBJZiB1c2luZyBNTFJ1biwgeW91IGNhbiBwYXNzIGl0IGFzIGEgc2VjcmV0IG5hbWVkICJIVUdHSU5HX0ZBQ0VfSFVCX1RPS0VOIi4KCiAgICBUbyBnZXQgYWNjZXNzIHRvIHRoZSBtb2RlbHMgb24gSHVnZ2luZ2ZhY2UsIHZpc2l0IHRoZWlyIHBhZ2UuIEZvciBleGFtcGxlLCB0byB1c2UgdGhlIGRlZmF1bHQgZGlhcml6YXRpb24gbW9kZWwgc2V0CiAgICBpbiB0aGlzIGZ1bmN0aW9uICgicHlhbm5vdGUvc3BlYWtlci1kaWFyaXphdGlvbi0zLjAiKSwgeW91IG5lZWQgYWNjZXNzIGZvciB0aGVzZSB0d28gbW9kZWxzOgoKICAgICogaHR0cHM6Ly9odWdnaW5nZmFjZS5jby9weWFubm90ZS9zZWdtZW50YXRpb24tMy4wCiAgICAqIGh0dHBzOi8vaHVnZ2luZ2ZhY2UuY28vcHlhbm5vdGUvc3BlYWtlci1kaWFyaXphdGlvbi0zLjAKCiAgICBOb3RlOiBUbyBjb250cm9sIHRoZSByZWNvZ25pemVkIHNwZWFrZXJzIGluIHRoZSBkaWFyaXphdGlvbiBvdXRwdXQgeW91IGNhbiBjaG9vc2Ugb25lIG9mIHRoZSBmb2xsb3dpbmcgbWV0aG9kczoKCiAgICAqIEZvciBhIGtub3duIHNwZWFrZXJzIGFtb3VudCwgeW91IG1heSBzZXQgc3BlYWtlciBsYWJlbHMgdmlhIHRoZSBgc3BlYWtlcnNfbGFiZWxzYCBwYXJhbWV0ZXIgdGhhdCB3aWxsIGJlIHVzZWQgaW4KICAgICAgdGhlIG9yZGVyIG9mIHNwZWFraW5nIGluIHRoZSBhdWRpbyAoZmlyc3QgcGVyc29uIHNwZWFraW5nIGJlIHRoZSBmaXJzdCBsYWJlbCBpbiB0aGUgbGlzdCkuIEluIGFkZGl0aW9uLCB5b3UgY2FuIGRvCiAgICAgIGRpYXJpemF0aW9uIHBlciBjaGFubmVsIChzZXR0aW5nIHRoZSBwYXJhbWV0ZXIgYHNlcGFyYXRlX2J5X2NoYW5uZWxzYCB0byBUcnVlKS4gRWFjaCBsYWJlbCB3aWxsIGJlIGFzc2lnbmVkIHRvIGEKICAgICAgc3BlY2lmaWMgY2hhbm5lbCBieSBvcmRlciAoZmlyc3QgbGFiZWwgdG8gY2hhbm5lbCAwLCBzZWNvbmQgbGFiZWwgdG8gY2hhbm5lbCAxIGFuZCBzbyBvbikuIE5vdGljZSwgdGhpcyB3aWxsCiAgICAgIGluY3JlYXNlIHJ1bnRpbWUuCiAgICAqIEZvciB1bmtub3duIHNwZWFrZXJzIGFtb3VudCwgeW91IGNhbiBzZXQgdGhlIGBzcGVha2VyX3ByZWZpeGAgcGFyYW1ldGVyIHRvIGFkZCBhIHByZWZpeCBmb3IgZWFjaCBzcGVha2VyIG51bWJlci4KICAgICAgWW91IGNhbiBhbHNvIGhlbHAgdGhlIGRpYXJpemF0aW9uIGJ5IHNldHRpbmcgdGhlIHNwZWFrZXJzIHJhbmdlIHZpYSB0aGUgYHNwZWFrZXJzX2Ftb3VudF9yYW5nZWAgcGFyYW1ldGVyLgoKICAgIDpwYXJhbSBkYXRhX3BhdGg6ICAgICAgICAgICAgQSBkaXJlY3Rvcnkgb2YgdGhlIGF1ZGlvIGZpbGVzLCBhIHNpbmdsZSBmaWxlIG9yIGEgbGlzdCBvZiBmaWxlcyB0byB0cmFuc2NyaWJlLgogICAgOnBhcmFtIG1vZGVsX25hbWU6ICAgICAgICAgICBPbmUgb2YgdGhlIG9mZmljaWFsIGRpYXJpemF0aW9uIG1vZGVsIG5hbWVzIChyZWZlcnJlZCBhcyBkaWFyaXphdGlvbiBwaXBlbGluZXMpIG9mCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBweWFubm90ZS5hdWRpb2AgSHVnZ2luZ2ZhY2UgcGFnZS4gRGVmYXVsdDogInB5YW5ub3RlL3NwZWFrZXItZGlhcml6YXRpb24tMy4wIi4KICAgIDpwYXJhbSBhY2Nlc3NfdG9rZW46ICAgICAgICAgQW4gYWNjZXNzIHRva2VuIHRvIHBhc3MgZm9yIHVzaW5nIHRoZSBgcHlhbm5vdGUuYXVkaW9gIG1vZGVscy4gSWYgbm90IHByb3ZpZGVkLCBpdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIGxvb2tpbmcgZm9yIHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZSAiSFVHR0lOR19GQUNFX0hVQl9UT0tFTiIuIElmIE1MUnVuIGlzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZSwgaXQgd2lsbCBsb29rIGZvciBhIHNlY3JldCAiSFVHR0lOR19GQUNFX0hVQl9UT0tFTiIuCiAgICA6cGFyYW0gZGV2aWNlOiAgICAgICAgICAgICAgIERldmljZSB0byBsb2FkIHRoZSBtb2RlbC4gQ2FuIGJlIG9uZSBvZiB7ImN1ZGEiLCAiY3B1In0uIERlZmF1bHQgd2lsbCBwcmVmZXIgImN1ZGEiIGlmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZS4KICAgIDpwYXJhbSBzcGVha2Vyc19sYWJlbHM6ICAgICAgTGFiZWxzIHRvIHVzZSBmb3IgdGhlIHJlY29nbml6ZWQgc3BlYWtlcnMuIERlZmF1bHQ6IG51bWVyaWMgbGFiZWxzICgwLCAxLCAuLi4pLgogICAgOnBhcmFtIHNlcGFyYXRlX2J5X2NoYW5uZWxzOiBJZiBlYWNoIHNwZWFrZXIgaXMgc3BlYWtpbmcgaW4gYSBzZXBhcmF0ZSBjaGFubmVsLCB5b3UgY2FuIGRpYXJpemUgZWFjaCBjaGFubmVsIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21iaW5lIHRoZSByZXN1bHQgaW50byBhIHNpbmdsZSBkaWFyaXphdGlvbi4gRWFjaCBsYWJlbCBzZXQgaW4gdGhlIGBzcGVha2Vyc19sYWJlbHNgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlciB3aWxsIGJlIGFzc2lnbmVkIHRvIGEgc3BlY2lmaWMgY2hhbm5lbCBieSBvcmRlci4KICAgIDpwYXJhbSBzcGVha2VyX3ByZWZpeDogICAgICAgQSBwcmVmaXggdG8gYWRkIGZvciB0aGUgc3BlYWtlcnMgbGFiZWxzLiBUaGlzIHBhcmFtZXRlciBpcyBpZ25vcmVkIGlmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBzcGVha2Vyc19sYWJlbHNgIGlzIG5vdCBOb25lLiBEZWZhdWx0OiAic3BlYWtlciIuCiAgICA6cGFyYW0gbWluaW11bV9zcGVha2VyczogICAgIFNldCB0aGUgbWluaW11bSBleHBlY3RlZCBhbW91bnQgb2Ygc3BlYWtlcnMgdG8gYmUgaW4gdGhlIGF1ZGlvIGZpbGVzLiBUaGlzIHBhcmFtZXRlciBpcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVkIGlmIGBzcGVha2Vyc19sYWJlbHNgIGlzIG5vdCBOb25lLgogICAgOnBhcmFtIG1heGltdW1fc3BlYWtlcnM6ICAgICBTZXQgdGhlIG1heGltdW0gZXhwZWN0ZWQgYW1vdW50IG9mIHNwZWFrZXJzIHRvIGJlIGluIHRoZSBhdWRpbyBmaWxlcy4gVGhpcyBwYXJhbWV0ZXIgaXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlZCBpZiBgc3BlYWtlcnNfbGFiZWxzYCBpcyBub3QgTm9uZS4KICAgIDpwYXJhbSB2ZXJib3NlOiAgICAgICAgICAgICAgV2hldGhlciB0byBwcmVzZW50IGxvZ3Mgb2YgYSBwcm9ncmVzcyBiYXIgYW5kIGVycm9ycy4gRGVmYXVsdDogVHJ1ZS4KCiAgICA6cmV0dXJuczogQSB0dXBsZSBvZjoKCiAgICAgICAgICAgICAgKiBTcGVlY2ggZGlhcml6YXRpb24gZGljdGlvbmFyeS4KICAgICAgICAgICAgICAqIEEgZGljdGlvbmFyeSBvZiBlcnJvcmVkIGZpbGVzIHRoYXQgd2VyZSBub3QgdHJhbnNjcmliZWQuCiAgICAiIiIKICAgIGdsb2JhbCBfTE9HR0VSCgogICAgIyBHZXQgdGhlIGlucHV0IGF1ZGlvIGZpbGVzIHRvIGRpYXJpemU6CiAgICBpZiBpc2luc3RhbmNlKGRhdGFfcGF0aCwgc3RyKToKICAgICAgICBkYXRhX3BhdGggPSBwYXRobGliLlBhdGgoZGF0YV9wYXRoKS5hYnNvbHV0ZSgpCiAgICAgICAgYXVkaW9fZmlsZXMgPSBfZ2V0X2F1ZGlvX2ZpbGVzKGRhdGFfcGF0aD1kYXRhX3BhdGgpCiAgICBlbHNlOiAgIyBTaG91bGQgYmUgYSBsaXN0IG9mIGZpbGVzLgogICAgICAgIGF1ZGlvX2ZpbGVzID0gZGF0YV9wYXRoCgogICAgIyBHZXQgdGhlIEh1Z2dpbmdmYWNlIGFjY2VzcyB0b2tlbjoKICAgIGFjY2Vzc190b2tlbiA9IF9nZXRfYWNjZXNzX3Rva2VuKHBhcmFtZXRlcj1hY2Nlc3NfdG9rZW4pCiAgICBpZiBhY2Nlc3NfdG9rZW4gaXMgTm9uZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAiQSBIdWdnaW5nZmFjZSBhY2Nlc3MgdG9rZW4gbXVzdCBiZSBwcm92aWRlZCB0byB1c2UgYHB5YW5ub3RlLmF1ZGlvYCBtb2RlbHMuIEFjY2VzcyB0b2tlbiBjYW4gYmUgcGFzc2VkICIKICAgICAgICAgICAgInZpYSBvbmUgb2YgdGhlIGZvbGxvd2luZyBvcHRpb25zOlxuIgogICAgICAgICAgICAiKiBVc2UgdGhlIHBhcmFtZXRlciBgYWNjZXNzX3Rva2VuYC5cbiIKICAgICAgICAgICAgIiogU2V0IGFuIGVudmlyb25tZW50IHZhcmlhYmxlIG5hbWVkICdIVUdHSU5HX0ZBQ0VfSFVCX1RPS0VOJy5cbiIKICAgICAgICAgICAgIiogSWYgdXNpbmcgTUxSdW4sIHlvdSBjYW4gcGFzcyBpdCBhcyBhIHNlY3JldCBuYW1lZCAnSFVHR0lOR19GQUNFX0hVQl9UT0tFTicuIgogICAgICAgICkKCiAgICAjIExvYWQgdGhlIGRpYXJpemF0aW9uIHBpcGVsaW5lOgogICAgcGlwZWxpbmUgPSBweWFubm90ZS5hdWRpby5QaXBlbGluZS5mcm9tX3ByZXRyYWluZWQoCiAgICAgICAgY2hlY2twb2ludF9wYXRoPW1vZGVsX25hbWUsIHVzZV9hdXRoX3Rva2VuPWFjY2Vzc190b2tlbgogICAgKQoKICAgICMgU2V0IHRoZSBkZXZpY2U6CiAgICBkZXZpY2UgPSBkZXZpY2Ugb3IgKCJjdWRhIiBpZiB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpIGVsc2UgImNwdSIpCiAgICBpZiBkZXZpY2UgIT0gImNwdSI6CiAgICAgICAgcGlwZWxpbmUudG8odG9yY2guZGV2aWNlKGRldmljZSkpCgogICAgIyBQcmVwYXJlIHRoZSBzdWNjZXNzZXMgZGF0YWZyYW1lIGFuZCBlcnJvcnMgZGljdGlvbmFyeSB0byBiZSByZXR1cm5lZDoKICAgIGRpYXJpemF0aW9ucyA9IHt9CiAgICBlcnJvcnMgPSB7fQoKICAgICMgUHJlcGFyZSB0aGUgZGlhcml6YXRpb24ga2V5d29yZCBhcmd1bWVudHM6CiAgICBkaWFyaXplX2t3YXJncyA9IHt9CiAgICBpZiBzcGVha2Vyc19sYWJlbHM6CiAgICAgICAgZGlhcml6ZV9rd2FyZ3NbIm51bV9zcGVha2VycyJdID0gbGVuKHNwZWFrZXJzX2xhYmVscykKICAgIGVsc2U6CiAgICAgICAgaWYgbWluaW11bV9zcGVha2VyczoKICAgICAgICAgICAgZGlhcml6ZV9rd2FyZ3NbIm1pbl9zcGVha2VycyJdID0gbWluaW11bV9zcGVha2VycwogICAgICAgIGlmIG1heGltdW1fc3BlYWtlcnM6CiAgICAgICAgICAgIGRpYXJpemVfa3dhcmdzWyJtYXhfc3BlYWtlcnMiXSA9IG1heGltdW1fc3BlYWtlcnMKCiAgICAjIEdvIG92ZXIgdGhlIGF1ZGlvIGZpbGVzIGFuZCBkaWFyaXplOgogICAgZm9yIGF1ZGlvX2ZpbGUgaW4gdHFkbSgKICAgICAgICBhdWRpb19maWxlcywgZGVzYz0iRGlhcml6aW5nIiwgdW5pdD0iZmlsZSIsIGRpc2FibGU9bm90IHZlcmJvc2UKICAgICk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIExvYWQgYXVkaW8gZmlsZToKICAgICAgICAgICAgYXVkaW8sIHNhbXBsZV9yYXRlID0gdG9yY2hhdWRpby5sb2FkKHVyaT1hdWRpb19maWxlLCBjaGFubmVsc19maXJzdD1UcnVlKQogICAgICAgICAgICAjIEdldCB0aGUgZGlhcml6YXRpb24gKGlmIHByb3ZpZGVkKToKICAgICAgICAgICAgZGlhcml6YXRpb25zW2F1ZGlvX2ZpbGUubmFtZV0gPSBfZGlhcml6ZSgKICAgICAgICAgICAgICAgIGF1ZGlvPWF1ZGlvLAogICAgICAgICAgICAgICAgc2FtcGxlX3JhdGU9c2FtcGxlX3JhdGUsCiAgICAgICAgICAgICAgICBwaXBlbGluZT1waXBlbGluZSwKICAgICAgICAgICAgICAgIHNwZWFrZXJzX2xhYmVscz1zcGVha2Vyc19sYWJlbHMsCiAgICAgICAgICAgICAgICBzZXBhcmF0ZV9ieV9jaGFubmVscz1zZXBhcmF0ZV9ieV9jaGFubmVscywKICAgICAgICAgICAgICAgIHNwZWFrZXJfcHJlZml4PXNwZWFrZXJfcHJlZml4LAogICAgICAgICAgICAgICAgZGlhcml6ZV9rd2FyZ3M9ZGlhcml6ZV9rd2FyZ3MsCiAgICAgICAgICAgICkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGV4Y2VwdGlvbjoKICAgICAgICAgICAgIyBOb3RlIHRoZSBleGNlcHRpb24gYXMgZXJyb3IgaW4gdGhlIGRpY3Rpb25hcnk6CiAgICAgICAgICAgIGlmIHZlcmJvc2U6CiAgICAgICAgICAgICAgICBfTE9HR0VSLndhcm5pbmcoZiJFcnJvciBpbiBmaWxlOiAne2F1ZGlvX2ZpbGUubmFtZX0nIikKICAgICAgICAgICAgZXJyb3JzW3N0cihhdWRpb19maWxlLm5hbWUpXSA9IHN0cihleGNlcHRpb24pCiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgIyBQcmludCB0aGUgaGVhZCBvZiB0aGUgcHJvZHVjZWQgZGF0YWZyYW1lIGFuZCByZXR1cm46CiAgICBpZiB2ZXJib3NlOgogICAgICAgIF9MT0dHRVIuaW5mbyhmIkRvbmUgKHtsZW4oZGlhcml6YXRpb25zKX0ve2xlbihhdWRpb19maWxlcyl9KVxuIikKICAgIHJldHVybiBkaWFyaXphdGlvbnMsIGVycm9ycwoKCmRlZiBfZ2V0X2F1ZGlvX2ZpbGVzKAogICAgZGF0YV9wYXRoOiBwYXRobGliLlBhdGgsCikgLT4gTGlzdFtwYXRobGliLlBhdGhdOgogICAgIyBDaGVjayBpZiB0aGUgcGF0aCBpcyBvZiBhIGRpcmVjdG9yeSBvciBhIGZpbGU6CiAgICBpZiBkYXRhX3BhdGguaXNfZGlyKCk6CiAgICAgICAgIyBHZXQgYWxsIGZpbGVzIGluc2lkZSB0aGUgZGlyZWN0b3J5OgogICAgICAgIGF1ZGlvX2ZpbGVzID0gbGlzdChkYXRhX3BhdGguZ2xvYigiKi4qIikpCiAgICBlbGlmIGRhdGFfcGF0aC5pc19maWxlKCk6CiAgICAgICAgYXVkaW9fZmlsZXMgPSBbZGF0YV9wYXRoXQogICAgZWxzZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICBmIlVucmVjb2duaXplZCBkYXRhIHBhdGguIFRoZSBwYXJhbWV0ZXIgYGRhdGFfcGF0aGAgbXVzdCBiZSBlaXRoZXIgYSBkaXJlY3RvcnkgcGF0aCBvciBhIGZpbGUgcGF0aC4gIgogICAgICAgICAgICBmIkdpdmVuOiB7c3RyKGRhdGFfcGF0aCl9ICIKICAgICAgICApCgogICAgcmV0dXJuIGF1ZGlvX2ZpbGVzCgoKZGVmIF9nZXRfYWNjZXNzX3Rva2VuKHBhcmFtZXRlcjogc3RyKSAtPiBzdHI6CiAgICAjIElmIGdpdmVuIGFzIGEgcGFyYW1ldGVyLCByZXR1cm4gaXQ6CiAgICBpZiBwYXJhbWV0ZXI6CiAgICAgICAgcmV0dXJuIHBhcmFtZXRlcgoKICAgICMgT3RoZXJ3aXNlLCBsb29rIGF0IHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZToKICAgIGVudmlyb25tZW50X3ZhcmlhYmxlID0gb3MuZW52aXJvbi5nZXQoIkhVR0dJTkdfRkFDRV9IVUJfVE9LRU4iKQogICAgaWYgZW52aXJvbm1lbnRfdmFyaWFibGU6CiAgICAgICAgcmV0dXJuIGVudmlyb25tZW50X3ZhcmlhYmxlCgogICAgIyBMYXN0bHksIHRyeSBsb29rIGluIHRoZSBzZXQgc2VjcmV0cyBpbiBNTFJ1bjoKICAgIHNlY3JldCA9IE5vbmUKICAgIHRyeToKICAgICAgICBpbXBvcnQgbWxydW4KCiAgICAgICAgY29udGV4dCA9IG1scnVuLmdldF9vcl9jcmVhdGVfY3R4KG5hbWU9Im1scnVuIikKICAgICAgICBzZWNyZXQgPSBjb250ZXh0LmdldF9zZWNyZXQoa2V5PSJIVUdHSU5HX0ZBQ0VfSFVCX1RPS0VOIikKICAgIGV4Y2VwdCBNb2R1bGVOb3RGb3VuZEVycm9yOgogICAgICAgIHBhc3MKCiAgICByZXR1cm4gc2VjcmV0CgoKZGVmIF9kaWFyaXplKAogICAgYXVkaW86IHRvcmNoLlRlbnNvciwKICAgIHNhbXBsZV9yYXRlOiBpbnQsCiAgICBwaXBlbGluZTogcHlhbm5vdGUuYXVkaW8uUGlwZWxpbmUsCiAgICBzcGVha2Vyc19sYWJlbHM6IExpc3Rbc3RyXSwKICAgIHNlcGFyYXRlX2J5X2NoYW5uZWxzOiBib29sLAogICAgc3BlYWtlcl9wcmVmaXg6IHN0ciwKICAgIGRpYXJpemVfa3dhcmdzOiBkaWN0LAopIC0+IExpc3RbVHVwbGVbZmxvYXQsIGZsb2F0LCBzdHJdXToKICAgICMgSWYgdGhlcmUgaXMgbm8gbmVlZCBmb3Igc2VwYXJhdGlvbiBieSBjaGFubmVscywgd2UgZGlhcml6ZSBhbmQgcmV0dXJuOgogICAgaWYgbm90IHNlcGFyYXRlX2J5X2NoYW5uZWxzOgogICAgICAgICMgRGlhcml6ZToKICAgICAgICBkaWFyaXphdGlvbjogcHlhbm5vdGUuY29yZS5Bbm5vdGF0aW9uID0gcGlwZWxpbmUoCiAgICAgICAgICAgIGZpbGU9eyJ3YXZlZm9ybSI6IGF1ZGlvLCAic2FtcGxlX3JhdGUiOiBzYW1wbGVfcmF0ZX0sICoqZGlhcml6ZV9rd2FyZ3MKICAgICAgICApCiAgICAgICAgIyBWZXJpZnkgc3BlYWtlcnMgbGFiZWxzIChzaG91bGQgbm90IGZhaWwgaGVyZSBhcyB3ZSBzZXQgYG51bV9zcGVha2Vycz1sZW4oc3BlYWtlcnNfbGFiZWxzKWAgd2hlbiBpbmZlcnJpbmcKICAgICAgICAjIHRocm91Z2ggdGhlIHBpcGVsaW5lKToKICAgICAgICBpZiBzcGVha2Vyc19sYWJlbHM6CiAgICAgICAgICAgIGdpdmVuX3NwZWFrZXJzID0gbGVuKHNwZWFrZXJzX2xhYmVscykKICAgICAgICAgICAgZm91bmRfc3BlYWtlcnMgPSBsZW4oc2V0KGRpYXJpemF0aW9uLmxhYmVscygpKSkKICAgICAgICAgICAgaWYgZ2l2ZW5fc3BlYWtlcnMgPCBmb3VuZF9zcGVha2VyczoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgZiJOb3QgZW5vdWdoIGBzcGVha2Vyc19sYWJlbHNgIHdlcmUgZ2l2ZW4uIEdvdCB7Z2l2ZW5fc3BlYWtlcnN9IGxhYmVscyBidXQgdGhlIGRpYXJpemF0aW9uICIKICAgICAgICAgICAgICAgICAgICBmInJlY29nbml6ZWQge2ZvdW5kX3NwZWFrZXJzfSBzcGVha2Vycy4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgIyBSZXR1cm4gYXMgYSBkaWFyaXphdGlvbiBsaXN0IC0gYSBzb3J0ZWQgbGlzdCBvZiB0dXBsZXMgb2Ygc3RhcnQgdGltZSwgZW5kIHRpbWUgYW5kIGEgbGFiZWwgKHRoZSBkZWZhdWx0IGxhYmVsCiAgICAgICAgIyByZXR1cm5lZCBpcyAiU1BFQUtFUl9pIiBzbyB3ZSB0YWtlIG9ubHkgdGhlIGluZGV4IG91dCBvZiBpdCk6CiAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgKAogICAgICAgICAgICAgICAgc2VnbWVudC5zdGFydCwKICAgICAgICAgICAgICAgIHNlZ21lbnQuZW5kLAogICAgICAgICAgICAgICAgc3BlYWtlcnNfbGFiZWxzW2ludChsYWJlbC5zcGxpdCgiXyIpWzFdKV0KICAgICAgICAgICAgICAgIGlmIHNwZWFrZXJzX2xhYmVscwogICAgICAgICAgICAgICAgZWxzZSBmIntzcGVha2VyX3ByZWZpeH17aW50KGxhYmVsLnNwbGl0KCdfJylbMV0pfSIsCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIHNlZ21lbnQsIHRyYWNrLCBsYWJlbCBpbiBkaWFyaXphdGlvbi5pdGVydHJhY2tzKHlpZWxkX2xhYmVsPVRydWUpCiAgICAgICAgXQoKICAgICMgU2VwYXJhdGUgdG8gY2hhbm5lbHMgYW5kIGRpYXJpemUgKHdlIGV4cGVjdCBvbmx5IG9uZSBzcGVha2VyIHBlciBjaGFubmVsKToKICAgIGNoYW5uZWxfZGlhcml6YXRpb25zID0gWwogICAgICAgIF9kaWFyaXplKAogICAgICAgICAgICBhdWRpbz1hdWRpb1tjaGFubmVsXS51bnNxdWVlemUoCiAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICksICAjIFRha2UgY2hhbm5lbCBhbmQgYWRkIGEgY2hhbm5lbCBkaW1lbnNpb24gdG8gaXQuCiAgICAgICAgICAgIHNhbXBsZV9yYXRlPXNhbXBsZV9yYXRlLAogICAgICAgICAgICBwaXBlbGluZT1waXBlbGluZSwKICAgICAgICAgICAgc3BlYWtlcnNfbGFiZWxzPVsKICAgICAgICAgICAgICAgIHNwZWFrZXJzX2xhYmVsc1tjaGFubmVsXQogICAgICAgICAgICBdLCAgIyBUYWtlIHRoZSBjaGFubmVsJ3MgbGFiZWwgb25seS4KICAgICAgICAgICAgc2VwYXJhdGVfYnlfY2hhbm5lbHM9RmFsc2UsCiAgICAgICAgICAgIHNwZWFrZXJfcHJlZml4PXNwZWFrZXJfcHJlZml4LAogICAgICAgICAgICBkaWFyaXplX2t3YXJncz17Im51bV9zcGVha2VycyI6IDF9LCAgIyBTZXQgdG8gb25lIHNwZWFrZXIuCiAgICAgICAgKQogICAgICAgIGZvciBjaGFubmVsIGluIHJhbmdlKGF1ZGlvLnNoYXBlWzBdKQogICAgXQoKICAgICMgTWVyZ2UgdGhlIGNoYW5uZWwgZGlhcml6YXRpb25zIGludG8gYSBzaW5nbGUgc29ydGVkIGxpc3Q6CiAgICByZXR1cm4gbGlzdChoZWFwcS5tZXJnZSgqY2hhbm5lbF9kaWFyaXphdGlvbnMpKQo=
    base_image: mlrun/mlrun-gpu
    commands: []
    code_origin: ''
    origin_filename: ''
    requirements:
    - pyannote.audio
    - pyannote.core
    - torchaudio
    - tqdm
  entry_points:
    open_mpi_handler:
      name: open_mpi_handler
      doc: ''
      parameters:
      - name: worker_inputs
        type: List[str]
      - name: root_worker_inputs
        type: Dict[str, Any]
        default: null
      outputs:
      - default: ''
      lineno: 61
    decorator:
      name: decorator
      doc: ''
      parameters:
      - name: handler
      outputs:
      - default: ''
      lineno: 73
    wrapper:
      name: wrapper
      doc: ''
      parameters: []
      outputs:
      - default: ''
      lineno: 78
    diarize:
      name: diarize
      doc: "Perform speech diarization on given audio files using pyannote-audio (https://github.com/pyannote/pyannote-audio).\n\
        The end result is a dictionary with the file names as keys and their diarization\
        \ as value. A diarization is a list\nof tuples: (start, end, speaker_label).\n\
        \nTo use the `pyannote.audio` models you must pass a Huggingface token and\
        \ get access to the required models. The\ntoken can be passed in one of the\
        \ following options:\n\n* Use the parameter `access_token`.\n* Set an environment\
        \ variable named \"HUGGING_FACE_HUB_TOKEN\".\n* If using MLRun, you can pass\
        \ it as a secret named \"HUGGING_FACE_HUB_TOKEN\".\n\nTo get access to the\
        \ models on Huggingface, visit their page. For example, to use the default\
        \ diarization model set\nin this function (\"pyannote/speaker-diarization-3.0\"\
        ), you need access for these two models:\n\n* https://huggingface.co/pyannote/segmentation-3.0\n\
        * https://huggingface.co/pyannote/speaker-diarization-3.0\n\nNote: To control\
        \ the recognized speakers in the diarization output you can choose one of\
        \ the following methods:\n\n* For a known speakers amount, you may set speaker\
        \ labels via the `speakers_labels` parameter that will be used in\n  the order\
        \ of speaking in the audio (first person speaking be the first label in the\
        \ list). In addition, you can do\n  diarization per channel (setting the parameter\
        \ `separate_by_channels` to True). Each label will be assigned to a\n  specific\
        \ channel by order (first label to channel 0, second label to channel 1 and\
        \ so on). Notice, this will\n  increase runtime.\n* For unknown speakers amount,\
        \ you can set the `speaker_prefix` parameter to add a prefix for each speaker\
        \ number.\n  You can also help the diarization by setting the speakers range\
        \ via the `speakers_amount_range` parameter."
      parameters:
      - name: data_path
        type: Union[str, List[str]]
        doc: A directory of the audio files, a single file or a list of files to transcribe.
      - name: model_name
        type: str
        doc: 'One of the official diarization model names (referred as diarization
          pipelines) of `pyannote.audio` Huggingface page. Default: "pyannote/speaker-diarization-3.0".'
        default: pyannote/speaker-diarization-3.0
      - name: access_token
        type: str
        doc: An access token to pass for using the `pyannote.audio` models. If not
          provided, it will be looking for the environment variable "HUGGING_FACE_HUB_TOKEN".
          If MLRun is available, it will look for a secret "HUGGING_FACE_HUB_TOKEN".
        default: null
      - name: device
        type: str
        doc: Device to load the model. Can be one of {"cuda", "cpu"}. Default will
          prefer "cuda" if available.
        default: null
      - name: speakers_labels
        type: List[str]
        doc: 'Labels to use for the recognized speakers. Default: numeric labels (0,
          1, ...).'
        default: null
      - name: speaker_prefix
        type: str
        doc: 'A prefix to add for the speakers labels. This parameter is ignored if
          `speakers_labels` is not None. Default: "speaker".'
        default: speaker_
      - name: separate_by_channels
        type: bool
        doc: If each speaker is speaking in a separate channel, you can diarize each
          channel and combine the result into a single diarization. Each label set
          in the `speakers_labels` parameter will be assigned to a specific channel
          by order.
        default: false
      - name: minimum_speakers
        type: int
        doc: Set the minimum expected amount of speakers to be in the audio files.
          This parameter is ignored if `speakers_labels` is not None.
        default: null
      - name: maximum_speakers
        type: int
        doc: Set the maximum expected amount of speakers to be in the audio files.
          This parameter is ignored if `speakers_labels` is not None.
        default: null
      - name: verbose
        type: bool
        doc: 'Whether to present logs of a progress bar and errors. Default: True.'
        default: false
      outputs:
      - doc: 'A tuple of:'
        default: ''
      lineno: 139
  description: pyannote's speech diarization of audio files
  default_handler: diarize
  disable_auto_mount: false
  clone_target_dir: ''
  env: []
  priority_class_name: ''
  preemption_mode: prevent
  affinity: null
  tolerations: null
  security_context: {}
verbose: false

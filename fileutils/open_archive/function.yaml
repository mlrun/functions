kind: job
metadata:
  name: open-archive
spec:
  description: 'retrieve archive and extract all'
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlciBvbiAyMDIwLTAxLTIxIDA5OjQ3CgppbXBvcnQgbWxydW4KbWxydW4ubWxjb25mLmRicGF0aCA9ICdodHRwOi8vbWxydW4tYXBpOjgwODAnCgppbXBvcnQgdXJsbGliLnJlcXVlc3QKCmltcG9ydCBvcwppbXBvcnQgemlwZmlsZQppbXBvcnQgdXJsbGliCmltcG9ydCB0YXJmaWxlCmltcG9ydCBqc29uCgpmcm9tIG1scnVuLmV4ZWN1dGlvbiBpbXBvcnQgTUxDbGllbnRDdHgKCmRlZiBvcGVuX2FyY2hpdmUoY29udGV4dDogTUxDbGllbnRDdHgsIAogICAgICAgICAgICAgICAgIHRhcmdldF9kaXI6IHN0ciA9ICdjb250ZW50JywKICAgICAgICAgICAgICAgICBhcmNoaXZlX3VybDogc3RyID0gJycpOgogICAgIiIiT3BlbiBhIGZpbGUvb2JqZWN0IGFyY2hpdmUgaW50byBhIHRhcmdldCBkaXJlY3RvcnkKICAgIAogICAgQ3VycmVudGx5IHN1cHBvcnRzIHppcCBhbmQgdGFyLmd6CiAgICAiIiIKICAgIG9zLm1ha2VkaXJzKHRhcmdldF9kaXIsIGV4aXN0X29rPVRydWUpCiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdWZXJpZmllZCBkaXJlY3RvcmllcycpCiAgICBwcmludChhcmNoaXZlX3VybCkKICAgIHNwbGl0cyA9IGFyY2hpdmVfdXJsLnNwbGl0KCcuJykKICAgIHByaW50KHNwbGl0cykKICAgIGlmIChzcGxpdHNbLTFdID09ICdneicpOgogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oJ29wZW5pbmcgdGFyX2d6JykKICAgICAgICByZWYgPSB0YXJmaWxlLm9wZW4oZmlsZW9iaj11cmxsaWIucmVxdWVzdC51cmxvcGVuKGFyY2hpdmVfdXJsKSwgbW9kZT0ncnxneicpCiAgICBlbGlmIHNwbGl0c1stMV0gPT0gJ3ppcCc6CiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygnb3BlbmluZyB6aXAnKQogICAgICAgIHJlZiA9IHppcGZpbGUuWmlwRmlsZShhcmNoaXZlX3VybCwgJ3InKQoKICAgIHJlZi5leHRyYWN0YWxsKHRhcmdldF9kaXIpCiAgICByZWYuY2xvc2UoKQoKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KCdjb250ZW50JywgdGFyZ2V0X3BhdGg9dGFyZ2V0X2RpcikKCg==
    build_image: yjbds/mlrun-files:latest
    commands: []

kind: job
metadata:
  name: test-classifier
  tag: ''
  hash: c768dc0c66298e9a0ebe79a118698713fc84cfbd
  project: ''
spec:
  command: ''
  args: []
  image: yjbds/mlrun-ds:latest
  volumes: []
  volume_mounts: []
  env: []
  description: ''
  build:
    functionSourceCode: aW1wb3J0IG9zCmltcG9ydCBpbXBvcnRsaWIKZnJvbSBjbG91ZHBpY2tsZSBpbXBvcnQgbG9hZAoKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IGxpZ2h0Z2JtIGFzIGxnYgoKZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IChyb2NfY3VydmUsIGNvbmZ1c2lvbl9tYXRyaXgpCmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IHRyYWluX3Rlc3Rfc3BsaXQKCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKZnJvbSBtYXRwbG90bGliLmZpZ3VyZSBpbXBvcnQgRmlndXJlCmltcG9ydCBzZWFib3JuIGFzIHNucwoKZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBVbmlvbiwgTGlzdAoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gbWxydW4uZGF0YXN0b3JlIGltcG9ydCBEYXRhSXRlbQpmcm9tIG1scnVuLmFydGlmYWN0cyBpbXBvcnQgVGFibGVBcnRpZmFjdCwgUGxvdEFydGlmYWN0CgppbXBvcnQgd2FybmluZ3MKd2FybmluZ3Muc2ltcGxlZmlsdGVyKGFjdGlvbj0naWdub3JlJywgY2F0ZWdvcnk9RnV0dXJlV2FybmluZykKCmRlZiB0ZXN0X21vZGVsKAogICAgY29udGV4dDogT3B0aW9uYWxbTUxDbGllbnRDdHhdLAogICAgbW9kZWw6IFVuaW9uW0RhdGFJdGVtLCBzdHJdLAogICAgeHRlc3QsIAogICAgeXRlc3QsCiAgICB0YXJnZXRfcGF0aDogc3RyID0gJycsCiAgICBuYW1lOiBzdHIgPSAnJywKICAgIGtleTogc3RyID0gJycsCiAgICByYW5kb21fc3RhdGUgPSAxCikgLT4gTm9uZToKICAgICIiIlRlc3QgYSBjbGFzc2lmaWVyIG1vZGVsCiAgICAKICAgIFVzaW5nIGhlbGQtb3V0IHRlc3QgZmVhdHVyZXMsIGNhbGxzIGBtb2RlbC5wcmVkaWN0KHh0ZXN0KWAgYW5kIGV2YWx1YXRlcyB0aGUgYWNjdXJhY3kgb2YgdGhlIAogICAgZXN0aW1hdGVkIG1vZGVsLgogICAgCiAgICBDYW4gYmUgcGFydCBvZiBhIGt1YmVmbG93IHBpcGVsaW5lIGFzIGEgdGVzdCBzdGVwIG9yIGNhbGxlZAogICAgCiAgICA6cGFyYW0gY29udGV4dDogICAgICAgICB0aGUgZnVuY3Rpb24gY29udGV4dAogICAgOnBhcmFtIG1vZGVsOiAgICAgICAgICAgZXN0aW1hdGVkIG1vZGVsIGZpbGUgbmFtZSBhcyBhcnRpZmFjdCBzdG9yZSBpdGVtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciBwaWNrbGUgZmlsZSBuYW1lCiAgICA6cGFyYW0geHRlc3Q6ICAgICAgICAgICB0ZXN0IGZlYXR1cmVzIGZpbGUgbmFtZSBhcyBhcnRpZmFjdCBzdG9yZSBpdGVtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciBwaWNrbGUgZmlsZSBuYW1lCiAgICA6cGFyYW0gaGVhZGVyOiAgICAgICAgICAoT3B0aW9uYWwpIHVzZSBpZiB4dGVzdCBkb2VzIG5vdCBoYXZlIGEgaGVhZGVyCiAgICA6cGFyYW0geXRlc3Q6ICAgICAgICAgICB0ZXN0IGxhYmVscyBmaWxlIG5hbWUgYXMgYXJ0aWZhY3Qgc3RvcmUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtIG9yIHBpY2tsZSBmaWxlIG5hbWUKICAgIDpwYXJhbSB0YXJnZXRfcGF0aDogICAgIGZvbGRlciBsb2NhdGlvbiBvZiBmaWxlcwogICAgOnBhcmFtIG5hbWU6ICAgICAgICAgICAgZGVzdGluYXRpb24gbmFtZSBmb3IgdGVzdCByZXN1bHRzCiAgICA6cGFyYW0ga2V5OiAgICAgICAgICAgICBrZXkgZm9yIG1vZGVsIGFydGlmYWN0CiAgICAiIiIKICAgICMgbG9hZCBtb2RlbCBhbmQgZGF0YQogICAgaWYgaXNpbnN0YW5jZShtb2RlbCwgRGF0YUl0ZW0pOgogICAgICAgIGNsZiA9IGxvYWQob3BlbihzdHIobW9kZWwpLCAncmInKSkKICAgIGVsc2U6CiAgICAgICAgY2xmID0gbG9hZChvcGVuKG1vZGVsLCAncmInKSkKCiAgICBpZiBpc2luc3RhbmNlKHh0ZXN0LCBEYXRhSXRlbSk6CiAgICAgICAgeHRlc3QgPSBwZC5yZWFkX3BhcnF1ZXQoc3RyKHh0ZXN0KSkKICAgICAgICB5dGVzdCA9IHBkLnJlYWRfcGFycXVldChzdHIoeXRlc3QpKQogICAgZWxzZToKICAgICAgICB4dGVzdCA9IHBkLnJlYWRfcGFycXVldCh4dGVzdCkKICAgICAgICB5dGVzdCA9IHBkLnJlYWRfcGFycXVldCh5dGVzdCkKICAgIAogICAgaWYgY2FsbGFibGUoZ2V0YXR0cihjbGYsICdwcmVkaWN0X3Byb2JhJykpOgogICAgICAgIHlwcmVkX3Byb2JzID0gY2xmLnByZWRpY3RfcHJvYmEoeHRlc3QpWzosIDFdCiAgICAgICAgeXByZWQgPSBucC53aGVyZSh5cHJlZF9wcm9icyA+PSAwLjUsIDEsIDApCiAgICAgICAgcGxvdF9yb2MoY29udGV4dCwgeXRlc3QsIHlwcmVkX3Byb2JzLCB0YXJnZXRfcGF0aCkKICAgIGVsc2U6CiAgICAgICAgeXByZWQgPSBjbGYucHJlZGljdCh4dGVzdCkKICAgICAgICB5cHJlZF9wcm9icyA9IE5vbmUKICAgIAogICAgcGxvdF9jb25mdXNpb25fbWF0cml4KGNvbnRleHQsIHl0ZXN0LCB5cHJlZCwgdGFyZ2V0X3BhdGgpCgogICAgaWYgaGFzYXR0cihjbGYsICdmZWF0dXJlX2ltcG9ydGFuY2VzXycpOgogICAgICAgIHBsb3RfaW1wb3J0YW5jZShjb250ZXh0LCBjbGYsIHh0ZXN0LmNvbHVtbnMudmFsdWVzLCB0YXJnZXRfcGF0aCkKCmRlZiBfZ2NmX2NsZWFyKHBsdCk6CiAgICBwbHQuY2xhKCkKICAgIHBsdC5jbGYoKQogICAgcGx0LmNsb3NlKCkgICAgICAgIAoKZGVmIHBsb3Rfcm9jKAogICAgY29udGV4dDogTUxDbGllbnRDdHgsIAogICAgeV9sYWJlbHMsCiAgICB5X3Byb2JzLAogICAgdGFyZ2V0X3BhdGg6IHN0ciA9ICcnLAogICAgbmFtZT0ncm9jLnBuZycsCiAgICBrZXk9J3JvYycsCiAgICBmbXQ9J3BuZycKKToKICAgICIiIlBsb3QgYW4gUk9DIGN1cnZlIGZyb20gdGVzdCBkYXRhIHNhdmVkIGluIGFuIGFydGlmYWN0IHN0b3JlLgogICAgCiAgICA6cGFyYW0gY29udGV4dDogICAgICAgICBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0geV9sYWJlbHM6ICAgICAgICB0ZXN0IGRhdGEgbGFiZWxzCiAgICA6cGFyYW0geV9wcm9iczogICAgICAgICB0ZXN0IGRhdGEgCiAgICAiIiIKICAgIGZwcl94ZywgdHByX3hnLCBfID0gcm9jX2N1cnZlKHlfbGFiZWxzLCB5X3Byb2JzKQogICAgcGx0LnBsb3QoWzAsIDFdLCBbMCwgMV0sICJrLS0iKQogICAgcGx0LnBsb3QoZnByX3hnLCB0cHJfeGcsIGxhYmVsPSJyb2MiKQogICAgcGx0LnhsYWJlbCgiZmFsc2UgcG9zaXRpdmUgcmF0ZSIpCiAgICBwbHQueWxhYmVsKCJ0cnVlIHBvc2l0aXZlIHJhdGUiKQogICAgcGx0LnRpdGxlKCJyb2MgY3VydmUiKQogICAgcGx0LmxlZ2VuZChsb2M9ImJlc3QiKQogICAgZmlnID0gcGx0LmdjZigpCgogICAgcGxvdHBhdGggPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUpCiAgICBmaWcuc2F2ZWZpZyhwbG90cGF0aCwgZm9ybWF0PWZtdCkKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFBsb3RBcnRpZmFjdChrZXksIGJvZHk9ZmlnKSkKCiAgICBfZ2NmX2NsZWFyKHBsdCkKCmRlZiBwbG90X2NvbmZ1c2lvbl9tYXRyaXgoCiAgICBjb250ZXh0OiBNTENsaWVudEN0eCwgCiAgICBsYWJlbHMsIAogICAgcHJlZGljdGlvbnMsCiAgICB0YXJnZXRfcGF0aDogc3RyID0gJycsIAogICAgbmFtZTogc3RyID0iY29uZnVzaW9uLnBuZyIsIAogICAga2V5OiBzdHIgPSdjb25mdXNpb25fbWF0cml4JywKICAgIGZtdDogc3RyID0gJ3BuZycKKToKICAgICIiIkNyZWF0ZSBhIGNvbmZ1c2lvbiBtYXRyaXguCiAgICBQbG90IGFuZCBzYXZlIGEgY29uZnVzaW9uIG1hdHJpeCB1c2luZyB0ZXN0IGRhdGEgZnJvbSBhCiAgICBwaXBlbGluZSBzdGVwLgoKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgIGZ1bmN0aW9uIGNvbnRleHQKICAgIDpwYXJhbSBsYWJlbHM6ICAgICAgICAgIHRlc3QgZGF0YSBsYWJlbHMKICAgIDpwYXJhbSBwcmVkaWN0aW9uczogICAgIHRlc3QgZGF0YSBwcmVkaWN0aW9ucwogICAgIiIiCiAgICBjbSA9IGNvbmZ1c2lvbl9tYXRyaXgobGFiZWxzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljdGlvbnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVfd2VpZ2h0PU5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWxpemU9J2FsbCcpCiAgICBzbnMuaGVhdG1hcChjbSwgYW5ub3Q9VHJ1ZSwgY21hcD0iQmx1ZXMiKQogICAgcGxvdHBhdGggPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUpCiAgICBmaWcgPSBwbHQuZ2NmKCkKICAgIGZpZy5zYXZlZmlnKHBsb3RwYXRoLCBmb3JtYXQ9Zm10KQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoUGxvdEFydGlmYWN0KGtleSwgYm9keT1maWcpKQoKICAgIF9nY2ZfY2xlYXIocGx0KQoKZGVmIHBsb3RfaW1wb3J0YW5jZSgKICAgIGNvbnRleHQsCiAgICBtb2RlbCwKICAgIGhlYWRlcjogTGlzdCA9IFtdLAogICAgdGFyZ2V0X3BhdGg6IHN0ciA9ICcnLAogICAgbmFtZTogc3RyID0gJ2ZlYXR1cmUtaW1wb3J0YW5jZXMucG5nJywKICAgIGtleTogc3RyID0gJ2ZlYXR1cmUtaW1wb3J0YW5jZXMnLAogICAgZm10ID0gJ3BuZycKKToKICAgICIiIkRpc3BsYXkgZXN0aW1hdGVkIGZlYXR1cmUgaW1wb3J0YW5jZXMuCgogICAgOnBhcmFtIGNvbnRleHQ6ICAgICBmdW5jdGlvbiBjb250ZXh0CiAgICA6cGFyYW0gbW9kZWw6ICAgICAgIGZpdHRlZCBsaWdodGdibSBtb2RlbAogICAgOnBhcmFtIGhlYWRlcjogICAgICBsaXN0IG9mIGZlYXR1cmUgbmFtZXMKICAgICIiIgogICAgIyBjcmVhdGUgYSBmZWF0dXJlIGltcG9ydGFuY2UgdGFibGUgd2l0aCBkZXNpcmVkIGxhYmVscwogICAgemlwcGVkID0gemlwKG1vZGVsLmZlYXR1cmVfaW1wb3J0YW5jZXNfLCBoZWFkZXIpCgogICAgZmVhdHVyZV9pbXAgPSBwZC5EYXRhRnJhbWUoc29ydGVkKHppcHBlZCksIGNvbHVtbnM9WydmcmVxJywnZmVhdHVyZSddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5zb3J0X3ZhbHVlcyhieT0iZnJlcSIsIGFzY2VuZGluZz1GYWxzZSkKCiAgICBwbHQuZmlndXJlKGZpZ3NpemU9KDIwLCAxMCkpCiAgICBzbnMuYmFycGxvdCh4PSJmcmVxIiwgeT0iZmVhdHVyZSIsIGRhdGE9ZmVhdHVyZV9pbXApCiAgICBwbHQudGl0bGUoJ0xpZ2h0R0JNIEZlYXR1cmVzJykKICAgIHBsdC50aWdodF9sYXlvdXQoKQogICAgZmlnID0gcGx0LmdjZigpCiAgICBwbG90cGF0aCA9IG9zLnBhdGguam9pbih0YXJnZXRfcGF0aCwgbmFtZSkKICAgIGZpZy5zYXZlZmlnKHBsb3RwYXRoLCBmb3JtYXQ9J3BuZycpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChQbG90QXJ0aWZhY3Qoa2V5ICsgJy1wbG90JywgYm9keT1maWcpKQoKICAgICMgZmVhdHVyZSBpbXBvcnRhbmNlcyBhcmUgYWxzbyBzYXZlZCBhcyBhIHRhYmxlOgogICAgdGFibGVwYXRoID0gb3MucGF0aC5qb2luKHRhcmdldF9wYXRoLCBrZXkgKyAnLXRhYmxlLmNzdicpCiAgICBmZWF0dXJlX2ltcC50b19jc3YodGFibGVwYXRoKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoVGFibGVBcnRpZmFjdChrZXkgKyAnLXRhYmxlJywgdGFyZ2V0X3BhdGg9dGFibGVwYXRoKSkKCiAgICAjIHRvIGVuc3VyZSB3ZSBkb24ndCBvdmVyd3JpdGUgdGhpcyBmaWd1cmUgd2hlbiBjcmVhdGluZyB0aGUgbmV4dDoKICAgIF9nY2ZfY2xlYXIocGx0KQo=
    base_image: yjbds/mlrun-ds:latest
    commands: []
    code_origin: https://github.com/yjb-ds/functions.git#25e611e4bd05320d342708ce786522bfecaa0e51:/User/repos/functions/evaluation/test-classifier.py

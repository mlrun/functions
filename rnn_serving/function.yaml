kind: serving
metadata:
  name: rnn-model-serving
  tag: ''
  hash: e8ee01031459ede795c3adc60417374090ae138b
  project: default
spec:
  command: ''
  args: []
  image: ''
  entry_points:
    load:
      name: load
      doc: load and initialize the model and/or other elements
      parameters:
      - name: self
        default: ''
      outputs:
      - default: ''
      lineno: 16
    predict:
      name: predict
      doc: ''
      parameters:
      - name: self
        default: ''
      - name: body
        default: ''
      outputs:
      - default: ''
      lineno: 21
    init_context:
      name: init_context
      doc: ''
      parameters:
      - name: context
        default: ''
      outputs:
      - default: ''
      lineno: 33
    handler:
      name: handler
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: event
        default: ''
      outputs:
      - default: ''
      lineno: 36
  description: ''
  min_replicas: 1
  max_replicas: 4
  env:
  - name: V3IO_API
    value: ''
  - name: V3IO_USERNAME
    value: ''
  - name: V3IO_ACCESS_KEY
    value: ''
  base_spec:
    apiVersion: nuclio.io/v1
    kind: Function
    metadata:
      annotations:
        nuclio.io/generated_by: function generated from /User/test/demos/stock-analysis/code/rnn_serving.ipynb
      labels: {}
      name: rnn-model-serving
    spec:
      build:
        baseImage: mlrun/mlrun
        commands:
        - python -m pip install tensorflow==2.2.0
        - python -m pip install keras
        functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IG1scnVuCmltcG9ydCBudWNsaW8KaW1wb3J0IG9zCgppbXBvcnQgcGFuZGFzIGFzIHBkCmZyb20gbWxydW4gaW1wb3J0IE1MQ2xpZW50Q3R4CmltcG9ydCBvcwppbXBvcnQgbWxydW4KaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93CmltcG9ydCBqc29uCgpjbGFzcyBSTk5fTW9kZWxfU2VydmluZyhtbHJ1bi5zZXJ2aW5nLlYyTW9kZWxTZXJ2ZXIpOiAgICAKICAgIGRlZiBsb2FkKHNlbGYpOgogICAgICAgICIiImxvYWQgYW5kIGluaXRpYWxpemUgdGhlIG1vZGVsIGFuZC9vciBvdGhlciBlbGVtZW50cyIiIgogICAgICAgIG1vZGVsX2ZpbGUsZXh0cmFfZGF0YSA9IHNlbGYuZ2V0X21vZGVsKHN1ZmZpeCA9ICIuaDUiKQogICAgICAgIHNlbGYubW9kZWwgPSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscy5sb2FkX21vZGVsKG1vZGVsX2ZpbGUpCiAgICAgICAgCiAgICBkZWYgcHJlZGljdChzZWxmLCBib2R5KToKICAgICAgICB0cnk6CiAgICAgICAgICAgICIiIkdlbmVyYXRlIG1vZGVsIHByZWRpY3Rpb25zIGZyb20gc2FtcGxlLiIiIgogICAgICAgICAgICBmZWF0cyA9IG5wLmFzYXJyYXkoYm9keVsnaW5wdXRzJ10pCiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYubW9kZWwucHJlZGljdChmZWF0cykKICAgICAgICAgICAgcmVzdWx0ID0ganNvbi5kdW1wcyhyZXN1bHQudG9saXN0KCkpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigiRmFpbGVkIHRvIHByZWRpY3QgJXMiICUgZSkKCgpmcm9tIG1scnVuLnJ1bnRpbWVzIGltcG9ydCBudWNsaW9faW5pdF9ob29rCmRlZiBpbml0X2NvbnRleHQoY29udGV4dCk6CiAgICBudWNsaW9faW5pdF9ob29rKGNvbnRleHQsIGdsb2JhbHMoKSwgJ3NlcnZpbmdfdjInKQoKZGVmIGhhbmRsZXIoY29udGV4dCwgZXZlbnQpOgogICAgcmV0dXJuIGNvbnRleHQubWxydW5faGFuZGxlcihjb250ZXh0LCBldmVudCkK
        noBaseImagesPull: true
      env:
      - name: V3IO_ACCESS_KEY
        value: bde21934-1d1c-4c23-8c44-07ee8acaf90c
      - name: V3IO_USERNAME
        value: dani
      - name: V3IO_API
        value: v3io-webapi.default-tenant.svc:8081
      handler: rnn_serving:handler
      runtime: python:3.6
      volumes: []
  source: ''
  function_kind: serving_v2
  graph:
    kind: router
    full_event: true
    routes:
      model2:
        kind: task
        class_name: RNN_Model_Serving
        class_args:
          model_path: /User/test/demos/stock-analysis/models/mymodel.h5
        full_event: true
  build:
    commands: []
    code_origin: https://github.com/daniels290813/demos.git#d620be1dc3d0d49f8acd1e8deb25ef5ad3fbd33c:RNN_Model_Serving.ipynb
  secret_sources: []
  affinity: null
verbose: false

kind: job
metadata:
  name: describe
  tag: ''
  hash: 95413e848df6368370b08bd11422b9c2c9ccf726
  project: ''
  labels:
    author: Davids
  categories:
  - data-analysis
spec:
  command: ''
  args: []
  image: mlrun/mlrun
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAxOSBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiMKIyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiMgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKIyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KIyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiMgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiMKIyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IHdhcm5pbmdzCmZyb20gdHlwaW5nIGltcG9ydCBVbmlvbgoKaW1wb3J0IG1scnVuCmltcG9ydCBudW1weSBhcyBucAoKCndhcm5pbmdzLnNpbXBsZWZpbHRlcihhY3Rpb249Imlnbm9yZSIsIGNhdGVnb3J5PUZ1dHVyZVdhcm5pbmcpCgppbXBvcnQgbWxydW4uZmVhdHVyZV9zdG9yZSBhcyBmc3RvcmUKaW1wb3J0IHBhbmRhcyBhcyBwZAppbXBvcnQgcGxvdGx5LmV4cHJlc3MgYXMgcHgKaW1wb3J0IHBsb3RseS5maWd1cmVfZmFjdG9yeSBhcyBmZgppbXBvcnQgcGxvdGx5LmdyYXBoX29iamVjdHMgYXMgZ28KZnJvbSBtbHJ1bi5hcnRpZmFjdHMgaW1wb3J0IChEYXRhc2V0QXJ0aWZhY3QsIEFydGlmYWN0LCBQbG90bHlBcnRpZmFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUFydGlmYWN0LCB1cGRhdGVfZGF0YXNldF9tZXRhKQpmcm9tIG1scnVuLmRhdGFzdG9yZSBpbXBvcnQgRGF0YUl0ZW0KZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gbWxydW4uZmVhdHVyZV9zdG9yZSBpbXBvcnQgRmVhdHVyZVNldCwgRmVhdHVyZVZlY3Rvcgpmcm9tIHBsb3RseS5zdWJwbG90cyBpbXBvcnQgbWFrZV9zdWJwbG90cwoKcGQuc2V0X29wdGlvbigiZGlzcGxheS5mbG9hdF9mb3JtYXQiLCBsYW1iZGEgeDogIiUuMmYiICUgeCkKTUFYX1NJWkVfT0ZfREYgPSA1MDAwMDAKCgpkZWYgYW5hbHl6ZSgKICAgICAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgICAgICBuYW1lOiBzdHIgPSAiZGF0YXNldCIsCiAgICAgICAgdGFibGU6IFVuaW9uW0ZlYXR1cmVTZXQsIERhdGFJdGVtXSA9IE5vbmUsCiAgICAgICAgbGFiZWxfY29sdW1uOiBzdHIgPSBOb25lLAogICAgICAgIHBsb3RzX2Rlc3Q6IHN0ciA9ICJwbG90cyIsCiAgICAgICAgcmFuZG9tX3N0YXRlOiBpbnQgPSAxLAogICAgICAgIHByb2JsZW1fdHlwZTogc3RyID0gImNsYXNzaWZpY2F0aW9uIiwKICAgICAgICBkYXNrX2tleTogc3RyID0gImRhc2tfa2V5IiwKICAgICAgICBkYXNrX2Z1bmN0aW9uOiBzdHIgPSBOb25lLAogICAgICAgIGRhc2tfY2xpZW50PU5vbmUsCikgLT4gTm9uZToKICAgICIiIgogICAgVGhlIGZ1bmN0aW9uIHdpbGwgb3V0cHV0IHRoZSBmb2xsb3dpbmcgYXJ0aWZhY3RzIHBlcgogICAgY29sdW1uIHdpdGhpbiB0aGUgZGF0YSBmcmFtZSAoYmFzZWQgb24gZGF0YSB0eXBlcykKICAgIElmIHRoZSBkYXRhIGhhcyBtb3JlIHRoYW4gNTAwLDAwMCBzYW1wbGUgd2UKICAgIHNhbXBsZSByYW5kb21seSA1MDAsMDAwIHNhbXBsZXM6CgogICAgZGVzY3JpYmUgY3N2CiAgICBoaXN0b2dyYW1zCiAgICBzY2F0dGVyLTJkCiAgICB2aW9saW4gY2hhcnQKICAgIGNvcnJlbGF0aW9uLW1hdHJpeCBjaGFydAogICAgY29ycmVsYXRpb24tbWF0cml4IGNzdgogICAgaW1iYWxhbmNlIHBpZSBjaGFydAogICAgaW1iYWxhbmNlLXdlaWdodHMtdmVjIGNzdgoKICAgIDpwYXJhbSBjb250ZXh0OiAgICAgICAgICAgICAgICAgVGhlIGZ1bmN0aW9uIGNvbnRleHQKICAgIDpwYXJhbSBuYW1lOiAgICAgICAgICAgICAgICAgICAgS2V5IG9mIGRhdGFzZXQgdG8gZGF0YWJhc2UgKCJkYXRhc2V0IiBmb3IgZGVmYXVsdCkKICAgIDpwYXJhbSB0YWJsZTogICAgICAgICAgICAgICAgICAgTUxSdW4gaW5wdXQgcG9pbnRpbmcgdG8gcGFuZGFzIGRhdGFmcmFtZSAoY3N2L3BhcnF1ZXQgZmlsZSBwYXRoKSBvciBGZWF0dXJlU2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzIHBhcmFtCiAgICA6cGFyYW0gbGFiZWxfY29sdW1uOiAgICAgICAgICAgIEdyb3VuZCB0cnV0aCBjb2x1bW4gbGFiZWwKICAgIDpwYXJhbSBwbG90c19kZXN0OiAgICAgICAgICAgICAgRGVzdGluYXRpb24gZm9sZGVyIG9mIHN1bW1hcnkgcGxvdHMgKHJlbGF0aXZlIHRvIGFydGlmYWN0X3BhdGgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgicGxvdHMiIGZvciBkZWZhdWx0KQogICAgOnBhcmFtIHJhbmRvbV9zdGF0ZTogICAgICAgICAgICBXaGVuIHRoZSB0YWJsZSBoYXMgbW9yZSB0aGFuIDUwMCwwMDAgc2FtcGxlcywgd2Ugc2FtcGxlIHJhbmRvbWx5IDUwMCwwMDAgc2FtcGxlcwogICAgOnBhcmFtIHByb2JsZW1fdHlwZSAgICAgICAgICAgICBUaGUgdHlwZSBvZiB0aGUgTUwgcHJvYmxlbSB0aGUgZGF0YSBmYWNpbmcgLSByZWdyZXNzaW9uLCBjbGFzc2lmaWNhdGlvbiBvciBOb25lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjbGFzc2lmaWNhdGlvbiBmb3IgZGVmYXVsdCkKICAgIDpwYXJhbSBkYXNrX2tleTogICAgICAgICAgICAgICAgS2V5IG9mIGRhdGFmcmFtZSBpbiBkYXNrIGNsaWVudCAiZGF0YXNldHMiIGF0dHJpYnV0ZQogICAgOnBhcmFtIGRhc2tfZnVuY3Rpb246ICAgICAgICAgICBEYXNrIGZ1bmN0aW9uIHVybCAoZGI6Ly8uLikKICAgIDpwYXJhbSBkYXNrX2NsaWVudDogICAgICAgICAgICAgRGFzayBjbGllbnQgb2JqZWN0CiAgICAiIiIKICAgIGRhdGFfaXRlbSwgZmVhdHVyZXNldCwgY3JlYXQsIHVwZGF0ZSA9IEZhbHNlLCBGYWxzZSwgRmFsc2UsIEZhbHNlCiAgICBnZXRfZnJvbV90YWJsZSA9IFRydWUKICAgIGlmIGRhc2tfZnVuY3Rpb24gb3IgZGFza19jbGllbnQ6CiAgICAgICAgZGF0YV9pdGVtLCBjcmVhdCA9IFRydWUsIFRydWUKICAgICAgICBpZiBkYXNrX2Z1bmN0aW9uOgogICAgICAgICAgICBjbGllbnQgPSBtbHJ1bi5pbXBvcnRfZnVuY3Rpb24oZGFza19mdW5jdGlvbikuY2xpZW50CiAgICAgICAgZWxpZiBkYXNrX2NsaWVudDoKICAgICAgICAgICAgY2xpZW50ID0gZGFza19jbGllbnQKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJkYXNrIGNsaWVudCB3YXMgbm90IHByb3ZpZGVkIikKCiAgICAgICAgaWYgZGFza19rZXkgaW4gY2xpZW50LmRhdGFzZXRzOgogICAgICAgICAgICBkZiA9IGNsaWVudC5nZXRfZGF0YXNldChkYXNrX2tleSkKICAgICAgICAgICAgZGF0YV9pdGVtLCBjcmVhdCwgZ2V0X2Zyb21fdGFibGUgPSBUcnVlLCBUcnVlLCBGYWxzZQogICAgICAgIGVsaWYgdGFibGU6CiAgICAgICAgICAgIGdldF9mcm9tX3RhYmxlID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oCiAgICAgICAgICAgICAgICBmIm9ubHkgdGhlc2UgZGF0YXNldHMgYXJlIGF2YWlsYWJsZSB7Y2xpZW50LmRhdGFzZXRzfSBpbiBjbGllbnQge2NsaWVudH0iCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJkYXRhc2V0IG5vdCBmb3VuZCBvbiBkYXNrIGNsdXN0ZXIiKQoKICAgIGlmIGdldF9mcm9tX3RhYmxlOgogICAgICAgIGlmIHR5cGUodGFibGUpID09IERhdGFJdGVtOgogICAgICAgICAgICBpZiB0YWJsZS5tZXRhIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBkYXRhX2l0ZW0sIGNyZWF0LCB1cGRhdGUgPSBUcnVlLCBUcnVlLCBGYWxzZQogICAgICAgICAgICBlbGlmIHRhYmxlLm1ldGEua2luZCA9PSAiZGF0YXNldCI6CiAgICAgICAgICAgICAgICBkYXRhX2l0ZW0sIGNyZWF0LCB1cGRhdGUgPSBUcnVlLCBGYWxzZSwgVHJ1ZQogICAgICAgICAgICBlbGlmIHRhYmxlLm1ldGEua2luZCA9PSAiRmVhdHVyZVZlY3RvciI6CiAgICAgICAgICAgICAgICBkYXRhX2l0ZW0sIGNyZWF0LCB1cGRhdGUgPSBUcnVlLCBGYWxzZSwgRmFsc2UKICAgICAgICAgICAgZWxpZiB0YWJsZS5tZXRhLmtpbmQgPT0gIkZlYXR1cmVTZXQiOgogICAgICAgICAgICAgICAgZmVhdHVyZXNldCwgY3JlYXQsIHVwZGF0ZSA9IFRydWUsIEZhbHNlLCBGYWxzZQoKICAgICAgICBpZiBkYXRhX2l0ZW06CiAgICAgICAgICAgIGRmID0gdGFibGUuYXNfZGYoKQogICAgICAgIGVsaWYgZmVhdHVyZXNldDoKICAgICAgICAgICAgcHJvamVjdF9uYW1lLCBzZXRfbmFtZSA9ICgKICAgICAgICAgICAgICAgIHRhYmxlLl9wYXRoLnNwbGl0KCIvIilbMl0sCiAgICAgICAgICAgICAgICB0YWJsZS5fcGF0aC5zcGxpdCgiLyIpWzRdLAogICAgICAgICAgICApCiAgICAgICAgICAgIGZlYXR1cmVfc2V0ID0gZnN0b3JlLmdldF9mZWF0dXJlX3NldCgKICAgICAgICAgICAgICAgIGYic3RvcmU6Ly9mZWF0dXJlLXNldHMve3Byb2plY3RfbmFtZX0ve3NldF9uYW1lfSIKICAgICAgICAgICAgKQogICAgICAgICAgICBkZiA9IGZlYXR1cmVfc2V0LnRvX2RhdGFmcmFtZSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29udGV4dC5sb2dnZXIuZXJyb3IoZiJXcm9uZyB0YWJsZSB0eXBlLiIpCiAgICAgICAgICAgIHJldHVybgoKICAgIGlmIGRmLnNpemUgPiBNQVhfU0laRV9PRl9ERjoKICAgICAgICBkZiA9IGRmLnNhbXBsZShuPWludChNQVhfU0laRV9PRl9ERiAvIGRmLnNoYXBlWzFdKSwgcmFuZG9tX3N0YXRlPXJhbmRvbV9zdGF0ZSkKICAgIGV4dHJhX2RhdGEgPSB7fQoKICAgIGlmIGxhYmVsX2NvbHVtbiBub3QgaW4gZGYuY29sdW1uczoKICAgICAgICBsYWJlbF9jb2x1bW4gPSBOb25lCgogICAgZXh0cmFfZGF0YVsiZGVzY3JpYmUgY3N2Il0gPSBjb250ZXh0LmxvZ19hcnRpZmFjdCgKICAgICAgICBUYWJsZUFydGlmYWN0KCJkZXNjcmliZS1jc3YiLCBkZj1kZi5kZXNjcmliZSgpKSwKICAgICAgICBsb2NhbF9wYXRoPWYie3Bsb3RzX2Rlc3R9L2Rlc2NyaWJlLmNzdiIsCiAgICApCgogICAgdHJ5OgogICAgICAgIF9jcmVhdGVfaGlzdG9ncmFtX21hdF9hcnRpZmFjdCgKICAgICAgICAgICAgY29udGV4dCwgZGYsIGV4dHJhX2RhdGEsIGxhYmVsX2NvbHVtbiwgcGxvdHNfZGVzdAogICAgICAgICkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBjb250ZXh0LmxvZ2dlci53YXJuKGYiRmFpbGVkIHRvIGNyZWF0ZSBoaXN0b2dyYW0gbWF0cml4IGFydGlmYWN0IGR1ZSB0bzoge2V9IikKICAgIHRyeToKICAgICAgICBfY3JlYXRlX2ZlYXR1cmVzX2hpc3RvZ3JhbV9hcnRpZmFjdHMoCiAgICAgICAgICAgIGNvbnRleHQsIGRmLCBleHRyYV9kYXRhLCBsYWJlbF9jb2x1bW4sIHBsb3RzX2Rlc3QsIHByb2JsZW1fdHlwZQogICAgICAgICkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBjb250ZXh0LmxvZ2dlci53YXJuKGYiRmFpbGVkIHRvIGNyZWF0ZSBwYWlycGxvdCBoaXN0b2dyYW1zIGR1ZSB0bzoge2V9IikKICAgIHRyeToKICAgICAgICBfY3JlYXRlX2ZlYXR1cmVzXzJkX3NjYXR0ZXJfYXJ0aWZhY3RzKAogICAgICAgICAgICBjb250ZXh0LCBkZiwgZXh0cmFfZGF0YSwgbGFiZWxfY29sdW1uLCBwbG90c19kZXN0LCBwcm9ibGVtX3R5cGUKICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgY29udGV4dC5sb2dnZXIud2FybihmIkZhaWxlZCB0byBjcmVhdGUgcGFpcnBsb3QgMmRfc2NhdHRlciBkdWUgdG86IHtlfSIpCiAgICB0cnk6CiAgICAgICAgX2NyZWF0ZV92aW9saW5fYXJ0aWZhY3QoY29udGV4dCwgZGYsIGV4dHJhX2RhdGEsIHBsb3RzX2Rlc3QpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgY29udGV4dC5sb2dnZXIud2FybihmIkZhaWxlZCB0byBjcmVhdGUgdmlvbGluIGRpc3RyaWJ1dGlvbiBwbG90cyBkdWUgdG86IHtlfSIpCiAgICB0cnk6CiAgICAgICAgX2NyZWF0ZV9pbWJhbGFuY2VfYXJ0aWZhY3QoCiAgICAgICAgICAgIGNvbnRleHQsIGRmLCBleHRyYV9kYXRhLCBsYWJlbF9jb2x1bW4sIHBsb3RzX2Rlc3QsIHByb2JsZW1fdHlwZQogICAgICAgICkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBjb250ZXh0LmxvZ2dlci53YXJuKGYiRmFpbGVkIHRvIGNyZWF0ZSBjbGFzcyBpbWJhbGFuY2UgcGxvdCBkdWUgdG86IHtlfSIpCiAgICB0cnk6CiAgICAgICAgX2NyZWF0ZV9jb3JyX2FydGlmYWN0KGNvbnRleHQsIGRmLCBleHRyYV9kYXRhLCBsYWJlbF9jb2x1bW4sIHBsb3RzX2Rlc3QpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgY29udGV4dC5sb2dnZXIud2FybihmIkZhaWxlZCB0byBjcmVhdGUgZmVhdHVyZXMgY29ycmVsYXRpb24gcGxvdCBkdWUgdG86IHtlfSIpCgogICAgaWYgbm90IGRhdGFfaXRlbToKICAgICAgICByZXR1cm4KCiAgICBhcnRpZmFjdCA9IHRhYmxlLmFydGlmYWN0X3VybAogICAgaWYgY3JlYXQ6ICAjIGRhdGFzZXQgbm90IHN0b3JlZAogICAgICAgIGFydGlmYWN0ID0gRGF0YXNldEFydGlmYWN0KAogICAgICAgICAgICBrZXk9ImRhdGFzZXQiLCBzdGF0cz1UcnVlLCBkZj1kZiwgZXh0cmFfZGF0YT1leHRyYV9kYXRhCiAgICAgICAgKQogICAgICAgIGFydGlmYWN0ID0gY29udGV4dC5sb2dfYXJ0aWZhY3QoYXJ0aWZhY3QsIGRiX2tleT1uYW1lKQogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZiJUaGUgZGF0YSBzZXQgaXMgbG9nZ2VkIHRvIHRoZSBwcm9qZWN0IHVuZGVyIHtuYW1lfSBuYW1lIikKCiAgICBpZiB1cGRhdGU6CiAgICAgICAgdXBkYXRlX2RhdGFzZXRfbWV0YShhcnRpZmFjdCwgZXh0cmFfZGF0YT1leHRyYV9kYXRhKQogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZiJUaGUgZGF0YSBzZXQgbmFtZWQge25hbWV9IGlzIHVwZGF0ZWQiKQoKICAgICMgVE9ETyA6IDMtRCBwbG90IG9uIG9uIHNlbGVjdGVkIGZlYXR1cmVzLgogICAgIyBUT0RPIDogUmVpbnRlZ3JhdGlvbiBwbG90IG9uIG9uIHNlbGVjdGVkIGZlYXR1cmVzLgogICAgIyBUT0RPIDogUENBIHBsb3QgKHdpdGggb3B0aW9ucykKCgpkZWYgX2NyZWF0ZV9oaXN0b2dyYW1fbWF0X2FydGlmYWN0KAogICAgICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgICAgIGRmOiBwZC5EYXRhRnJhbWUsCiAgICAgICAgZXh0cmFfZGF0YTogZGljdCwKICAgICAgICBsYWJlbF9jb2x1bW46IHN0ciwKICAgICAgICBwbG90c19kZXN0OiBzdHIsCik6CiAgICAiIiIKICAgIENyZWF0ZSBhbmQgbG9nIGEgaGlzdG9ncmFtIG1hdHJpeCBhcnRpZmFjdAogICAgIiIiCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdChpdGVtPUFydGlmYWN0KGtleT0naGlzdCcsIGJvZHk9Yic8Yj4gRGVwcmVjYXRlZCwgc2VlIHRoZSBhcnRpZmFjdHMgc2NhdHRlci0yZCAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYidhbmQgaGlzdG9ncmFtcyBpbnN0ZWFkPGI+JyksCiAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbF9wYXRoPWYie3Bsb3RzX2Rlc3R9L2hpc3QuaHRtbCIpCgoKZGVmIF9jcmVhdGVfZmVhdHVyZXNfaGlzdG9ncmFtX2FydGlmYWN0cygKICAgICAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgICAgICBkZjogcGQuRGF0YUZyYW1lLAogICAgICAgIGV4dHJhX2RhdGE6IGRpY3QsCiAgICAgICAgbGFiZWxfY29sdW1uOiBzdHIsCiAgICAgICAgcGxvdHNfZGVzdDogc3RyLAogICAgICAgIHByb2JsZW1fdHlwZTogc3RyLAopOgogICAgIiIiCiAgICBDcmVhdGUgYW5kIGxvZyBhIGhpc3RvZ3JhbSBhcnRpZmFjdCBmb3IgZWFjaCBmZWF0dXJlCiAgICAiIiIKCiAgICBmaWdzID0gZGljdCgpCiAgICBmaXJzdF9mZWF0dXJlX25hbWUgPSAiIgogICAgaWYgbGFiZWxfY29sdW1uIGlzIG5vdCBOb25lIGFuZCBwcm9ibGVtX3R5cGUgPT0gImNsYXNzaWZpY2F0aW9uIjoKICAgICAgICBhbGxfbGFiZWxzID0gZGZbbGFiZWxfY29sdW1uXS51bmlxdWUoKQogICAgdmlzaWJsZSA9IFRydWUKICAgIGZvciAoY29sdW1uTmFtZSwgXykgaW4gZGYuaXRlcml0ZW1zKCk6CiAgICAgICAgaWYgY29sdW1uTmFtZSA9PSBsYWJlbF9jb2x1bW46CiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIGlmIGxhYmVsX2NvbHVtbiBpcyBub3QgTm9uZSBhbmQgcHJvYmxlbV90eXBlID09ICJjbGFzc2lmaWNhdGlvbiI6CiAgICAgICAgICAgIGZvciBsYWJlbCBpbiBhbGxfbGFiZWxzOgogICAgICAgICAgICAgICAgc3ViX2ZpZyA9IGdvLkhpc3RvZ3JhbSgKICAgICAgICAgICAgICAgICAgICBoaXN0ZnVuYz0iY291bnQiLAogICAgICAgICAgICAgICAgICAgIHg9ZGYubG9jW2RmW2xhYmVsX2NvbHVtbl0gPT0gbGFiZWxdW2NvbHVtbk5hbWVdLAogICAgICAgICAgICAgICAgICAgIG5hbWU9c3RyKGxhYmVsKSwKICAgICAgICAgICAgICAgICAgICB2aXNpYmxlPXZpc2libGUsCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBmaWdzW2Yie2NvbHVtbk5hbWV9QD9Ae2xhYmVsfSJdID0gc3ViX2ZpZwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN1Yl9maWcgPSBnby5IaXN0b2dyYW0oaGlzdGZ1bmM9ImNvdW50IiwgeD1kZltjb2x1bW5OYW1lXSwgdmlzaWJsZT12aXNpYmxlKQogICAgICAgICAgICBmaWdzW2Yie2NvbHVtbk5hbWV9QD9AezF9Il0gPSBzdWJfZmlnCiAgICAgICAgaWYgdmlzaWJsZToKICAgICAgICAgICAgZmlyc3RfZmVhdHVyZV9uYW1lID0gY29sdW1uTmFtZQogICAgICAgIHZpc2libGUgPSBGYWxzZQoKICAgIGZpZyA9IGdvLkZpZ3VyZSgpCiAgICBmb3IgayBpbiBmaWdzLmtleXMoKToKICAgICAgICBmaWcuYWRkX3RyYWNlKGZpZ3Nba10pCgogICAgZmlnLnVwZGF0ZV9sYXlvdXQoCiAgICAgICAgdXBkYXRlbWVudXM9WwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiYnV0dG9ucyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJsYWJlbCI6IGNvbHVtbl9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAibWV0aG9kIjogInVwZGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJhcmdzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkuc3BsaXQoIkA/QCIpWzBdID09IGNvbHVtbl9uYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBrZXkgaW4gZmlncy5rZXlzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyJ0aXRsZSI6IGYiPGk+PGI+SGlzdG9ncmFtIG9mIHtjb2x1bW5fbmFtZX08L2I+PC9pPiJ9LAogICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBmb3IgY29sdW1uX25hbWUgaW4gZGYuY29sdW1ucwogICAgICAgICAgICAgICAgICAgIGlmIGNvbHVtbl9uYW1lICE9IGxhYmVsX2NvbHVtbgogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICJkaXJlY3Rpb24iOiAiZG93biIsCiAgICAgICAgICAgICAgICAicGFkIjogeyJyIjogMTAsICJ0IjogMTB9LAogICAgICAgICAgICAgICAgInNob3dhY3RpdmUiOiBUcnVlLAogICAgICAgICAgICAgICAgIngiOiAwLjI1LAogICAgICAgICAgICAgICAgInhhbmNob3IiOiAibGVmdCIsCiAgICAgICAgICAgICAgICAieSI6IDEuMSwKICAgICAgICAgICAgICAgICJ5YW5jaG9yIjogInRvcCIsCiAgICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIGFubm90YXRpb25zPVsKICAgICAgICAgICAgZGljdCgKICAgICAgICAgICAgICAgIHRleHQ9IlNlbGVjdCBGZWF0dXJlIE5hbWUgIiwKICAgICAgICAgICAgICAgIHNob3dhcnJvdz1GYWxzZSwKICAgICAgICAgICAgICAgIHg9MCwKICAgICAgICAgICAgICAgIHk9MS4wNSwKICAgICAgICAgICAgICAgIHlyZWY9InBhcGVyIiwKICAgICAgICAgICAgICAgIHhyZWY9InBhcGVyIiwKICAgICAgICAgICAgICAgIGFsaWduPSJsZWZ0IiwKICAgICAgICAgICAgICAgIHhhbmNob3I9ImxlZnQiLAogICAgICAgICAgICAgICAgeWFuY2hvcj0idG9wIiwKICAgICAgICAgICAgICAgIGZvbnQ9ewogICAgICAgICAgICAgICAgICAgICJjb2xvciI6ICJibHVlIiwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICkKICAgICAgICBdLAogICAgKQoKICAgIGZpZy51cGRhdGVfbGF5b3V0KAogICAgICAgIHdpZHRoPTYwMCwKICAgICAgICBoZWlnaHQ9NDAwLAogICAgICAgIGF1dG9zaXplPUZhbHNlLAogICAgICAgIG1hcmdpbj1kaWN0KHQ9MTAwLCBiPTAsIGw9MCwgcj0wKSwKICAgICAgICB0ZW1wbGF0ZT0icGxvdGx5X3doaXRlIiwKICAgICkKCiAgICBmaWcudXBkYXRlX2xheW91dCh0aXRsZV90ZXh0PWYiPGk+PGI+SGlzdG9ncmFtcyBvZiB7Zmlyc3RfZmVhdHVyZV9uYW1lfTwvYj48L2k+IikKICAgIGV4dHJhX2RhdGFbZiJoaXN0b2dyYW1zIl0gPSBjb250ZXh0LmxvZ19hcnRpZmFjdCgKICAgICAgICBQbG90bHlBcnRpZmFjdChrZXk9ZiJoaXN0b2dyYW1zIiwgZmlndXJlPWZpZyksCiAgICAgICAgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS9oaXN0b2dyYW1zLmh0bWwiLAogICAgKQoKCmRlZiBfY3JlYXRlX2ZlYXR1cmVzXzJkX3NjYXR0ZXJfYXJ0aWZhY3RzKAogICAgICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgICAgIGRmOiBwZC5EYXRhRnJhbWUsCiAgICAgICAgZXh0cmFfZGF0YTogZGljdCwKICAgICAgICBsYWJlbF9jb2x1bW46IHN0ciwKICAgICAgICBwbG90c19kZXN0OiBzdHIsCiAgICAgICAgcHJvYmxlbV90eXBlOiBzdHIsCik6CiAgICAiIiIKICAgIENyZWF0ZSBhbmQgbG9nIGEgc2NhdHRlci0yZCBhcnRpZmFjdCBmb3IgZWFjaCBjb3VwbGUgb2YgZmVhdHVyZXMKICAgICIiIgogICAgZmVhdHVyZXMgPSBbCiAgICAgICAgY29sdW1uTmFtZSBmb3IgKGNvbHVtbk5hbWUsIF8pIGluIGRmLml0ZXJpdGVtcygpIGlmIGNvbHVtbk5hbWUgIT0gbGFiZWxfY29sdW1uCiAgICBdCiAgICBtYXhfZmVhdHVyZV9sZW4gPSBmbG9hdChtYXgobGVuKGVsZW0pIGZvciBlbGVtIGluIGZlYXR1cmVzKSkKICAgIGlmIGxhYmVsX2NvbHVtbiBpcyBub3QgTm9uZToKICAgICAgICBsYWJlbHMgPSBzb3J0ZWQoZGZbbGFiZWxfY29sdW1uXS51bmlxdWUoKSkKICAgIGVsc2U6CiAgICAgICAgbGFiZWxzID0gW05vbmVdCiAgICBmaWcgPSBnby5GaWd1cmUoKQogICAgaWYgbGFiZWxfY29sdW1uIGlzIG5vdCBOb25lIGFuZCBwcm9ibGVtX3R5cGUgPT0gImNsYXNzaWZpY2F0aW9uIjoKICAgICAgICBmb3IgbCBpbiBsYWJlbHM6CiAgICAgICAgICAgIGZpZy5hZGRfdHJhY2UoCiAgICAgICAgICAgICAgICBnby5TY2F0dGVyKAogICAgICAgICAgICAgICAgICAgIHg9ZGYubG9jW2RmW2xhYmVsX2NvbHVtbl0gPT0gbF1bZmVhdHVyZXNbMF1dLAogICAgICAgICAgICAgICAgICAgIHk9ZGYubG9jW2RmW2xhYmVsX2NvbHVtbl0gPT0gbF1bZmVhdHVyZXNbMF1dLAogICAgICAgICAgICAgICAgICAgIG1vZGU9Im1hcmtlcnMiLAogICAgICAgICAgICAgICAgICAgIHZpc2libGU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzaG93bGVnZW5kPVRydWUsCiAgICAgICAgICAgICAgICAgICAgbmFtZT1zdHIobCksCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgIGVsaWYgbGFiZWxfY29sdW1uIGlzIE5vbmU6CiAgICAgICAgZmlnLmFkZF90cmFjZSgKICAgICAgICAgICAgZ28uU2NhdHRlcigKICAgICAgICAgICAgICAgIHg9ZGZbZmVhdHVyZXNbMF1dLAogICAgICAgICAgICAgICAgeT1kZltmZWF0dXJlc1swXV0sCiAgICAgICAgICAgICAgICBtb2RlPSJtYXJrZXJzIiwKICAgICAgICAgICAgICAgIHZpc2libGU9VHJ1ZSwKICAgICAgICAgICAgKQogICAgICAgICkKICAgIGVsaWYgcHJvYmxlbV90eXBlID09ICJyZWdyZXNzaW9uIjoKICAgICAgICBmaWcuYWRkX3RyYWNlKAogICAgICAgICAgICBnby5TY2F0dGVyKAogICAgICAgICAgICAgICAgeD1kZltmZWF0dXJlc1swXV0sCiAgICAgICAgICAgICAgICB5PWRmW2ZlYXR1cmVzWzBdXSwKICAgICAgICAgICAgICAgIG1vZGU9Im1hcmtlcnMiLAogICAgICAgICAgICAgICAgbWFya2VyPWRpY3QoCiAgICAgICAgICAgICAgICAgICAgY29sb3I9ZGZbbGFiZWxfY29sdW1uXSwgY29sb3JzY2FsZT0iVmlyaWRpcyIsIHNob3dzY2FsZT1UcnVlCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgdmlzaWJsZT1UcnVlLAogICAgICAgICAgICApCiAgICAgICAgKQoKICAgIHhfYnV0dG9ucyA9IFtdCiAgICB5X2J1dHRvbnMgPSBbXQoKICAgIGZvciBuY29sIGluIGZlYXR1cmVzOgogICAgICAgIGlmIHByb2JsZW1fdHlwZSA9PSAiY2xhc3NpZmljYXRpb24iIGFuZCBsYWJlbF9jb2x1bW4gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHhfYnV0dG9ucy5hcHBlbmQoCiAgICAgICAgICAgICAgICBkaWN0KAogICAgICAgICAgICAgICAgICAgIG1ldGhvZD0idXBkYXRlIiwKICAgICAgICAgICAgICAgICAgICBsYWJlbD1uY29sLAogICAgICAgICAgICAgICAgICAgIGFyZ3M9WwogICAgICAgICAgICAgICAgICAgICAgICB7IngiOiBbZGYubG9jW2RmW2xhYmVsX2NvbHVtbl0gPT0gbF1bbmNvbF0gZm9yIGwgaW4gbGFiZWxzXX0sCiAgICAgICAgICAgICAgICAgICAgICAgIG5wLmFyYW5nZShsZW4obGFiZWxzKSkudG9saXN0KCksCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICAgICAgeV9idXR0b25zLmFwcGVuZCgKICAgICAgICAgICAgICAgIGRpY3QoCiAgICAgICAgICAgICAgICAgICAgbWV0aG9kPSJ1cGRhdGUiLAogICAgICAgICAgICAgICAgICAgIGxhYmVsPW5jb2wsCiAgICAgICAgICAgICAgICAgICAgYXJncz1bCiAgICAgICAgICAgICAgICAgICAgICAgIHsieSI6IFtkZi5sb2NbZGZbbGFiZWxfY29sdW1uXSA9PSBsXVtuY29sXSBmb3IgbCBpbiBsYWJlbHNdfSwKICAgICAgICAgICAgICAgICAgICAgICAgbnAuYXJhbmdlKGxlbihsYWJlbHMpKS50b2xpc3QoKSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgeF9idXR0b25zLmFwcGVuZCgKICAgICAgICAgICAgICAgIGRpY3QobWV0aG9kPSJ1cGRhdGUiLCBsYWJlbD1uY29sLCBhcmdzPVt7IngiOiBbZGZbbmNvbF1dfV0pCiAgICAgICAgICAgICkKCiAgICAgICAgICAgIHlfYnV0dG9ucy5hcHBlbmQoCiAgICAgICAgICAgICAgICBkaWN0KG1ldGhvZD0idXBkYXRlIiwgbGFiZWw9bmNvbCwgYXJncz1beyJ5IjogW2RmW25jb2xdXX1dKQogICAgICAgICAgICApCgogICAgIyBQYXNzIGJ1dHRvbnMgdG8gdGhlIHVwZGF0ZW1lbnVzIGFyZ3VtZW50CiAgICBmaWcudXBkYXRlX2xheW91dCgKICAgICAgICB1cGRhdGVtZW51cz1bCiAgICAgICAgICAgIGRpY3QoYnV0dG9ucz14X2J1dHRvbnMsIGRpcmVjdGlvbj0idXAiLCB4PTAuNSwgeT0tMC4xKSwKICAgICAgICAgICAgZGljdChidXR0b25zPXlfYnV0dG9ucywgZGlyZWN0aW9uPSJkb3duIiwgeD0tbWF4X2ZlYXR1cmVfbGVuIC8gMTAwLCB5PTAuNSksCiAgICAgICAgXQogICAgKQoKICAgIGZpZy51cGRhdGVfbGF5b3V0KAogICAgICAgIHdpZHRoPTYwMCwKICAgICAgICBoZWlnaHQ9NDAwLAogICAgICAgIGF1dG9zaXplPUZhbHNlLAogICAgICAgIG1hcmdpbj1kaWN0KHQ9MTAwLCBiPTAsIGw9MCwgcj0wKSwKICAgICAgICB0ZW1wbGF0ZT0icGxvdGx5X3doaXRlIiwKICAgICkKCiAgICBmaWcudXBkYXRlX2xheW91dCh0aXRsZV90ZXh0PWYiPGk+PGI+U2NhdHRlci0yZDwvYj48L2k+IikKICAgIGV4dHJhX2RhdGFbZiJzY2F0dGVyLTJkIl0gPSBjb250ZXh0LmxvZ19hcnRpZmFjdCgKICAgICAgICBQbG90bHlBcnRpZmFjdChrZXk9ZiJzY2F0dGVyLTJkIiwgZmlndXJlPWZpZyksCiAgICAgICAgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS9zY2F0dGVyLTJkLmh0bWwiLAogICAgKQoKCmRlZiBfY3JlYXRlX3Zpb2xpbl9hcnRpZmFjdCgKICAgICAgICBjb250ZXh0OiBNTENsaWVudEN0eCwgZGY6IHBkLkRhdGFGcmFtZSwgZXh0cmFfZGF0YTogZGljdCwgcGxvdHNfZGVzdDogc3RyCik6CiAgICAiIiIKICAgIENyZWF0ZSBhbmQgbG9nIGEgdmlvbGluIGFydGlmYWN0CiAgICAiIiIKICAgIGNvbHMgPSA1CiAgICByb3dzID0gKGRmLnNoYXBlWzFdIC8vIGNvbHMpICsgMQogICAgZmlnID0gbWFrZV9zdWJwbG90cyhyb3dzPXJvd3MsIGNvbHM9Y29scykKCiAgICBwbG90X251bSA9IDAKCiAgICBmb3IgKGNvbHVtbk5hbWUsIGNvbHVtbkRhdGEpIGluIGRmLml0ZXJpdGVtcygpOgogICAgICAgIHZpb2xpbiA9IGdvLlZpb2xpbigKICAgICAgICAgICAgeD1bY29sdW1uTmFtZV0gKiBjb2x1bW5EYXRhLnNoYXBlWzBdLAogICAgICAgICAgICB5PWNvbHVtbkRhdGEsCiAgICAgICAgICAgIG5hbWU9Y29sdW1uTmFtZSwKICAgICAgICApCgogICAgICAgIGZpZy5hZGRfdHJhY2UoCiAgICAgICAgICAgIHZpb2xpbiwKICAgICAgICAgICAgcm93PShwbG90X251bSAvLyBjb2xzKSArIDEsCiAgICAgICAgICAgIGNvbD0ocGxvdF9udW0gJSBjb2xzKSArIDEsCiAgICAgICAgKQoKICAgICAgICBwbG90X251bSArPSAxCgogICAgZmlnWyJsYXlvdXQiXS51cGRhdGUoCiAgICAgICAgaGVpZ2h0PShyb3dzICsgMSkgKiAyMDAsCiAgICAgICAgd2lkdGg9KGNvbHMgKyAxKSAqIDIwMCwKICAgICAgICB0aXRsZT0iPGk+PGI+VmlvbGluIFBsb3RzPC9iPjwvaT4iLAogICAgKQoKICAgIGZpZy51cGRhdGVfbGF5b3V0KHNob3dsZWdlbmQ9RmFsc2UpCiAgICBleHRyYV9kYXRhWyJ2aW9saW4iXSA9IGNvbnRleHQubG9nX2FydGlmYWN0KAogICAgICAgIFBsb3RseUFydGlmYWN0KGtleT0idmlvbGluIiwgZmlndXJlPWZpZyksCiAgICAgICAgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS92aW9saW4uaHRtbCIsCiAgICApCgoKZGVmIF9jcmVhdGVfaW1iYWxhbmNlX2FydGlmYWN0KAogICAgICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgICAgIGRmOiBwZC5EYXRhRnJhbWUsCiAgICAgICAgZXh0cmFfZGF0YTogZGljdCwKICAgICAgICBsYWJlbF9jb2x1bW46IHN0ciwKICAgICAgICBwbG90c19kZXN0OiBzdHIsCiAgICAgICAgcHJvYmxlbV90eXBlOiBzdHIsCik6CiAgICAiIiIKICAgIENyZWF0ZSBhbmQgbG9nIGFuIGltYmFsYW5jZSBjbGFzcyBhcnRpZmFjdCAoY3N2ICsgcGxvdCkKICAgICIiIgogICAgaWYgbGFiZWxfY29sdW1uOgogICAgICAgIGlmIHByb2JsZW1fdHlwZSA9PSAiY2xhc3NpZmljYXRpb24iOgogICAgICAgICAgICBsYWJlbHNfY291bnQgPSBkZltsYWJlbF9jb2x1bW5dLnZhbHVlX2NvdW50cygpLnNvcnRfaW5kZXgoKQogICAgICAgICAgICBkZl9sYWJlbHNfY291bnQgPSBwZC5EYXRhRnJhbWUobGFiZWxzX2NvdW50KQogICAgICAgICAgICBkZl9sYWJlbHNfY291bnQucmVuYW1lKGNvbHVtbnM9e2xhYmVsX2NvbHVtbjogIlRvdGFsIn0sIGlucGxhY2U9VHJ1ZSkKICAgICAgICAgICAgZGZfbGFiZWxzX2NvdW50W2xhYmVsX2NvbHVtbl0gPSBsYWJlbHNfY291bnQuaW5kZXgKICAgICAgICAgICAgZGZfbGFiZWxzX2NvdW50WyJ3ZWlnaHRzIl0gPSBkZl9sYWJlbHNfY291bnRbIlRvdGFsIl0gLyBzdW0oCiAgICAgICAgICAgICAgICBkZl9sYWJlbHNfY291bnRbIlRvdGFsIl0KICAgICAgICAgICAgKQoKICAgICAgICAgICAgZmlnID0gcHgucGllKGRmX2xhYmVsc19jb3VudCwgbmFtZXM9bGFiZWxfY29sdW1uLCB2YWx1ZXM9IlRvdGFsIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBmaWcgPSBweC5oaXN0b2dyYW0oCiAgICAgICAgICAgICAgICBoaXN0ZnVuYz0iY291bnQiLAogICAgICAgICAgICAgICAgeD1kZltsYWJlbF9jb2x1bW5dLAogICAgICAgICAgICApCiAgICAgICAgICAgIGhpc3QgPSBucC5oaXN0b2dyYW0oZGZbbGFiZWxfY29sdW1uXSkKICAgICAgICAgICAgZGZfbGFiZWxzX2NvdW50ID0gcGQuRGF0YUZyYW1lKAogICAgICAgICAgICAgICAgeyJtaW5fdmFsIjogaGlzdFsxXSwgImNvdW50IjogaGlzdFswXS50b2xpc3QoKSArIFswXX0KICAgICAgICAgICAgKQogICAgICAgIGZpZy51cGRhdGVfbGF5b3V0KHRpdGxlX3RleHQ9IjxpPjxiPkxhYmVscyBJbWJhbGFuY2U8L2I+PC9pPiIpCiAgICAgICAgZXh0cmFfZGF0YVsiaW1iYWxhbmNlIl0gPSBjb250ZXh0LmxvZ19hcnRpZmFjdCgKICAgICAgICAgICAgUGxvdGx5QXJ0aWZhY3Qoa2V5PSJpbWJhbGFuY2UiLCBmaWd1cmU9ZmlnKSwKICAgICAgICAgICAgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS9pbWJhbGFuY2UuaHRtbCIsCiAgICAgICAgKQogICAgICAgIGV4dHJhX2RhdGFbImltYmFsYW5jZS1jc3YiXSA9IGNvbnRleHQubG9nX2FydGlmYWN0KAogICAgICAgICAgICBUYWJsZUFydGlmYWN0KCJpbWJhbGFuY2Utd2VpZ2h0cy12ZWMiLCBkZj1kZl9sYWJlbHNfY291bnQpLAogICAgICAgICAgICBsb2NhbF9wYXRoPWYie3Bsb3RzX2Rlc3R9L2ltYmFsYW5jZS13ZWlnaHRzLXZlYy5jc3YiLAogICAgICAgICkKCgpkZWYgX2NyZWF0ZV9jb3JyX2FydGlmYWN0KAogICAgICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgICAgIGRmOiBwZC5EYXRhRnJhbWUsCiAgICAgICAgZXh0cmFfZGF0YTogZGljdCwKICAgICAgICBsYWJlbF9jb2x1bW46IHN0ciwKICAgICAgICBwbG90c19kZXN0OiBzdHIsCik6CiAgICAiIiIKICAgIENyZWF0ZSBhbmQgbG9nIGFuIGNvcnJlbGF0aW9uLW1hdHJpeCBhcnRpZmFjdCAoY3N2ICsgcGxvdCkKICAgICIiIgogICAgaWYgbGFiZWxfY29sdW1uIGlzIG5vdCBOb25lOgogICAgICAgIGRmID0gZGYuZHJvcChbbGFiZWxfY29sdW1uXSwgYXhpcz0xKQogICAgdGJsY29yciA9IGRmLmNvcnIoKQogICAgZXh0cmFfZGF0YVsiY29ycmVsYXRpb24tbWF0cml4LWNzdiJdID0gY29udGV4dC5sb2dfYXJ0aWZhY3QoCiAgICAgICAgVGFibGVBcnRpZmFjdCgiY29ycmVsYXRpb24tbWF0cml4LWNzdiIsIGRmPXRibGNvcnIsIHZpc2libGU9VHJ1ZSksCiAgICAgICAgbG9jYWxfcGF0aD1mIntwbG90c19kZXN0fS9jb3JyZWxhdGlvbi1tYXRyaXguY3N2IiwKICAgICkKCiAgICB6ID0gdGJsY29yci52YWx1ZXMudG9saXN0KCkKICAgIHpfdGV4dCA9IFtbIns6LjJmfSIuZm9ybWF0KHkpIGZvciB5IGluIHhdIGZvciB4IGluIHpdCiAgICBmaWcgPSBmZi5jcmVhdGVfYW5ub3RhdGVkX2hlYXRtYXAoCiAgICAgICAgeiwKICAgICAgICB4PWxpc3QodGJsY29yci5jb2x1bW5zKSwKICAgICAgICB5PWxpc3QodGJsY29yci5jb2x1bW5zKSwKICAgICAgICBhbm5vdGF0aW9uX3RleHQ9el90ZXh0LAogICAgICAgIGNvbG9yc2NhbGU9ImFnc3Vuc2V0IiwKICAgICkKICAgIGZpZ1sibGF5b3V0Il1bInlheGlzIl1bImF1dG9yYW5nZSJdID0gInJldmVyc2VkIiAgIyBsIC0+IHIKICAgIGZpZy51cGRhdGVfbGF5b3V0KHRpdGxlX3RleHQ9IjxpPjxiPkNvcnJlbGF0aW9uIG1hdHJpeDwvYj48L2k+IikKICAgIGZpZ1siZGF0YSJdWzBdWyJzaG93c2NhbGUiXSA9IFRydWUKCiAgICBleHRyYV9kYXRhWyJjb3JyZWxhdGlvbiJdID0gY29udGV4dC5sb2dfYXJ0aWZhY3QoCiAgICAgICAgUGxvdGx5QXJ0aWZhY3Qoa2V5PSJjb3JyZWxhdGlvbiIsIGZpZ3VyZT1maWcpLAogICAgICAgIGxvY2FsX3BhdGg9ZiJ7cGxvdHNfZGVzdH0vY29ycmVsYXRpb24uaHRtbCIsCiAgICApCg==
    commands: []
    code_origin: https://github.com/davesh0812/functions.git#fecfc5f69fff433d02213840720ac7e7046255c4:/Users/davids/Projects/functions/describe/describe.py
    origin_filename: /Users/davids/Projects/functions/describe/describe.py
  entry_points:
    analyze:
      name: analyze
      doc: 'The function will output the following artifacts per

        column within the data frame (based on data types)

        If the data has more than 500,000 sample we

        sample randomly 500,000 samples:


        describe csv

        histograms

        scatter-2d

        violin chart

        correlation-matrix chart

        correlation-matrix csv

        imbalance pie chart

        imbalance-weights-vec csv'
      parameters:
      - name: context
        type: MLClientCtx
        doc: The function context
        default: ''
      - name: name
        type: str
        doc: Key of dataset to database ("dataset" for default)
        default: dataset
      - name: table
        type: Union[FeatureSet, DataItem]
        doc: MLRun input pointing to pandas dataframe (csv/parquet file path) or FeatureSet
          as param
        default: null
      - name: label_column
        type: str
        doc: Ground truth column label
        default: null
      - name: plots_dest
        type: str
        doc: Destination folder of summary plots (relative to artifact_path) ("plots"
          for default)
        default: plots
      - name: random_state
        type: int
        doc: When the table has more than 500,000 samples, we sample randomly 500,000
          samples
        default: 1
      - name: problem_type
        type: str
        default: classification
      - name: dask_key
        type: str
        doc: Key of dataframe in dask client "datasets" attribute
        default: dask_key
      - name: dask_function
        type: str
        doc: Dask function url (db://..)
        default: null
      - name: dask_client
        doc: Dask client object
        default: null
      outputs:
      - default: ''
      lineno: 42
  description: describe and visualizes dataset stats
  default_handler: analyze
  disable_auto_mount: false
  env: []
  priority_class_name: ''
  preemption_mode: prevent
  affinity: null
  tolerations: null
verbose: false

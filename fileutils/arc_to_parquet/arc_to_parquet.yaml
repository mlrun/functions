kind: job
metadata:
  name: arc-to-parquet
  tag: ''
  hash: c0e13d89c6e78a46c42fea8b96e7a4604bc51ba1
  project: ''
spec:
  command: ''
  args: []
  volumes: []
  volume_mounts: []
  env: []
  description: ''
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAxOCBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQojIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiMgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiMgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAojIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKaW1wb3J0IHNzbAoKdHJ5OgogICAgX2NyZWF0ZV91bnZlcmlmaWVkX2h0dHBzX2NvbnRleHQgPSBzc2wuX2NyZWF0ZV91bnZlcmlmaWVkX2NvbnRleHQKZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgIyBMZWdhY3kgUHl0aG9uIHRoYXQgZG9lc24ndCB2ZXJpZnkgSFRUUFMgY2VydGlmaWNhdGVzIGJ5IGRlZmF1bHQKICAgIHBhc3MKZWxzZToKICAgICMgSGFuZGxlIHRhcmdldCBlbnZpcm9ubWVudCB0aGF0IGRvZXNuJ3Qgc3VwcG9ydCBIVFRQUyB2ZXJpZmljYXRpb24KICAgIHNzbC5fY3JlYXRlX2RlZmF1bHRfaHR0cHNfY29udGV4dCA9IF9jcmVhdGVfdW52ZXJpZmllZF9odHRwc19jb250ZXh0CgppbXBvcnQgb3MKaW1wb3J0IGpzb24KZnJvbSBwYXRobGliIGltcG9ydCBQYXRoCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IHB5YXJyb3cucGFycXVldCBhcyBwcQppbXBvcnQgcHlhcnJvdyBhcyBwYQpmcm9tIHBpY2tsZSBpbXBvcnQgZHVtcCwgbG9hZAoKZnJvbSBtbHJ1bi5leGVjdXRpb24gaW1wb3J0IE1MQ2xpZW50Q3R4CmZyb20gdHlwaW5nIGltcG9ydCBJTywgQW55U3RyLCBVbmlvbiwgTGlzdCwgT3B0aW9uYWwKCgpkZWYgYXJjX3RvX3BhcnF1ZXQoCiAgICBjb250ZXh0OiBNTENsaWVudEN0eCwKICAgIGFyY2hpdmVfdXJsOiBVbmlvbltzdHIsIFBhdGgsIElPW0FueVN0cl1dLAogICAgaGVhZGVyOiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgIHRhcmdldF9wYXRoOiBzdHIgPSAiIiwKICAgIG5hbWU6IHN0ciA9ICIiLAogICAgY2h1bmtzaXplOiBpbnQgPSAxMF8wMDAsCiAgICBsb2dfZGF0YTogYm9vbCA9IFRydWUsCiAgICBhZGRfdWlkOiBib29sID0gRmFsc2UsCiAgICBrZXk6IHN0ciA9ICJyYXdfZGF0YSIsCikgLT4gTm9uZToKICAgICIiIk9wZW4gYSBmaWxlL29iamVjdCBhcmNoaXZlIGFuZCBzYXZlIGFzIGEgcGFycXVldCBmaWxlLgogICAgCiAgICA6cGFyYW0gY29udGV4dDogICAgIGZ1bmN0aW9uIGNvbnRleHQKICAgIDpwYXJhbSBhcmNoaXZlX3VybDogYW55IHZhbGlkIHN0cmluZyBwYXRoIGNvbnNpc3RlbnQgd2l0aCB0aGUgcGF0aCB2YXJpYWJsZQogICAgICAgICAgICAgICAgICAgICAgICBvZiBwYW5kYXMucmVhZF9jc3YsIGluY2x1ZGluZyBzdHJpbmdzIGFzIGZpbGUgcGF0aHMsIGFzIHVybHMsIAogICAgICAgICAgICAgICAgICAgICAgICBwYXRobGliLlBhdGggb2JqZWN0cywgZXRjLi4uCiAgICA6cGFyYW0gaGVhZGVyOiAgICAgIGNvbHVtbiBuYW1lcwogICAgOnBhcmFtIHRhcmdldF9wYXRoOiBkZXN0aW5hdGlvbiBmb2xkZXIgb2YgdGFibGUKICAgIDpwYXJhbSBuYW1lOiAgICAgICAgbmFtZSBmaWxlIHRvIGJlIHNhdmVkIGxvY2FsbHksIGFsc28KICAgIDpwYXJhbSBjaHVua3NpemU6ICAgKDApIHJvdyBzaXplIHJldHJpZXZlZCBwZXIgaXRlcmF0aW9uCiAgICA6cGFyYW0ga2V5OiAgICAgICAgIGtleSBpbiBhcnRpZmFjdCBzdG9yZSAod2hlbiBsb2dfZGF0YT1UcnVlKQogICAgIiIiCiAgICBpZiBub3QgbmFtZS5lbmRzd2l0aCgiLnBxdCIpOgogICAgICAgIG5hbWUgKz0gIi5wcXQiCgogICAgZGVzdF9wYXRoID0gb3MucGF0aC5qb2luKHRhcmdldF9wYXRoLCBuYW1lKQogICAgb3MubWFrZWRpcnMob3MucGF0aC5qb2luKHRhcmdldF9wYXRoKSwgZXhpc3Rfb2s9VHJ1ZSkKICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShkZXN0X3BhdGgpOgogICAgICAgIGNvbnRleHQubG9nZ2VyLmluZm8oImRlc3RpbmF0aW9uIGZpbGUgZG9lcyBub3QgZXhpc3QsIGRvd25sb2FkaW5nIikKICAgICAgICBwcXdyaXRlciA9IE5vbmUKICAgICAgICBmb3IgaSwgZGYgaW4gZW51bWVyYXRlKHBkLnJlYWRfY3N2KGFyY2hpdmVfdXJsLCBjaHVua3NpemU9Y2h1bmtzaXplLCBuYW1lcz1oZWFkZXIpKToKICAgICAgICAgICAgdGFibGUgPSBwYS5UYWJsZS5mcm9tX3BhbmRhcyhkZikKICAgICAgICAgICAgaWYgaSA9PSAwOgogICAgICAgICAgICAgICAgcHF3cml0ZXIgPSBwcS5QYXJxdWV0V3JpdGVyKGRlc3RfcGF0aCwgdGFibGUuc2NoZW1hKQogICAgICAgICAgICBwcXdyaXRlci53cml0ZV90YWJsZSh0YWJsZSkKCiAgICAgICAgaWYgcHF3cml0ZXI6CiAgICAgICAgICAgIHBxd3JpdGVyLmNsb3NlKCkKCiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbyhmInNhdmVkIHRhYmxlIHRvIHtkZXN0X3BhdGh9IikKICAgIGVsc2U6CiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygiZGVzdGluYXRpb24gZmlsZSBhbHJlYWR5IGV4aXN0cyIpCgogICAgY29udGV4dC5sb2dfYXJ0aWZhY3Qoa2V5LCB0YXJnZXRfcGF0aD1kZXN0X3BhdGgpCiAgICAjIGxvZyBoZWFkZXIKICAgIGZpbGVwYXRoID0gb3MucGF0aC5qb2luKHRhcmdldF9wYXRoLCAnaGVhZGVyLnBrbCcpCiAgICBkdW1wKGhlYWRlciwgb3BlbihmaWxlcGF0aCwgJ3diJykpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdCgnaGVhZGVyJywgdGFyZ2V0X3BhdGg9ZmlsZXBhdGgpCg==
    base_image: yjbds/mlrun-files:latest
    commands: []
    code_origin: https://github.com/yjb-ds/functions.git#9f080fed89f32412dcebe59bb1d248921aa8aad2:/User/repos/functions/fileutils/arc_to_parquet/arc_to_parquet.py

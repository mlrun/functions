kind: job
metadata:
  name: question-answering
  tag: ''
  hash: 4527a4e8bea9b95ba1ef8ff29de861dfbc60500a
  project: ''
  labels:
    author: yonish
  categories:
  - machine-learning
  - GenAI
spec:
  command: ''
  args: []
  image: ''
  build:
    functionSourceCode: IyBDb3B5cmlnaHQgMjAxOSBJZ3VhemlvCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKIyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiMgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiMKIyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiMgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKIyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KIyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiMgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiMKaW1wb3J0IHBhdGhsaWIKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIFR1cGxlLCBVbmlvbgoKaW1wb3J0IG1scnVuCmltcG9ydCBwYW5kYXMgYXMgcGQKaW1wb3J0IHRyYW5zZm9ybWVycwpmcm9tIHRxZG0uYXV0byBpbXBvcnQgdHFkbQoKCmRlZiBfZ2V0X3Byb21wdF90ZW1wbGF0ZSgKICAgIHRleHRfd3JhcHBlcjogc3RyLAogICAgcXVlc3Rpb25zX3dyYXBwZXI6IHN0ciwKICAgIHF1ZXN0aW9uczogTGlzdFtzdHJdLAogICAgYW5zd2VyX3ByZWFtYmxlOiBzdHIsCikgLT4gVHVwbGVbc3RyLCBzdHJdOgogICAgIyBWYWxpZGF0ZSBhbmQgYnVpbGQgdGhlIHRleHQgd3JhcHBlcjoKICAgIHRleHRfd3JhcHBlciA9IHRleHRfd3JhcHBlciBvciAoCiAgICAgICAgIkdpdmVuIHRoZSBmb2xsb3dpbmcgdGV4dDpcbiIgIi0tLS0tXG4iICJ7fVxuIiAiLS0tLS0iCiAgICApCiAgICBpZiB0ZXh0X3dyYXBwZXIuY291bnQoInt9IikgIT0gMToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAiVGhlIGB0ZXh0X3dyYXBwZXJgIG11c3QgaW5jbHVkZSBvbmUgcGxhY2Vob2xkZXIgJ3t9JyBmb3IgdGhlIHRleHQuIgogICAgICAgICkKCiAgICAjIFZhbGlkYXRlIGFuZCBidWlsZCB0aGUgcXVlc3Rpb24gd3JhcHBlcjoKICAgIHF1ZXN0aW9uc193cmFwcGVyID0gcXVlc3Rpb25zX3dyYXBwZXIgb3IgIkFuc3dlciB0aGUgcXVlc3Rpb25zOlxuIiAie30iCiAgICBpZiBxdWVzdGlvbnNfd3JhcHBlci5jb3VudCgie30iKSAhPSAxOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICJUaGUgYHF1ZXN0aW9uc193cmFwcGVyYCBtdXN0IGluY2x1ZGUgb25lIHBsYWNlaG9sZGVyICd7fScgZm9yIHRoZSB0ZXh0LiIKICAgICAgICApCgogICAgIyBWYWxpZGF0ZSBhbmQgcGFyc2UgdGhlIHF1ZXN0aW9uczoKICAgIGlmIGxlbihxdWVzdGlvbnMpID09IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiUGxlYXNlIGluY2x1ZGUgYXQgbGVhc3Qgb25lIHF1ZXN0aW9uLiIpCiAgICBxdWVzdGlvbnMgPSAiXG4iLmpvaW4oCiAgICAgICAgW2Yie2l9LiB7cXVlc3Rpb259IiBmb3IgaSwgcXVlc3Rpb24gaW4gZW51bWVyYXRlKHF1ZXN0aW9ucywgMSldCiAgICApCgogICAgIyBWYWxpZGF0ZSBhbmQgYnVpbGQgdGhlIGFuc3dlciB3cmFwcGVyOgogICAgYW5zd2VyX3ByZWFtYmxlID0gYW5zd2VyX3ByZWFtYmxlIG9yICJBbnN3ZXI6IgogICAgaWYgYW5zd2VyX3ByZWFtYmxlLmNvdW50KCJ7fSIpICE9IDA6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiVGhlIGBhbnN3ZXJfcHJlYW1ibGVgIG11c3Qgbm90IGhhdmUgYSBwbGFjZWhvbGRlciAne30nLiIpCgogICAgIyBDb25zdHJ1Y3QgdGhlIHRlbXBsYXRlOgogICAgcmV0dXJuICgKICAgICAgICBmInt0ZXh0X3dyYXBwZXJ9XG4iCiAgICAgICAgZiJ7cXVlc3Rpb25zX3dyYXBwZXIuZm9ybWF0KHF1ZXN0aW9ucyl9XG4iCiAgICAgICAgIlxuIgogICAgICAgIGYie2Fuc3dlcl9wcmVhbWJsZX1cbiIKICAgICAgICAiMS4gIiAgIyBBZGRpdGlvbiBmb3IgYmV0dGVyIGFuc3dlcnMgaW4gZ2VuZXJhbC4KICAgICksIGFuc3dlcl9wcmVhbWJsZQoKCmRlZiBhbnN3ZXJfcXVlc3Rpb25zKAogICAgY29udGV4dDogbWxydW4uTUxDbGllbnRDdHgsCiAgICBpbnB1dF9wYXRoOiBVbmlvbltzdHIsIHBhdGhsaWIuUGF0aF0sCiAgICBtb2RlbDogc3RyLAogICAgcXVlc3Rpb25zOiBMaXN0W3N0cl0sCiAgICB0b2tlbml6ZXI6IHN0ciA9IE5vbmUsCiAgICBtb2RlbF9rd2FyZ3M6IGRpY3QgPSBOb25lLAogICAgdGV4dF93cmFwcGVyOiBzdHIgPSAiIiwKICAgIHF1ZXN0aW9uc193cmFwcGVyOiBzdHIgPSAiIiwKICAgIGFuc3dlcl9wcmVhbWJsZTogc3RyID0gIiIsCiAgICBnZW5lcmF0aW9uX2NvbmZpZzogZGljdCA9IE5vbmUsCiAgICBxdWVzdGlvbnNfY29sdW1uczogTGlzdFtzdHJdID0gTm9uZSwKICAgIG1vZGVsX2Fuc3dlcmluZ190cnlvdXRzOiBpbnQgPSAyLAopIC0+IFR1cGxlW3BkLkRhdGFGcmFtZSwgZGljdF06CiAgICAiIiIKICAgIEFuc3dlciBxdWVzdGlvbnMgd2l0aCBjb250ZXh0IHRvIHRoZSBnaXZlbiB0ZXh0IGZpbGVzIGJ5IGEgcHJldHJhaW5lZCBMTE0gbW9kZWwuCgogICAgOnBhcmFtIGNvbnRleHQ6ICAgICAgICAgICAgICAgICBNTFJ1biBjb250ZXh0LgogICAgOnBhcmFtIGlucHV0X3BhdGg6ICAgICAgICAgICAgICBBIHBhdGggdG8gYSBkaXJlY3Rvcnkgb2YgdGV4dCBmaWxlcyBvciBhIHBhdGggdG8gYSB0ZXh0IGZpbGUgdG8gYXNrIHF1ZXN0aW9ucyBhYm91dC4KICAgIDpwYXJhbSBtb2RlbDogICAgICAgICAgICAgICAgICAgVGhlIHByZS10cmFpbmVkIG1vZGVsIHRvIHVzZSBmb3IgYXNraW5nIHF1ZXN0aW9ucy4KICAgIDpwYXJhbSBxdWVzdGlvbnM6ICAgICAgICAgICAgICAgVGhlIHF1ZXN0aW9ucyB0byBhc2suCiAgICA6cGFyYW0gdG9rZW5pemVyOiAgICAgICAgICAgICAgIFRoZSBwcmUtdHJhaW5lZCB0b2tlbml6ZXIgdG8gdXNlLiBEZWZhdWx0ZWQgdG8gdGhlIG1vZGVsIGdpdmVuLgogICAgOnBhcmFtIG1vZGVsX2t3YXJnczogICAgICAgICAgICBLZXl3b3JkIGFyZ3VtZW50cyB0byBwYXNzIHJlZ2FyZGluZyB0aGUgbG9hZGluZyBvZiB0aGUgbW9kZWwgaW4gSHVnZ2luZ0ZhY2UncwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgcGlwZWxpbmVgIGZ1bmN0aW9uLgogICAgOnBhcmFtIHRleHRfd3JhcHBlcjogICAgICAgICAgICBBIHdyYXBwZXIgZm9yIHRoZSB0ZXh0IHBhcnQuIFdpbGwgYmUgYWRkZWQgYXQgdGhlIHN0YXJ0IG9mIHRoZSBwcm9tcHQuIE11c3QgaGF2ZSBhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyICgne30nKSBmb3IgdGhlIHF1ZXN0aW9ucy4KICAgIDpwYXJhbSBxdWVzdGlvbnNfd3JhcHBlcjogICAgICAgQSB3cmFwcGVyIGZvciB0aGUgcXVlc3Rpb25zIHJlY2VpdmVkLiBXaWxsIGJlIGFkZGVkIGFmdGVyIHRoZSB0ZXh0IHBsYWNlaG9sZGVyIGluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBwcm9tcHQgdGVtcGxhdGUuIE11c3QgaGF2ZSBhIHBsYWNlaG9sZGVyICgne30nKSBmb3IgdGhlIHF1ZXN0aW9ucy4KICAgIDpwYXJhbSBhbnN3ZXJfcHJlYW1ibGU6ICAgICAgICAgQSBwcmVmaXggZm9yIHRoZSBhbnN3ZXIgcGFydC4gV2lsbCBiZSBhZGRlZCBhdCB0aGUgZW5kIG9mIHRoZSBwcm9tcHQgdGVtcGxhdGUuCiAgICA6cGFyYW0gZ2VuZXJhdGlvbl9jb25maWc6ICAgICAgIEh1Z2dpbmdGYWNlJ3MgYEdlbmVyYXRpb25Db25maWdgIGtleXdvcmQgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIGBnZW5lcmF0ZWAgbWV0aG9kLgogICAgOnBhcmFtIHF1ZXN0aW9uc19jb2x1bW5zOiAgICAgICBDb2x1bW5zIHRvIHVzZSBmb3IgdGhlIGRhdGFmcmFtZSByZXR1cm5lZC4KICAgIDpwYXJhbSBtb2RlbF9hbnN3ZXJpbmdfdHJ5b3V0czogQW1vdW50IG9mIGluZmVycmluZyB0byBkbyBwZXIgdGV4dCBiZWZvcmUgcmFpc2luZyBhbiBlcnJvciBkdWUgdG8gbWlzc2luZyBvciBlbXB0eQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnN3ZXJzLgoKICAgIDpyZXR1cm5zOiBBIHR1cGxlIG9mOgoKICAgICAgICAgICAgICAqIEEgZGF0YWZyYW1lIGRhdGFzZXQgb2YgdGhlIHF1ZXN0aW9ucyBhbnN3ZXJzLgogICAgICAgICAgICAgICogQSBkaWN0aW9uYXJ5IG9mIGVycm9yZWQgZmlsZXMgdGhhdCB3ZXJlIG5vdCBpbmZlcnJlZCBvciB3ZXJlIG5vdCBhbnN3ZXJlZCBwcm9wZXJseS4KICAgICIiIgogICAgIyBHZXQgdGhlIHByb21wdCB0ZW1wbGF0ZToKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oIkNyZWF0aW5nIHByb21wdCB0ZW1wbGF0ZSIpCiAgICBwcm9tcHRfdGVtcGxhdGUsIGFuc3dlcl9wcmVhbWJsZSA9IF9nZXRfcHJvbXB0X3RlbXBsYXRlKAogICAgICAgIHRleHRfd3JhcHBlcj10ZXh0X3dyYXBwZXIsCiAgICAgICAgcXVlc3Rpb25zX3dyYXBwZXI9cXVlc3Rpb25zX3dyYXBwZXIsCiAgICAgICAgcXVlc3Rpb25zPXF1ZXN0aW9ucywKICAgICAgICBhbnN3ZXJfcHJlYW1ibGU9YW5zd2VyX3ByZWFtYmxlLAogICAgKQogICAgY29udGV4dC5sb2dnZXIuaW5mbyhmIlByb21wdCB0ZW1wbGF0ZSBjcmVhdGVkOlxuXG57cHJvbXB0X3RlbXBsYXRlfVxuIikKCiAgICAjIEdldCB0aGUgcXVlc3Rpb25zIGNvbHVtbnM6CiAgICBxdWVzdGlvbnNfY29sdW1ucyA9IHF1ZXN0aW9uc19jb2x1bW5zIG9yIFsKICAgICAgICBmInF7aX0iIGZvciBpIGluIHJhbmdlKDEsIGxlbihxdWVzdGlvbnMpICsgMSkKICAgIF0KICAgIGlmIGxlbihxdWVzdGlvbnNfY29sdW1ucykgIT0gbGVuKHF1ZXN0aW9ucyk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgZiJUaGUgcHJvdmlkZWQgcXVlc3Rpb25zIGNvbHVtbnMgbGVuZ3RoICh7bGVuKHF1ZXN0aW9uc19jb2x1bW5zKX0pICIKICAgICAgICAgICAgZiJkb2VzIG5vdCBtYXRjaCB0aGUgcXVlc3Rpb25zIGFtb3VudCAoe2xlbihxdWVzdGlvbnMpfSkiCiAgICAgICAgKQoKICAgICMgUHJlcGFyZSB0aGUgZGF0YWZyYW1lIGFuZCBlcnJvcnMgdG8gYmUgcmV0dXJuZWQ6CiAgICBkZiA9IHBkLkRhdGFGcmFtZShjb2x1bW5zPVsidGV4dF9maWxlIiwgKnF1ZXN0aW9uc19jb2x1bW5zXSkKICAgIGVycm9ycyA9IHt9CgogICAgIyBMb2FkIHRoZSB0b2tlbml6ZXI6CiAgICB0b2tlbml6ZXIgPSB0b2tlbml6ZXIgb3IgbW9kZWwKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZiJMb2FkaW5nIHRva2VuaXplcjoge3Rva2VuaXplcn0iKQogICAgdG9rZW5pemVyID0gdHJhbnNmb3JtZXJzLkF1dG9Ub2tlbml6ZXIuZnJvbV9wcmV0cmFpbmVkKHRva2VuaXplcikKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oIlRva2VuaXplciBsb2FkZWQiKQoKICAgICMgTG9hZCB0aGUgZ2VuZXJhdGlvbiBjb25maWc6CiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCJMb2FkaW5nIGdlbmVyYXRpb24gY29uZmlndXJhdGlvbiIpCiAgICBnZW5lcmF0aW9uX2NvbmZpZyA9IHRyYW5zZm9ybWVycy5HZW5lcmF0aW9uQ29uZmlnKCoqKGdlbmVyYXRpb25fY29uZmlnIG9yIHt9KSkKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oIkdlbmVyYXRpb24gY29uZmlndXJhdGlvbiBsb2FkZWQuIikKCiAgICAjIExvYWQgdGhlIG1vZGVsIGFuZCB0b2tlbml6ZXIgaW50byBhIHBpcGVsaW5lIG9iamVjdDoKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZiJMb2FkaW5nIG1vZGVsICd7bW9kZWx9JyBhbmQgdG9rZW5pemVyIGludG8gYSBwaXBlbGluZSIpCiAgICBwaXBlbGluZSA9IHRyYW5zZm9ybWVycy5waXBlbGluZSgKICAgICAgICB0YXNrPSJ0ZXh0LWdlbmVyYXRpb24iLAogICAgICAgIG1vZGVsPW1vZGVsLAogICAgICAgIHRva2VuaXplcj10b2tlbml6ZXIsCiAgICAgICAgdHJ1c3RfcmVtb3RlX2NvZGU9VHJ1ZSwKICAgICAgICBtb2RlbF9rd2FyZ3M9bW9kZWxfa3dhcmdzLAogICAgKQogICAgY29udGV4dC5sb2dnZXIuaW5mbygiTW9kZWwgbG9hZGVkLCBwaXBlbGluZSBjcmVhdGVkIikKCiAgICAjIEdvIG92ZXIgdGhlIGF1ZGlvIGZpbGVzIGFuZCBpbmZlciB0aHJvdWdoIHRoZSBtb2RlbDoKICAgIGlmIHBhdGhsaWIuUGF0aChpbnB1dF9wYXRoKS5pc19maWxlKCk6CiAgICAgICAgaW5wdXRfcGF0aCA9IFtpbnB1dF9wYXRoXQogICAgZWxzZToKICAgICAgICB0ZXh0X2ZpbGVzX2RpcmVjdG9yeSA9IHBhdGhsaWIuUGF0aChpbnB1dF9wYXRoKS5hYnNvbHV0ZSgpCiAgICAgICAgaW5wdXRfcGF0aCA9IGxpc3QodGV4dF9maWxlc19kaXJlY3Rvcnkucmdsb2IoIiouKiIpKQogICAgZm9yIGksIHRleHRfZmlsZSBpbiBlbnVtZXJhdGUoCiAgICAgICAgdHFkbSgKICAgICAgICAgICAgaW5wdXRfcGF0aCwKICAgICAgICAgICAgZGVzYz0iR2VuZXJhdGluZyBhbnN3ZXJzIiwKICAgICAgICAgICAgdW5pdD0iZmlsZSIsCiAgICAgICAgKQogICAgKToKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgUmVhZCB0aGUgdGV4dDoKICAgICAgICAgICAgd2l0aCBvcGVuKHRleHRfZmlsZSwgInIiKSBhcyBmcDoKICAgICAgICAgICAgICAgIHRleHQgPSBmcC5yZWFkKCkKICAgICAgICAgICAgIyBGb3IgZWFjaCB0ZXh0LCB0cnkgbXVsdGlwbGUgdGltZXMgYXMgdGhlIGxsbSBtaWdodCBleHBlcmllbmNlIHplcm8gYW5zd2VyczoKICAgICAgICAgICAgdHJ5b3V0ID0gMAogICAgICAgICAgICBmb3IgdHJ5b3V0IGluIHJhbmdlKG1vZGVsX2Fuc3dlcmluZ190cnlvdXRzKToKICAgICAgICAgICAgICAgICMgSW5mZXIgdGhyb3VnaCB0aGUgbGxtOgogICAgICAgICAgICAgICAgc2VxdWVuY2VzID0gcGlwZWxpbmUoCiAgICAgICAgICAgICAgICAgICAgcHJvbXB0X3RlbXBsYXRlLmZvcm1hdCh0ZXh0KSwKICAgICAgICAgICAgICAgICAgICBnZW5lcmF0aW9uX2NvbmZpZz1nZW5lcmF0aW9uX2NvbmZpZywKICAgICAgICAgICAgICAgICAgICBudW1fcmV0dXJuX3NlcXVlbmNlcz0xLAogICAgICAgICAgICAgICAgICAgIGVvc190b2tlbl9pZD10b2tlbml6ZXIuZW9zX3Rva2VuX2lkLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgIyBWYWxpZGF0ZSB0aGUgYW5zd2VyczoKICAgICAgICAgICAgICAgIGFuc3dlcnMgPSBzZXF1ZW5jZXNbMF1bImdlbmVyYXRlZF90ZXh0Il0uc3BsaXQoCiAgICAgICAgICAgICAgICAgICAgZiJ7YW5zd2VyX3ByZWFtYmxlfVxuIiwgMQogICAgICAgICAgICAgICAgKVsxXQogICAgICAgICAgICAgICAgYW5zd2VycyA9IGFuc3dlcnMuc3BsaXQoIlxuIikKICAgICAgICAgICAgICAgIGlmIGxlbihhbnN3ZXJzKSAhPSBsZW4ocXVlc3Rpb25zKToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgYW5zd2VycyA9IFsKICAgICAgICAgICAgICAgICAgICBhbnN3ZXJbMzpdIGZvciBhbnN3ZXIgaW4gYW5zd2VycwogICAgICAgICAgICAgICAgXSAgIyBXaXRob3V0IHRoZSBxdWVzdGlvbnMgaW5kZXggcHJlZml4ICdpLiAnCiAgICAgICAgICAgICAgICBpZiBhbGwobGVuKGFuc3dlcikgPT0gMCBmb3IgYW5zd2VyIGluIGFuc3dlcnMpOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAjIE5vdGUgaW4gdGhlIGRhdGFmcmFtZToKICAgICAgICAgICAgICAgIGRmLmxvY1tpIC0gbGVuKGVycm9ycyldID0gWwogICAgICAgICAgICAgICAgICAgIHN0cih0ZXh0X2ZpbGUucmVsYXRpdmVfdG8odGV4dF9maWxlc19kaXJlY3RvcnkpKSwKICAgICAgICAgICAgICAgICAgICAqYW5zd2VycywKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGlmIHRyeW91dCA9PSBtb2RlbF9hbnN3ZXJpbmdfdHJ5b3V0czoKICAgICAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICBmIlRoZSBMTE0gZGlkIG5vdCBhbnN3ZXIgY29ycmVjdGx5IC0gb25lIG9yIG1vcmUgYW5zd2VycyBhcmUgbWlzc2luZzoge2Fuc3dlcnN9IgogICAgICAgICAgICAgICAgKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjZXB0aW9uOgogICAgICAgICAgICAjIENvbGxlY3QgdGhlIGV4Y2VwdGlvbjoKICAgICAgICAgICAgY29udGV4dC5sb2dnZXIuZXJyb3IoZiJFcnJvciBpbiBmaWxlOiAne3RleHRfZmlsZX0nIikKICAgICAgICAgICAgZXJyb3JzW3N0cih0ZXh0X2ZpbGUpXSA9IHN0cihleGNlcHRpb24pCgogICAgcmV0dXJuIGRmLCBlcnJvcnMK
    base_image: mlrun/mlrun
    commands: []
    code_origin: https://github.com/yonishelach/functions.git#5c41dc9f6d280ecafefb93019588d503316e4f2c:/Users/Yonatan_Shelach/projects/functions/question_answering/question_answering.py
    origin_filename: /Users/Yonatan_Shelach/projects/functions/question_answering/question_answering.py
    requirements:
    - transformers torch tqdm
  entry_points:
    answer_questions:
      name: answer_questions
      doc: Answer questions with context to the given text files by a pretrained LLM
        model.
      parameters:
      - name: context
        type: MLClientCtx
        doc: MLRun context.
        default: ''
      - name: input_path
        type: Union[str, Path]
        doc: A path to a directory of text files or a path to a text file to ask questions
          about.
        default: ''
      - name: model
        type: str
        doc: The pre-trained model to use for asking questions.
        default: ''
      - name: questions
        type: List[str]
        doc: The questions to ask.
        default: ''
      - name: tokenizer
        type: str
        doc: The pre-trained tokenizer to use. Defaulted to the model given.
        default: null
      - name: model_kwargs
        type: dict
        doc: Keyword arguments to pass regarding the loading of the model in HuggingFace's
          `pipeline` function.
        default: null
      - name: text_wrapper
        type: str
        doc: A wrapper for the text part. Will be added at the start of the prompt.
          Must have a placeholder ('{}') for the questions.
        default: ''
      - name: questions_wrapper
        type: str
        doc: A wrapper for the questions received. Will be added after the text placeholder
          in the prompt template. Must have a placeholder ('{}') for the questions.
        default: ''
      - name: answer_preamble
        type: str
        doc: A prefix for the answer part. Will be added at the end of the prompt
          template.
        default: ''
      - name: generation_config
        type: dict
        doc: HuggingFace's `GenerationConfig` keyword arguments to pass to the `generate`
          method.
        default: null
      - name: questions_columns
        type: List[str]
        doc: Columns to use for the dataframe returned.
        default: null
      - name: model_answering_tryouts
        type: int
        doc: Amount of inferring to do per text before raising an error due to missing
          or empty answers.
        default: 2
      outputs:
      - default: ''
        doc: 'A tuple of:'
      lineno: 68
  description: GenAI approach of question answering on a given data
  default_handler: answer_questions
  disable_auto_mount: false
  clone_target_dir: ''
  env: []
  priority_class_name: ''
  preemption_mode: prevent
  affinity: null
  tolerations: null
  security_context: {}
verbose: false

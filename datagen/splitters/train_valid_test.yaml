kind: job
metadata:
  name: train-valid-test
  tag: ''
  hash: 877224f2dd10beff5f7e9cb9b4821a8685aab9db
  project: ''
spec:
  command: ''
  args: []
  image: yjbds/mlrun-ds:latest
  volumes: []
  volume_mounts: []
  env: []
  description: ''
  build:
    functionSourceCode: aW1wb3J0IHBhbmRhcyBhcyBwZAppbXBvcnQgb3MKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBweWFycm93LnBhcnF1ZXQgYXMgcHEKaW1wb3J0IHB5YXJyb3cgYXMgcGEKZnJvbSBjbG91ZHBpY2tsZSBpbXBvcnQgZHVtcAoKZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdApmcm9tIHR5cGluZyBpbXBvcnQgT3B0aW9uYWwsIFVuaW9uCmZyb20gbWxydW4uZXhlY3V0aW9uIGltcG9ydCBNTENsaWVudEN0eApmcm9tIG1scnVuLmRhdGFzdG9yZSBpbXBvcnQgRGF0YUl0ZW0KCmRlZiB0cmFpbl92YWxpZF90ZXN0X3NwbGl0dGVyKAogICAgY29udGV4dDogT3B0aW9uYWxbTUxDbGllbnRDdHhdID0gTm9uZSwKICAgIHNyY19maWxlOiBVbmlvbltEYXRhSXRlbSwgc3RyXSA9ICcnLAogICAgaGVhZGVyOiBVbmlvbltEYXRhSXRlbSwgc3RyLCBsaXN0XSA9ICcnLAogICAgc2FtcGxlOiBpbnQgPSAtMSwKICAgIGxhYmVsX2NvbHVtbjogc3RyID0gJ2xhYmVscycsCiAgICB0ZXN0X3NpemU6IGZsb2F0ID0gMC4xLAogICAgdHJhaW5fdmFsX3NwbGl0OiBmbG9hdCA9IDAuNzUsCiAgICB0YXJnZXRfcGF0aDogc3RyID0gJycsCiAgICBuYW1lOiBzdHIgPSAnJywKICAgIGtleTogc3RyID0gJycsCiAgICByYW5kb21fc3RhdGUgPSAxCikgLT4gTm9uZToKICAgICIiIlNwbGl0IHJhdyBkYXRhIGlucHV0IGludG8gdHJhaW4sIHZhbGlkYXRpb24gYW5kIHRlc3Qgc2V0cy4KCiAgICA6cGFyYW0gY29udGV4dDogICAgICAgICB0aGUgZnVuY3Rpb24gY29udGV4dAogICAgOnBhcmFtIHNyY19maWxlOiAgICAgICAgKCdyYXcnKSBuYW1lIG9mIHJhdyBkYXRhIGZpbGUKICAgIDpwYXJhbSBoZWFkZXI6ICAgICAgICAgIChOb25lKSBoZWFkZXIgYXJ0aWZhY3Qgb3IgbGlzdCBvZiBjb2x1bW4gbmFtZXMuCiAgICA6cGFyYW0gc2FtcGxlOiAgICAgICAgICAoLTEpLiBTZWxlY3RzIHRoZSBmaXJzdCBuIHJvd3MsIG9yIHNlbGVjdCBhIHNhbXBsZSBzdGFydGluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSB0aGUgZmlyc3QuIElmIG5lZ2F0aXZlIDwtMSwgc2VsZWN0IGEgcmFuZG9tIHNhbXBsZSBmcm9tIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGVudGlyZSBmaWxlCiAgICA6cGFyYW0gbGFiZWxfY29sdW1uOiAgICBncm91bmQtdHJ1dGggKHkpIGxhYmVscwogICAgOnBhcmFtIHRlc3Rfc2l6ZTogICAgICAgKDAuMSkgdGVzdCBzZXQgc2l6ZQogICAgOnBhcmFtIHRyYWluX3ZhbF9zcGxpdDogKDAuNzUpIE9uY2UgdGhlIHRlc3Qgc2V0IGhhcyBiZWVuIHJlbW92ZWQgdGhlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhaW5pbmcgc2V0IGdldHMgdGhpcyBwcm9wb3J0aW9uLgogICAgOnBhcmFtIHRhcmdldF9wYXRoOiAgICAgZm9sZGVyIGxvY2F0aW9uIG9mIGZpbGVzCiAgICA6cGFyYW0gbmFtZTogICAgICAgICAgICBkZXN0aW5hdGlvbiBwcmVmaXggbmFtZSBmb3IgbW9kZWwgZmlsZXMKICAgIDpwYXJhbSBrZXk6ICAgICAgICAgICAgIGtleSBmb3IgbW9kZWwgYXJ0aWZhY3QKICAgIDpwYXJhbSByYW5kb21fc3RhdGU6ICAgICgxKSBza2xlYXJuIHJuZyBzZWVkCiAgICAiIiIKICAgIGlmIGlzaW5zdGFuY2Uoc3JjX2ZpbGUsIERhdGFJdGVtKToKICAgICAgICBzcmNfZmlsZSA9IHN0cihzcmNfZmlsZSkKICAgIHNyY2ZpbGVwYXRoID0gb3MucGF0aC5qb2luKHRhcmdldF9wYXRoLCBzcmNfZmlsZSkKCiAgICBpZiAoc2FtcGxlID09IC0xKSBvciAoc2FtcGxlID49IDEpOgogICAgICAgICMgZ2V0IGFsbCByb3dzLCBvciBjb250aWd1b3VzIHNhbXBsZSBzdGFydGluZyBhdCByb3cgMS4KICAgICAgICByYXcgPSBwZC5yZWFkX3BhcnF1ZXQoc3JjZmlsZXBhdGgsIGVuZ2luZT0ncHlhcnJvdycpCiAgICAgICAgbGFiZWxzID0gcmF3LnBvcChsYWJlbF9jb2x1bW4pCiAgICAgICAgcmF3ID0gcmF3Lmlsb2NbOnNhbXBsZSwgOl0KICAgICAgICBsYWJlbHMgPSBsYWJlbHMuaWxvY1s6c2FtcGxlXQogICAgZWxzZToKICAgICAgICAjIGdyYWIgYSByYW5kb20gc2FtcGxlCiAgICAgICAgcmF3ID0gcGQucmVhZF9wYXJxdWV0KHNyY2ZpbGVwYXRoLCBlbmdpbmU9J3B5YXJyb3cnKS5zYW1wbGUoc2FtcGxlKi0xKQogICAgICAgIGxhYmVscyA9IHJhdy5wb3AobGFiZWxfY29sdW1uKQogICAgCiAgICAjIGRvdWJsZSBzcGxpdCB0cCBnZW5lcmF0ZSAzIGRhdGEgc2V0czogdHJhaW4sIHZhbGlkYXRpb24gYW5kIHRlc3QKICAgIHgsIHh0ZXN0LCB5LCB5dGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQocmF3LCBsYWJlbHMsIHRlc3Rfc2l6ZT10ZXN0X3NpemUsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5kb21fc3RhdGU9cmFuZG9tX3N0YXRlKQogICAKICAgIHh0cmFpbiwgeHZhbGlkLCB5dHJhaW4sIHl2YWxpZCA9IHRyYWluX3Rlc3Rfc3BsaXQoeCwgeSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWluX3NpemU9dHJhaW5fdmFsX3NwbGl0LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZG9tX3N0YXRlPXJhbmRvbV9zdGF0ZSkgICAgICAgIAoKICAgIGlmIG5hbWU6CiAgICAgICAgbmFtZSA9ICctJyArIG5hbWUKICAgIAogICAgIyBzYXZlIGhlYWRlcgogICAgZiA9IG9zLnBhdGguam9pbih0YXJnZXRfcGF0aCwgbmFtZSArICdoZWFkZXIucGtsJykKICAgIGR1bXAocmF3LmNvbHVtbnMudmFsdWVzLCBvcGVuKGYsICd3YicpKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoJ2hlYWRlcicsIHRhcmdldF9wYXRoPWYpCiAgICAKICAgICMgc2F2ZSBkYXRhIHNldHMKICAgIGYgPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUgKyAneHRyYWluLnBxdCcpCiAgICB4dHJhaW4udG9fcGFycXVldChmKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoJ3h0cmFpbicsIHRhcmdldF9wYXRoPWYpCiAgICAKICAgIGYgPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUgKyAneHZhbGlkLnBxdCcpCiAgICB4dmFsaWQudG9fcGFycXVldChmKQogICAgY29udGV4dC5sb2dfYXJ0aWZhY3QoJ3h2YWxpZCcsIHRhcmdldF9wYXRoPWYpCiAgICAKICAgIGYgPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUgKyAneHRlc3QucHF0JykKICAgIHh0ZXN0LnRvX3BhcnF1ZXQoZikKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KCd4dGVzdCcsIHRhcmdldF9wYXRoPWYpCiAgICAKICAgIGYgPSBvcy5wYXRoLmpvaW4odGFyZ2V0X3BhdGgsIG5hbWUgKyAneXRyYWluLnBxdCcpCiAgICBwZC5EYXRhRnJhbWUoeydsYWJlbHMnOiB5dHJhaW59KS50b19wYXJxdWV0KGYpCiAgICBjb250ZXh0LmxvZ19hcnRpZmFjdCgneXRyYWluJywgdGFyZ2V0X3BhdGg9ZikKICAgIAogICAgZiA9IG9zLnBhdGguam9pbih0YXJnZXRfcGF0aCwgbmFtZSArICd5dmFsaWQucHF0JykKICAgIHBkLkRhdGFGcmFtZSh7J2xhYmVscyc6IHl2YWxpZH0pLnRvX3BhcnF1ZXQoZikKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KCd5dmFsaWQnLCB0YXJnZXRfcGF0aD1mKQogICAgCiAgICBmID0gb3MucGF0aC5qb2luKHRhcmdldF9wYXRoLCBuYW1lICsgJ3l0ZXN0LnBxdCcpCiAgICBwZC5EYXRhRnJhbWUoeydsYWJlbHMnOiB5dGVzdH0pLnRvX3BhcnF1ZXQoZikKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KCd5dGVzdCcsIHRhcmdldF9wYXRoPWYp
    base_image: yjbds/mlrun-ds:latest
    commands: []
    code_origin: https://github.com/yjb-ds/functions.git#25e611e4bd05320d342708ce786522bfecaa0e51:/User/repos/functions/datagen/splitters/train_valid_test.py
